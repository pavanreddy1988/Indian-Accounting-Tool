

<!DOCTYPE html>
<html lang="en-US" prefix="og: https://ogp.me/ns#">
<head>

<!-- Embedded TallyPro local styles (replaces removed external styles) -->
<style>
:root{ --bg:#f7fafc; --card:#ffffff; --muted:#6b7280; --accent:#046bd2; --radius:10px; --gap:12px; }
html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:var(--bg); color:#0f172a;}
.container{max-width:1100px;margin:28px auto;padding:18px;}
.header{display:flex;align-items:center;gap:12px;margin-bottom:18px;}
.brand{font-weight:700;font-size:1.25rem;color:var(--accent);}
.card{background:var(--card);border-radius:var(--radius);padding:16px;box-shadow:0 6px 18px rgba(15,23,42,0.06);}
.table{width:100%;border-collapse:collapse;margin-top:12px;}
.table th,.table td{padding:8px 10px;border-bottom:1px solid #eef2f7;text-align:left;font-size:0.95rem;}
.controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px;}
.btn{background:var(--accent);color:white;padding:8px 12px;border-radius:8px;border:none;cursor:pointer;}
.input,textarea,select{padding:8px;border-radius:8px;border:1px solid #e6eef9;font-size:0.95rem;}
.small{font-size:0.85rem;color:var(--muted);}
.footer{margin-top:18px;text-align:center;color:var(--muted);font-size:0.9rem;}
@media (max-width:720px){.container{padding:12px;margin:12px;} .header{flex-direction:column;align-items:flex-start;}}
</style>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11"> 
		<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
<!-- Search Engine Optimization by Rank Math - https://rankmath.com/ -->
<title>TallyPro — Offline Accounting Tool</title>
<meta name="description" content="Make me your finance manager with this Free Accounting Tools for Small Business Owners &amp; Freelancers — an easy-to-use tool to track income, expenses, and generate P&amp;L, Balance Sheets, and more."/>
<meta name="robots" content="index, follow, max-snippet:-1, max-video-preview:-1, max-image-preview:large"/>

<meta property="og:locale" content="en_US" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Free Accounting Tools for Small Business Owners &amp; Freelancers | TallyPro - Your Daily Finance Partner" />
<meta property="og:description" content="Make me your finance manager with this Free Accounting Tools for Small Business Owners &amp; Freelancers — an easy-to-use tool to track income, expenses, and generate P&amp;L, Balance Sheets, and more." />

<meta property="og:site_name" content="TallyPro" />
<meta property="og:updated_time" content="2025-07-31T18:56:14+00:00" />
<meta property="article:published_time" content="2025-07-12T05:32:42+00:00" />
<meta property="article:modified_time" content="2025-07-31T18:56:14+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Free Accounting Tools for Small Business Owners &amp; Freelancers | Your Daily Finance Partner" />
<meta name="twitter:description" content="Make me your finance manager with this Free Accounting Tools for Small Business Owners &amp; Freelancers — an easy-to-use tool to track income, expenses, and generate P&amp;L, Balance Sheets, and more." />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="scriptcritique@gmail.com" />
<meta name="twitter:label2" content="Time to read" />
<meta name="twitter:data2" content="3 minutes" />

<script>
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/16.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/16.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/tallypro.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.8.3"}};
/*! This file is auto-generated */
!function(s,n){var o,i,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),a=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===a[t]})}function u(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);for(var n=e.getImageData(16,16,1,1),a=0;a<n.data.length;a++)if(0!==n.data[a])return!1;return!0}function f(e,t,n,a){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\udde8\ud83c\uddf6","\ud83c\udde8\u200b\ud83c\uddf6")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!a(e,"\ud83e\udedf")}return!1}function g(e,t,n,a){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):s.createElement("canvas"),o=r.getContext("2d",{willReadFrequently:!0}),i=(o.textBaseline="top",o.font="600 32px Arial",{});return e.forEach(function(e){i[e]=t(o,e,n,a)}),i}function t(e){var t=s.createElement("script");t.src=e,t.defer=!0,s.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",i=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){s.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+g.toString()+"("+[JSON.stringify(i),f.toString(),p.toString(),u.toString()].join(",")+"));",a=new Blob([e],{type:"text/javascript"}),r=new Worker(URL.createObjectURL(a),{name:"wpTestEmojiSupports"});return void(r.onmessage=function(e){c(n=e.data),r.terminate(),t(n)})}catch(e){}c(n=g(i,f,p,u))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
</script>
<link rel='stylesheet' id='astra-theme-css-css' href='https://tallypro.com/wp-content/themes/astra/assets/css/minified/main.min.css?ver=4.11.7' media='all' />
<style id='astra-theme-css-inline-css'>
:root{--ast-post-nav-space:0;--ast-container-default-xlg-padding:2.5em;--ast-container-default-lg-padding:2.5em;--ast-container-default-slg-padding:2em;--ast-container-default-md-padding:2.5em;--ast-container-default-sm-padding:2.5em;--ast-container-default-xs-padding:2.4em;--ast-container-default-xxs-padding:1.8em;--ast-code-block-background:#ECEFF3;--ast-comment-inputs-background:#F9FAFB;--ast-normal-container-width:1200px;--ast-narrow-container-width:750px;--ast-blog-title-font-weight:600;--ast-blog-meta-weight:600;--ast-global-color-primary:var(--ast-global-color-4);--ast-global-color-secondary:var(--ast-global-color-5);--ast-global-color-alternate-background:var(--ast-global-color-6);--ast-global-color-subtle-background:var(--ast-global-color-7);--ast-bg-style-guide:#F8FAFC;--ast-shadow-style-guide:0px 0px 4px 0 #00000057;--ast-global-dark-bg-style:#fff;--ast-global-dark-lfs:#fbfbfb;--ast-widget-bg-color:#fafafa;--ast-wc-container-head-bg-color:#fbfbfb;--ast-title-layout-bg:#eeeeee;--ast-search-border-color:#e7e7e7;--ast-lifter-hover-bg:#e6e6e6;--ast-gallery-block-color:#000;--srfm-color-input-label:var(--ast-global-color-2);}html{font-size:100%;}a{color:var(--ast-global-color-0);}a:hover,a:focus{color:var(--ast-global-color-1);}body,button,input,select,textarea,.ast-button,.ast-custom-button{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-weight:400;font-size:16px;font-size:1rem;line-height:var(--ast-body-line-height,1.65);}blockquote{color:var(--ast-global-color-3);}h1,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6,.site-title,.site-title a{font-weight:600;}.ast-site-identity .site-title a{color:#3f00ff;}.site-title{font-size:26px;font-size:1.625rem;display:block;}header .custom-logo-link img{max-width:153px;width:153px;}.astra-logo-svg{width:153px;}.site-header .site-description{font-size:15px;font-size:0.9375rem;display:block;}.entry-title{font-size:20px;font-size:1.25rem;}.ast-blog-single-element.ast-taxonomy-container a{font-size:14px;font-size:0.875rem;}.ast-blog-meta-container{font-size:13px;font-size:0.8125rem;}.archive .ast-article-post .ast-article-inner,.blog .ast-article-post .ast-article-inner,.archive .ast-article-post .ast-article-inner:hover,.blog .ast-article-post .ast-article-inner:hover{border-top-left-radius:6px;border-top-right-radius:6px;border-bottom-right-radius:6px;border-bottom-left-radius:6px;overflow:hidden;}h1,.entry-content h1{font-size:36px;font-size:2.25rem;font-weight:600;line-height:1.4em;}h2,.entry-content h2{font-size:30px;font-size:1.875rem;font-weight:600;line-height:1.3em;}h3,.entry-content h3{font-size:24px;font-size:1.5rem;font-weight:600;line-height:1.3em;}h4,.entry-content h4{font-size:20px;font-size:1.25rem;line-height:1.2em;font-weight:600;}h5,.entry-content h5{font-size:18px;font-size:1.125rem;line-height:1.2em;font-weight:600;}h6,.entry-content h6{font-size:16px;font-size:1rem;line-height:1.25em;font-weight:600;}::selection{background-color:var(--ast-global-color-0);color:#ffffff;}body,h1,.entry-title a,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6{color:var(--ast-global-color-3);}.tagcloud a:hover,.tagcloud a:focus,.tagcloud a.current-item{color:#ffffff;border-color:var(--ast-global-color-0);background-color:var(--ast-global-color-0);}input:focus,input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="reset"]:focus,input[type="search"]:focus,textarea:focus{border-color:var(--ast-global-color-0);}input[type="radio"]:checked,input[type=reset],input[type="checkbox"]:checked,input[type="checkbox"]:hover:checked,input[type="checkbox"]:focus:checked,input[type=range]::-webkit-slider-thumb{border-color:var(--ast-global-color-0);background-color:var(--ast-global-color-0);box-shadow:none;}.site-footer a:hover + .post-count,.site-footer a:focus + .post-count{background:var(--ast-global-color-0);border-color:var(--ast-global-color-0);}.single .nav-links .nav-previous,.single .nav-links .nav-next{color:var(--ast-global-color-0);}.entry-meta,.entry-meta *{line-height:1.45;color:var(--ast-global-color-0);font-weight:600;}.entry-meta a:not(.ast-button):hover,.entry-meta a:not(.ast-button):hover *,.entry-meta a:not(.ast-button):focus,.entry-meta a:not(.ast-button):focus *,.page-links > .page-link,.page-links .page-link:hover,.post-navigation a:hover{color:var(--ast-global-color-1);}#cat option,.secondary .calendar_wrap thead a,.secondary .calendar_wrap thead a:visited{color:var(--ast-global-color-0);}.secondary .calendar_wrap #today,.ast-progress-val span{background:var(--ast-global-color-0);}.secondary a:hover + .post-count,.secondary a:focus + .post-count{background:var(--ast-global-color-0);border-color:var(--ast-global-color-0);}.calendar_wrap #today > a{color:#ffffff;}.page-links .page-link,.single .post-navigation a{color:var(--ast-global-color-3);}.ast-search-menu-icon .search-form button.search-submit{padding:0 4px;}.ast-search-menu-icon form.search-form{padding-right:0;}.ast-search-menu-icon.slide-search input.search-field{width:0;}.ast-header-search .ast-search-menu-icon.ast-dropdown-active .search-form,.ast-header-search .ast-search-menu-icon.ast-dropdown-active .search-field:focus{transition:all 0.2s;}.search-form input.search-field:focus{outline:none;}.ast-search-menu-icon .search-form button.search-submit:focus,.ast-theme-transparent-header .ast-header-search .ast-dropdown-active .ast-icon,.ast-theme-transparent-header .ast-inline-search .search-field:focus .ast-icon{color:var(--ast-global-color-1);}.ast-header-search .slide-search .search-form{border:2px solid var(--ast-global-color-0);}.ast-header-search .slide-search .search-field{background-color:(--ast-global-dark-bg-style);}.ast-archive-title{color:var(--ast-global-color-2);}.widget-title{font-size:22px;font-size:1.375rem;color:var(--ast-global-color-2);}.ast-single-post .entry-content a,.ast-comment-content a:not(.ast-comment-edit-reply-wrap a){text-decoration:underline;}.ast-single-post .elementor-widget-button .elementor-button,.ast-single-post .entry-content .uagb-tab a,.ast-single-post .entry-content .uagb-ifb-cta a,.ast-single-post .entry-content .uabb-module-content a,.ast-single-post .entry-content .uagb-post-grid a,.ast-single-post .entry-content .uagb-timeline a,.ast-single-post .entry-content .uagb-toc__wrap a,.ast-single-post .entry-content .uagb-taxomony-box a,.entry-content .wp-block-latest-posts > li > a,.ast-single-post .entry-content .wp-block-file__button,a.ast-post-filter-single,.ast-single-post .ast-comment-content .comment-reply-link,.ast-single-post .ast-comment-content .comment-edit-link{text-decoration:none;}.ast-search-menu-icon.slide-search a:focus-visible:focus-visible,.astra-search-icon:focus-visible,#close:focus-visible,a:focus-visible,.ast-menu-toggle:focus-visible,.site .skip-link:focus-visible,.wp-block-loginout input:focus-visible,.wp-block-search.wp-block-search__button-inside .wp-block-search__inside-wrapper,.ast-header-navigation-arrow:focus-visible,.ast-orders-table__row .ast-orders-table__cell:focus-visible,a#ast-apply-coupon:focus-visible,#ast-apply-coupon:focus-visible,#close:focus-visible,.button.search-submit:focus-visible,#search_submit:focus,.normal-search:focus-visible,.ast-header-account-wrap:focus-visible,.astra-cart-drawer-close:focus,.ast-single-variation:focus,.ast-button:focus{outline-style:dotted;outline-color:inherit;outline-width:thin;}input:focus,input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="reset"]:focus,input[type="search"]:focus,input[type="number"]:focus,textarea:focus,.wp-block-search__input:focus,[data-section="section-header-mobile-trigger"] .ast-button-wrap .ast-mobile-menu-trigger-minimal:focus,.ast-mobile-popup-drawer.active .menu-toggle-close:focus,#ast-scroll-top:focus,#coupon_code:focus,#ast-coupon-code:focus{border-style:dotted;border-color:inherit;border-width:thin;}input{outline:none;}.ast-logo-title-inline .site-logo-img{padding-right:1em;}.site-logo-img img{ transition:all 0.2s linear;}body .ast-oembed-container *{position:absolute;top:0;width:100%;height:100%;left:0;}body .wp-block-embed-pocket-casts .ast-oembed-container *{position:unset;}.ast-single-post-featured-section + article {margin-top: 2em;}.site-content .ast-single-post-featured-section img {width: 100%;overflow: hidden;object-fit: cover;}.ast-separate-container .site-content .ast-single-post-featured-section + article {margin-top: -80px;z-index: 9;position: relative;border-radius: 4px;}@media (min-width: 922px) {.ast-no-sidebar .site-content .ast-article-image-container--wide {margin-left: -120px;margin-right: -120px;max-width: unset;width: unset;}.ast-left-sidebar .site-content .ast-article-image-container--wide,.ast-right-sidebar .site-content .ast-article-image-container--wide {margin-left: -10px;margin-right: -10px;}.site-content .ast-article-image-container--full {margin-left: calc( -50vw + 50%);margin-right: calc( -50vw + 50%);max-width: 100vw;width: 100vw;}.ast-left-sidebar .site-content .ast-article-image-container--full,.ast-right-sidebar .site-content .ast-article-image-container--full {margin-left: -10px;margin-right: -10px;max-width: inherit;width: auto;}}.site > .ast-single-related-posts-container {margin-top: 0;}@media (min-width: 922px) {.ast-desktop .ast-container--narrow {max-width: var(--ast-narrow-container-width);margin: 0 auto;}}input[type="text"],input[type="number"],input[type="email"],input[type="url"],input[type="password"],input[type="search"],input[type=reset],input[type=tel],input[type=date],select,textarea{font-size:16px;font-style:normal;font-weight:400;line-height:24px;width:100%;padding:12px 16px;border-radius:4px;box-shadow:0px 1px 2px 0px rgba(0,0,0,0.05);color:var(--ast-form-input-text,#475569);}input[type="text"],input[type="number"],input[type="email"],input[type="url"],input[type="password"],input[type="search"],input[type=reset],input[type=tel],input[type=date],select{height:40px;}input[type="date"]{border-width:1px;border-style:solid;border-color:var(--ast-border-color);background:var( --ast-global-color-secondary,--ast-global-color-5 );}input[type="text"]:focus,input[type="number"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="search"]:focus,input[type=reset]:focus,input[type="tel"]:focus,input[type="date"]:focus,select:focus,textarea:focus{border-color:#046BD2;box-shadow:none;outline:none;color:var(--ast-form-input-focus-text,#475569);}label,legend{color:#111827;font-size:14px;font-style:normal;font-weight:500;line-height:20px;}select{padding:6px 10px;}fieldset{padding:30px;border-radius:4px;}button,.ast-button,.button,input[type="button"],input[type="reset"],input[type="submit"]{border-radius:4px;box-shadow:0px 1px 2px 0px rgba(0,0,0,0.05);}:root{--ast-comment-inputs-background:#FFF;}::placeholder{color:var(--ast-form-field-color,#9CA3AF);}::-ms-input-placeholder{color:var(--ast-form-field-color,#9CA3AF);}.wpcf7 input.wpcf7-form-control:not([type=submit]),.wpcf7 textarea.wpcf7-form-control{padding:12px 16px;}.wpcf7 select.wpcf7-form-control{padding:6px 10px;}.wpcf7 input.wpcf7-form-control:not([type=submit]):focus,.wpcf7 select.wpcf7-form-control:focus,.wpcf7 textarea.wpcf7-form-control:focus{border-style:disable;border-color:#046BD2;border-width:thin;box-shadow:none;outline:none;color:var(--ast-form-input-focus-text,#475569);}.wpcf7 .wpcf7-not-valid-tip{color:#DC2626;font-size:14px;font-weight:400;line-height:20px;margin-top:8px;}.wpcf7 input[type=file].wpcf7-form-control{font-size:16px;font-style:normal;font-weight:400;line-height:24px;width:100%;padding:12px 16px;border-radius:4px;box-shadow:0px 1px 2px 0px rgba(0,0,0,0.05);color:var(--ast-form-input-text,#475569);}@media (max-width:921.9px){#ast-desktop-header{display:none;}}@media (min-width:922px){#ast-mobile-header{display:none;}}.wp-block-buttons.aligncenter{justify-content:center;}@media (max-width:921px){.ast-theme-transparent-header #primary,.ast-theme-transparent-header #secondary{padding:0;}}@media (max-width:921px){.ast-plain-container.ast-no-sidebar #primary{padding:0;}}.ast-plain-container.ast-no-sidebar #primary{margin-top:0;margin-bottom:0;}@media (min-width:1200px){.ast-plain-container.ast-no-sidebar #primary{margin-top:60px;margin-bottom:60px;}}.wp-block-button.is-style-outline .wp-block-button__link{border-color:var(--ast-global-color-0);}div.wp-block-button.is-style-outline > .wp-block-button__link:not(.has-text-color),div.wp-block-button.wp-block-button__link.is-style-outline:not(.has-text-color){color:var(--ast-global-color-0);}.wp-block-button.is-style-outline .wp-block-button__link:hover,.wp-block-buttons .wp-block-button.is-style-outline .wp-block-button__link:focus,.wp-block-buttons .wp-block-button.is-style-outline > .wp-block-button__link:not(.has-text-color):hover,.wp-block-buttons .wp-block-button.wp-block-button__link.is-style-outline:not(.has-text-color):hover{color:#ffffff;background-color:var(--ast-global-color-1);border-color:var(--ast-global-color-1);}.post-page-numbers.current .page-link,.ast-pagination .page-numbers.current{color:#ffffff;border-color:var(--ast-global-color-0);background-color:var(--ast-global-color-0);}.wp-block-buttons .wp-block-button.is-style-outline .wp-block-button__link.wp-element-button,.ast-outline-button,.wp-block-uagb-buttons-child .uagb-buttons-repeater.ast-outline-button{border-color:var(--ast-global-color-0);border-top-width:2px;border-right-width:2px;border-bottom-width:2px;border-left-width:2px;font-family:inherit;font-weight:500;font-size:16px;font-size:1rem;line-height:1em;padding-top:13px;padding-right:30px;padding-bottom:13px;padding-left:30px;}.wp-block-buttons .wp-block-button.is-style-outline > .wp-block-button__link:not(.has-text-color),.wp-block-buttons .wp-block-button.wp-block-button__link.is-style-outline:not(.has-text-color),.ast-outline-button{color:var(--ast-global-color-0);}.wp-block-button.is-style-outline .wp-block-button__link:hover,.wp-block-buttons .wp-block-button.is-style-outline .wp-block-button__link:focus,.wp-block-buttons .wp-block-button.is-style-outline > .wp-block-button__link:not(.has-text-color):hover,.wp-block-buttons .wp-block-button.wp-block-button__link.is-style-outline:not(.has-text-color):hover,.ast-outline-button:hover,.ast-outline-button:focus,.wp-block-uagb-buttons-child .uagb-buttons-repeater.ast-outline-button:hover,.wp-block-uagb-buttons-child .uagb-buttons-repeater.ast-outline-button:focus{color:#ffffff;background-color:var(--ast-global-color-1);border-color:var(--ast-global-color-1);}.ast-single-post .entry-content a.ast-outline-button,.ast-single-post .entry-content .is-style-outline>.wp-block-button__link{text-decoration:none;}.wp-block-button .wp-block-button__link.wp-element-button.is-style-outline:not(.has-background),.wp-block-button.is-style-outline>.wp-block-button__link.wp-element-button:not(.has-background),.ast-outline-button{background-color:transparent;}.uagb-buttons-repeater.ast-outline-button{border-radius:9999px;}@media (max-width:921px){.wp-block-buttons .wp-block-button.is-style-outline .wp-block-button__link.wp-element-button,.ast-outline-button,.wp-block-uagb-buttons-child .uagb-buttons-repeater.ast-outline-button{padding-top:12px;padding-right:28px;padding-bottom:12px;padding-left:28px;}}@media (max-width:544px){.wp-block-buttons .wp-block-button.is-style-outline .wp-block-button__link.wp-element-button,.ast-outline-button,.wp-block-uagb-buttons-child .uagb-buttons-repeater.ast-outline-button{padding-top:10px;padding-right:24px;padding-bottom:10px;padding-left:24px;}}.entry-content[data-ast-blocks-layout] > figure{margin-bottom:1em;}h1.widget-title{font-weight:600;}h2.widget-title{font-weight:600;}h3.widget-title{font-weight:600;}#page{display:flex;flex-direction:column;min-height:100vh;}.ast-404-layout-1 h1.page-title{color:var(--ast-global-color-2);}.single .post-navigation a{line-height:1em;height:inherit;}.error-404 .page-sub-title{font-size:1.5rem;font-weight:inherit;}.search .site-content .content-area .search-form{margin-bottom:0;}#page .site-content{flex-grow:1;}.widget{margin-bottom:1.25em;}#secondary li{line-height:1.5em;}#secondary .wp-block-group h2{margin-bottom:0.7em;}#secondary h2{font-size:1.7rem;}.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single,.ast-separate-container .comment-respond{padding:3em;}.ast-separate-container .ast-article-single .ast-article-single{padding:0;}.ast-article-single .wp-block-post-template-is-layout-grid{padding-left:0;}.ast-separate-container .comments-title,.ast-narrow-container .comments-title{padding:1.5em 2em;}.ast-page-builder-template .comment-form-textarea,.ast-comment-formwrap .ast-grid-common-col{padding:0;}.ast-comment-formwrap{padding:0;display:inline-flex;column-gap:20px;width:100%;margin-left:0;margin-right:0;}.comments-area textarea#comment:focus,.comments-area textarea#comment:active,.comments-area .ast-comment-formwrap input[type="text"]:focus,.comments-area .ast-comment-formwrap input[type="text"]:active {box-shadow:none;outline:none;}.archive.ast-page-builder-template .entry-header{margin-top:2em;}.ast-page-builder-template .ast-comment-formwrap{width:100%;}.entry-title{margin-bottom:0.6em;}.ast-archive-description p{font-size:inherit;font-weight:inherit;line-height:inherit;}.ast-separate-container .ast-comment-list li.depth-1,.hentry{margin-bottom:1.5em;}.site-content section.ast-archive-description{margin-bottom:2em;}@media (min-width:921px){.ast-left-sidebar.ast-page-builder-template #secondary,.archive.ast-right-sidebar.ast-page-builder-template .site-main{padding-left:20px;padding-right:20px;}}@media (max-width:544px){.ast-comment-formwrap.ast-row{column-gap:10px;display:inline-block;}#ast-commentform .ast-grid-common-col{position:relative;width:100%;}}@media (min-width:1201px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single,.ast-separate-container .ast-author-box,.ast-separate-container .ast-404-layout-1,.ast-separate-container .no-results{padding:3em;}}@media (max-width:921px){.ast-separate-container #primary,.ast-separate-container #secondary{padding:1.5em 0;}#primary,#secondary{padding:1.5em 0;margin:0;}.ast-left-sidebar #content > .ast-container{display:flex;flex-direction:column-reverse;width:100%;}}@media (min-width:922px){.ast-separate-container.ast-right-sidebar #primary,.ast-separate-container.ast-left-sidebar #primary{border:0;}.search-no-results.ast-separate-container #primary{margin-bottom:4em;}}.wp-block-button .wp-block-button__link{color:#ffffff;}.wp-block-button .wp-block-button__link:hover,.wp-block-button .wp-block-button__link:focus{color:#ffffff;background-color:var(--ast-global-color-1);border-color:var(--ast-global-color-1);}.elementor-widget-heading h1.elementor-heading-title{line-height:1.4em;}.elementor-widget-heading h2.elementor-heading-title{line-height:1.3em;}.elementor-widget-heading h3.elementor-heading-title{line-height:1.3em;}.elementor-widget-heading h4.elementor-heading-title{line-height:1.2em;}.elementor-widget-heading h5.elementor-heading-title{line-height:1.2em;}.elementor-widget-heading h6.elementor-heading-title{line-height:1.25em;}.wp-block-button .wp-block-button__link,.wp-block-search .wp-block-search__button,body .wp-block-file .wp-block-file__button{border-color:var(--ast-global-color-0);background-color:var(--ast-global-color-0);color:#ffffff;font-family:inherit;font-weight:500;line-height:1em;font-size:16px;font-size:1rem;padding-top:15px;padding-right:30px;padding-bottom:15px;padding-left:30px;}.ast-single-post .entry-content .wp-block-button .wp-block-button__link,.ast-single-post .entry-content .wp-block-search .wp-block-search__button,body .entry-content .wp-block-file .wp-block-file__button{text-decoration:none;}@media (max-width:921px){.wp-block-button .wp-block-button__link,.wp-block-search .wp-block-search__button,body .wp-block-file .wp-block-file__button{padding-top:14px;padding-right:28px;padding-bottom:14px;padding-left:28px;}}@media (max-width:544px){.wp-block-button .wp-block-button__link,.wp-block-search .wp-block-search__button,body .wp-block-file .wp-block-file__button{padding-top:12px;padding-right:24px;padding-bottom:12px;padding-left:24px;}}.menu-toggle,button,.ast-button,.ast-custom-button,.button,input#submit,input[type="button"],input[type="submit"],input[type="reset"],#comments .submit,.search .search-submit,form[CLASS*="wp-block-search__"].wp-block-search .wp-block-search__inside-wrapper .wp-block-search__button,body .wp-block-file .wp-block-file__button,.search .search-submit{border-style:solid;border-top-width:0;border-right-width:0;border-left-width:0;border-bottom-width:0;color:#ffffff;border-color:var(--ast-global-color-0);background-color:var(--ast-global-color-0);padding-top:15px;padding-right:30px;padding-bottom:15px;padding-left:30px;font-family:inherit;font-weight:500;font-size:16px;font-size:1rem;line-height:1em;}button:focus,.menu-toggle:hover,button:hover,.ast-button:hover,.ast-custom-button:hover .button:hover,.ast-custom-button:hover ,input[type=reset]:hover,input[type=reset]:focus,input#submit:hover,input#submit:focus,input[type="button"]:hover,input[type="button"]:focus,input[type="submit"]:hover,input[type="submit"]:focus,form[CLASS*="wp-block-search__"].wp-block-search .wp-block-search__inside-wrapper .wp-block-search__button:hover,form[CLASS*="wp-block-search__"].wp-block-search .wp-block-search__inside-wrapper .wp-block-search__button:focus,body .wp-block-file .wp-block-file__button:hover,body .wp-block-file .wp-block-file__button:focus{color:#ffffff;background-color:var(--ast-global-color-1);border-color:var(--ast-global-color-1);}form[CLASS*="wp-block-search__"].wp-block-search .wp-block-search__inside-wrapper .wp-block-search__button.has-icon{padding-top:calc(15px - 3px);padding-right:calc(30px - 3px);padding-bottom:calc(15px - 3px);padding-left:calc(30px - 3px);}@media (max-width:921px){.menu-toggle,button,.ast-button,.ast-custom-button,.button,input#submit,input[type="button"],input[type="submit"],input[type="reset"],#comments .submit,.search .search-submit,form[CLASS*="wp-block-search__"].wp-block-search .wp-block-search__inside-wrapper .wp-block-search__button,body .wp-block-file .wp-block-file__button,.search .search-submit{padding-top:14px;padding-right:28px;padding-bottom:14px;padding-left:28px;}}@media (max-width:544px){.menu-toggle,button,.ast-button,.ast-custom-button,.button,input#submit,input[type="button"],input[type="submit"],input[type="reset"],#comments .submit,.search .search-submit,form[CLASS*="wp-block-search__"].wp-block-search .wp-block-search__inside-wrapper .wp-block-search__button,body .wp-block-file .wp-block-file__button,.search .search-submit{padding-top:12px;padding-right:24px;padding-bottom:12px;padding-left:24px;}}@media (max-width:921px){.ast-mobile-header-stack .main-header-bar .ast-search-menu-icon{display:inline-block;}.ast-header-break-point.ast-header-custom-item-outside .ast-mobile-header-stack .main-header-bar .ast-search-icon{margin:0;}.ast-comment-avatar-wrap img{max-width:2.5em;}.ast-comment-meta{padding:0 1.8888em 1.3333em;}}@media (min-width:544px){.ast-container{max-width:100%;}}@media (max-width:544px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single,.ast-separate-container .comments-title,.ast-separate-container .ast-archive-description{padding:1.5em 1em;}.ast-separate-container #content .ast-container{padding-left:0.54em;padding-right:0.54em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-search-menu-icon.ast-dropdown-active .search-field{width:170px;}} #ast-mobile-header .ast-site-header-cart-li a{pointer-events:none;}.ast-separate-container{background-color:var(--ast-global-color-5);}@media (max-width:921px){.site-title{display:block;}.site-header .site-description{display:block;}h1,.entry-content h1{font-size:30px;font-size:1.875rem;}h2,.entry-content h2{font-size:25px;font-size:1.5625rem;}h3,.entry-content h3{font-size:20px;font-size:1.25rem;}}@media (max-width:544px){.site-title{display:block;}.site-header .site-description{display:block;}h1,.entry-content h1{font-size:30px;font-size:1.875rem;}h2,.entry-content h2{font-size:25px;font-size:1.5625rem;}h3,.entry-content h3{font-size:20px;font-size:1.25rem;}header .custom-logo-link img,.ast-header-break-point .site-branding img,.ast-header-break-point .custom-logo-link img{max-width:88px;width:88px;}.astra-logo-svg{width:88px;}.ast-header-break-point .site-logo-img .custom-mobile-logo-link img{max-width:88px;}}@media (max-width:921px){html{font-size:91.2%;}}@media (max-width:544px){html{font-size:91.2%;}}@media (min-width:922px){.ast-container{max-width:1240px;}}@media (min-width:922px){.site-content .ast-container{display:flex;}}@media (max-width:921px){.site-content .ast-container{flex-direction:column;}}.entry-content h1,.entry-content h2,.entry-content h3,.entry-content h4,.entry-content h5,.entry-content h6{clear:none;}@media (min-width:922px){.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu:hover > .sub-menu,.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu.focus > .sub-menu{margin-left:-0px;}}.entry-content li > p{margin-bottom:0;}.site .comments-area{padding-bottom:2em;margin-top:2em;}.wp-block-file {display: flex;align-items: center;flex-wrap: wrap;justify-content: space-between;}.wp-block-pullquote {border: none;}.wp-block-pullquote blockquote::before {content: "\201D";font-family: "Helvetica",sans-serif;display: flex;transform: rotate( 180deg );font-size: 6rem;font-style: normal;line-height: 1;font-weight: bold;align-items: center;justify-content: center;}.has-text-align-right > blockquote::before {justify-content: flex-start;}.has-text-align-left > blockquote::before {justify-content: flex-end;}figure.wp-block-pullquote.is-style-solid-color blockquote {max-width: 100%;text-align: inherit;}:root {--wp--custom--ast-default-block-top-padding: 3em;--wp--custom--ast-default-block-right-padding: 3em;--wp--custom--ast-default-block-bottom-padding: 3em;--wp--custom--ast-default-block-left-padding: 3em;--wp--custom--ast-container-width: 1200px;--wp--custom--ast-content-width-size: 1200px;--wp--custom--ast-wide-width-size: calc(1200px + var(--wp--custom--ast-default-block-left-padding) + var(--wp--custom--ast-default-block-right-padding));}.ast-narrow-container {--wp--custom--ast-content-width-size: 750px;--wp--custom--ast-wide-width-size: 750px;}@media(max-width: 921px) {:root {--wp--custom--ast-default-block-top-padding: 3em;--wp--custom--ast-default-block-right-padding: 2em;--wp--custom--ast-default-block-bottom-padding: 3em;--wp--custom--ast-default-block-left-padding: 2em;}}@media(max-width: 544px) {:root {--wp--custom--ast-default-block-top-padding: 3em;--wp--custom--ast-default-block-right-padding: 1.5em;--wp--custom--ast-default-block-bottom-padding: 3em;--wp--custom--ast-default-block-left-padding: 1.5em;}}.entry-content > .wp-block-group,.entry-content > .wp-block-cover,.entry-content > .wp-block-columns {padding-top: var(--wp--custom--ast-default-block-top-padding);padding-right: var(--wp--custom--ast-default-block-right-padding);padding-bottom: var(--wp--custom--ast-default-block-bottom-padding);padding-left: var(--wp--custom--ast-default-block-left-padding);}.ast-plain-container.ast-no-sidebar .entry-content > .alignfull,.ast-page-builder-template .ast-no-sidebar .entry-content > .alignfull {margin-left: calc( -50vw + 50%);margin-right: calc( -50vw + 50%);max-width: 100vw;width: 100vw;}.ast-plain-container.ast-no-sidebar .entry-content .alignfull .alignfull,.ast-page-builder-template.ast-no-sidebar .entry-content .alignfull .alignfull,.ast-plain-container.ast-no-sidebar .entry-content .alignfull .alignwide,.ast-page-builder-template.ast-no-sidebar .entry-content .alignfull .alignwide,.ast-plain-container.ast-no-sidebar .entry-content .alignwide .alignfull,.ast-page-builder-template.ast-no-sidebar .entry-content .alignwide .alignfull,.ast-plain-container.ast-no-sidebar .entry-content .alignwide .alignwide,.ast-page-builder-template.ast-no-sidebar .entry-content .alignwide .alignwide,.ast-plain-container.ast-no-sidebar .entry-content .wp-block-column .alignfull,.ast-page-builder-template.ast-no-sidebar .entry-content .wp-block-column .alignfull,.ast-plain-container.ast-no-sidebar .entry-content .wp-block-column .alignwide,.ast-page-builder-template.ast-no-sidebar .entry-content .wp-block-column .alignwide {margin-left: auto;margin-right: auto;width: 100%;}[data-ast-blocks-layout] .wp-block-separator:not(.is-style-dots) {height: 0;}[data-ast-blocks-layout] .wp-block-separator {margin: 20px auto;}[data-ast-blocks-layout] .wp-block-separator:not(.is-style-wide):not(.is-style-dots) {max-width: 100px;}[data-ast-blocks-layout] .wp-block-separator.has-background {padding: 0;}.entry-content[data-ast-blocks-layout] > * {max-width: var(--wp--custom--ast-content-width-size);margin-left: auto;margin-right: auto;}.entry-content[data-ast-blocks-layout] > .alignwide {max-width: var(--wp--custom--ast-wide-width-size);}.entry-content[data-ast-blocks-layout] .alignfull {max-width: none;}.entry-content .wp-block-columns {margin-bottom: 0;}blockquote {margin: 1.5em;border-color: rgba(0,0,0,0.05);}.wp-block-quote:not(.has-text-align-right):not(.has-text-align-center) {border-left: 5px solid rgba(0,0,0,0.05);}.has-text-align-right > blockquote,blockquote.has-text-align-right {border-right: 5px solid rgba(0,0,0,0.05);}.has-text-align-left > blockquote,blockquote.has-text-align-left {border-left: 5px solid rgba(0,0,0,0.05);}.wp-block-site-tagline,.wp-block-latest-posts .read-more {margin-top: 15px;}.wp-block-loginout p label {display: block;}.wp-block-loginout p:not(.login-remember):not(.login-submit) input {width: 100%;}.wp-block-loginout input:focus {border-color: transparent;}.wp-block-loginout input:focus {outline: thin dotted;}.entry-content .wp-block-media-text .wp-block-media-text__content {padding: 0 0 0 8%;}.entry-content .wp-block-media-text.has-media-on-the-right .wp-block-media-text__content {padding: 0 8% 0 0;}.entry-content .wp-block-media-text.has-background .wp-block-media-text__content {padding: 8%;}.entry-content .wp-block-cover:not([class*="background-color"]):not(.has-text-color.has-link-color) .wp-block-cover__inner-container,.entry-content .wp-block-cover:not([class*="background-color"]) .wp-block-cover-image-text,.entry-content .wp-block-cover:not([class*="background-color"]) .wp-block-cover-text,.entry-content .wp-block-cover-image:not([class*="background-color"]) .wp-block-cover__inner-container,.entry-content .wp-block-cover-image:not([class*="background-color"]) .wp-block-cover-image-text,.entry-content .wp-block-cover-image:not([class*="background-color"]) .wp-block-cover-text {color: var(--ast-global-color-primary,var(--ast-global-color-5));}.wp-block-loginout .login-remember input {width: 1.1rem;height: 1.1rem;margin: 0 5px 4px 0;vertical-align: middle;}.wp-block-latest-posts > li > *:first-child,.wp-block-latest-posts:not(.is-grid) > li:first-child {margin-top: 0;}.entry-content > .wp-block-buttons,.entry-content > .wp-block-uagb-buttons {margin-bottom: 1.5em;}.wp-block-search__inside-wrapper .wp-block-search__input {padding: 0 10px;color: var(--ast-global-color-3);background: var(--ast-global-color-primary,var(--ast-global-color-5));border-color: var(--ast-border-color);}.wp-block-latest-posts .read-more {margin-bottom: 1.5em;}.wp-block-search__no-button .wp-block-search__inside-wrapper .wp-block-search__input {padding-top: 5px;padding-bottom: 5px;}.wp-block-latest-posts .wp-block-latest-posts__post-date,.wp-block-latest-posts .wp-block-latest-posts__post-author {font-size: 1rem;}.wp-block-latest-posts > li > *,.wp-block-latest-posts:not(.is-grid) > li {margin-top: 12px;margin-bottom: 12px;}.ast-page-builder-template .entry-content[data-ast-blocks-layout] > *,.ast-page-builder-template .entry-content[data-ast-blocks-layout] > .alignfull:not(.wp-block-group):not(.uagb-is-root-container) > * {max-width: none;}.ast-page-builder-template .entry-content[data-ast-blocks-layout] > .alignwide:not(.uagb-is-root-container) > * {max-width: var(--wp--custom--ast-wide-width-size);}.ast-page-builder-template .entry-content[data-ast-blocks-layout] > .inherit-container-width > *,.ast-page-builder-template .entry-content[data-ast-blocks-layout] > *:not(.wp-block-group):not(.uagb-is-root-container) > *,.entry-content[data-ast-blocks-layout] > .wp-block-cover .wp-block-cover__inner-container {max-width: none ;margin-left: auto;margin-right: auto;}.entry-content[data-ast-blocks-layout] .wp-block-cover:not(.alignleft):not(.alignright) {width: auto;}@media(max-width: 1200px) {.ast-separate-container .entry-content > .alignfull,.ast-separate-container .entry-content[data-ast-blocks-layout] > .alignwide,.ast-plain-container .entry-content[data-ast-blocks-layout] > .alignwide,.ast-plain-container .entry-content .alignfull {margin-left: calc(-1 * min(var(--ast-container-default-xlg-padding),20px)) ;margin-right: calc(-1 * min(var(--ast-container-default-xlg-padding),20px));}}@media(min-width: 1201px) {.ast-separate-container .entry-content > .alignfull {margin-left: calc(-1 * var(--ast-container-default-xlg-padding) );margin-right: calc(-1 * var(--ast-container-default-xlg-padding) );}.ast-separate-container .entry-content[data-ast-blocks-layout] > .alignwide,.ast-plain-container .entry-content[data-ast-blocks-layout] > .alignwide {margin-left: auto;margin-right: auto;}}@media(min-width: 921px) {.ast-separate-container .entry-content .wp-block-group.alignwide:not(.inherit-container-width) > :where(:not(.alignleft):not(.alignright)),.ast-plain-container .entry-content .wp-block-group.alignwide:not(.inherit-container-width) > :where(:not(.alignleft):not(.alignright)) {max-width: calc( var(--wp--custom--ast-content-width-size) + 80px );}.ast-plain-container.ast-right-sidebar .entry-content[data-ast-blocks-layout] .alignfull,.ast-plain-container.ast-left-sidebar .entry-content[data-ast-blocks-layout] .alignfull {margin-left: -60px;margin-right: -60px;}}@media(min-width: 544px) {.entry-content > .alignleft {margin-right: 20px;}.entry-content > .alignright {margin-left: 20px;}}@media (max-width:544px){.wp-block-columns .wp-block-column:not(:last-child){margin-bottom:20px;}.wp-block-latest-posts{margin:0;}}@media( max-width: 600px ) {.entry-content .wp-block-media-text .wp-block-media-text__content,.entry-content .wp-block-media-text.has-media-on-the-right .wp-block-media-text__content {padding: 8% 0 0;}.entry-content .wp-block-media-text.has-background .wp-block-media-text__content {padding: 8%;}}.ast-page-builder-template .entry-header {padding-left: 0;}.ast-narrow-container .site-content .wp-block-uagb-image--align-full .wp-block-uagb-image__figure {max-width: 100%;margin-left: auto;margin-right: auto;}.entry-content ul,.entry-content ol {padding: revert;margin: revert;padding-left: 20px;}:root .has-ast-global-color-0-color{color:var(--ast-global-color-0);}:root .has-ast-global-color-0-background-color{background-color:var(--ast-global-color-0);}:root .wp-block-button .has-ast-global-color-0-color{color:var(--ast-global-color-0);}:root .wp-block-button .has-ast-global-color-0-background-color{background-color:var(--ast-global-color-0);}:root .has-ast-global-color-1-color{color:var(--ast-global-color-1);}:root .has-ast-global-color-1-background-color{background-color:var(--ast-global-color-1);}:root .wp-block-button .has-ast-global-color-1-color{color:var(--ast-global-color-1);}:root .wp-block-button .has-ast-global-color-1-background-color{background-color:var(--ast-global-color-1);}:root .has-ast-global-color-2-color{color:var(--ast-global-color-2);}:root .has-ast-global-color-2-background-color{background-color:var(--ast-global-color-2);}:root .wp-block-button .has-ast-global-color-2-color{color:var(--ast-global-color-2);}:root .wp-block-button .has-ast-global-color-2-background-color{background-color:var(--ast-global-color-2);}:root .has-ast-global-color-3-color{color:var(--ast-global-color-3);}:root .has-ast-global-color-3-background-color{background-color:var(--ast-global-color-3);}:root .wp-block-button .has-ast-global-color-3-color{color:var(--ast-global-color-3);}:root .wp-block-button .has-ast-global-color-3-background-color{background-color:var(--ast-global-color-3);}:root .has-ast-global-color-4-color{color:var(--ast-global-color-4);}:root .has-ast-global-color-4-background-color{background-color:var(--ast-global-color-4);}:root .wp-block-button .has-ast-global-color-4-color{color:var(--ast-global-color-4);}:root .wp-block-button .has-ast-global-color-4-background-color{background-color:var(--ast-global-color-4);}:root .has-ast-global-color-5-color{color:var(--ast-global-color-5);}:root .has-ast-global-color-5-background-color{background-color:var(--ast-global-color-5);}:root .wp-block-button .has-ast-global-color-5-color{color:var(--ast-global-color-5);}:root .wp-block-button .has-ast-global-color-5-background-color{background-color:var(--ast-global-color-5);}:root .has-ast-global-color-6-color{color:var(--ast-global-color-6);}:root .has-ast-global-color-6-background-color{background-color:var(--ast-global-color-6);}:root .wp-block-button .has-ast-global-color-6-color{color:var(--ast-global-color-6);}:root .wp-block-button .has-ast-global-color-6-background-color{background-color:var(--ast-global-color-6);}:root .has-ast-global-color-7-color{color:var(--ast-global-color-7);}:root .has-ast-global-color-7-background-color{background-color:var(--ast-global-color-7);}:root .wp-block-button .has-ast-global-color-7-color{color:var(--ast-global-color-7);}:root .wp-block-button .has-ast-global-color-7-background-color{background-color:var(--ast-global-color-7);}:root .has-ast-global-color-8-color{color:var(--ast-global-color-8);}:root .has-ast-global-color-8-background-color{background-color:var(--ast-global-color-8);}:root .wp-block-button .has-ast-global-color-8-color{color:var(--ast-global-color-8);}:root .wp-block-button .has-ast-global-color-8-background-color{background-color:var(--ast-global-color-8);}:root{--ast-global-color-0:#046bd2;--ast-global-color-1:#045cb4;--ast-global-color-2:#1e293b;--ast-global-color-3:#334155;--ast-global-color-4:#FFFFFF;--ast-global-color-5:#F0F5FA;--ast-global-color-6:#111111;--ast-global-color-7:#D1D5DB;--ast-global-color-8:#111111;}:root {--ast-border-color : var(--ast-global-color-7);}.ast-single-entry-banner {-js-display: flex;display: flex;flex-direction: column;justify-content: center;text-align: center;position: relative;background: var(--ast-title-layout-bg);}.ast-single-entry-banner[data-banner-layout="layout-1"] {max-width: 1200px;background: inherit;padding: 20px 0;}.ast-single-entry-banner[data-banner-width-type="custom"] {margin: 0 auto;width: 100%;}.ast-single-entry-banner + .site-content .entry-header {margin-bottom: 0;}.site .ast-author-avatar {--ast-author-avatar-size: ;}a.ast-underline-text {text-decoration: underline;}.ast-container > .ast-terms-link {position: relative;display: block;}a.ast-button.ast-badge-tax {padding: 4px 8px;border-radius: 3px;font-size: inherit;}header.entry-header .entry-title{font-weight:600;font-size:32px;font-size:2rem;}header.entry-header > *:not(:last-child){margin-bottom:10px;}header.entry-header .post-thumb-img-content{text-align:center;}header.entry-header .post-thumb img,.ast-single-post-featured-section.post-thumb img{aspect-ratio:16/9;width:100%;height:100%;}.ast-archive-entry-banner {-js-display: flex;display: flex;flex-direction: column;justify-content: center;text-align: center;position: relative;background: var(--ast-title-layout-bg);}.ast-archive-entry-banner[data-banner-width-type="custom"] {margin: 0 auto;width: 100%;}.ast-archive-entry-banner[data-banner-layout="layout-1"] {background: inherit;padding: 20px 0;text-align: left;}body.archive .ast-archive-description{max-width:1200px;width:100%;text-align:left;padding-top:3em;padding-right:3em;padding-bottom:3em;padding-left:3em;}body.archive .ast-archive-description .ast-archive-title,body.archive .ast-archive-description .ast-archive-title *{font-weight:600;font-size:32px;font-size:2rem;}body.archive .ast-archive-description > *:not(:last-child){margin-bottom:10px;}@media (max-width:921px){body.archive .ast-archive-description{text-align:left;}}@media (max-width:544px){body.archive .ast-archive-description{text-align:left;}}.ast-breadcrumbs .trail-browse,.ast-breadcrumbs .trail-items,.ast-breadcrumbs .trail-items li{display:inline-block;margin:0;padding:0;border:none;background:inherit;text-indent:0;text-decoration:none;}.ast-breadcrumbs .trail-browse{font-size:inherit;font-style:inherit;font-weight:inherit;color:inherit;}.ast-breadcrumbs .trail-items{list-style:none;}.trail-items li::after{padding:0 0.3em;content:"\00bb";}.trail-items li:last-of-type::after{display:none;}h1,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6{color:var(--ast-global-color-2);}.entry-title a{color:var(--ast-global-color-2);}@media (max-width:921px){.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-firstrow .ast-builder-grid-row > *:first-child,.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-lastrow .ast-builder-grid-row > *:last-child{grid-column:1 / -1;}}@media (max-width:544px){.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-firstrow .ast-builder-grid-row > *:first-child,.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-lastrow .ast-builder-grid-row > *:last-child{grid-column:1 / -1;}}.ast-builder-layout-element[data-section="title_tagline"]{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-builder-layout-element[data-section="title_tagline"]{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-builder-layout-element[data-section="title_tagline"]{display:flex;}}.ast-builder-menu-1{font-family:inherit;font-weight:inherit;}.ast-builder-menu-1 .menu-item > .menu-link{color:var(--ast-global-color-3);}.ast-builder-menu-1 .menu-item > .ast-menu-toggle{color:var(--ast-global-color-3);}.ast-builder-menu-1 .menu-item:hover > .menu-link,.ast-builder-menu-1 .inline-on-mobile .menu-item:hover > .ast-menu-toggle{color:var(--ast-global-color-1);}.ast-builder-menu-1 .menu-item:hover > .ast-menu-toggle{color:var(--ast-global-color-1);}.ast-builder-menu-1 .menu-item.current-menu-item > .menu-link,.ast-builder-menu-1 .inline-on-mobile .menu-item.current-menu-item > .ast-menu-toggle,.ast-builder-menu-1 .current-menu-ancestor > .menu-link{color:var(--ast-global-color-1);}.ast-builder-menu-1 .menu-item.current-menu-item > .ast-menu-toggle{color:var(--ast-global-color-1);}.ast-builder-menu-1 .sub-menu,.ast-builder-menu-1 .inline-on-mobile .sub-menu{border-top-width:2px;border-bottom-width:0px;border-right-width:0px;border-left-width:0px;border-color:var(--ast-global-color-0);border-style:solid;}.ast-builder-menu-1 .sub-menu .sub-menu{top:-2px;}.ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu,.ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper{margin-top:0px;}.ast-desktop .ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu:before,.ast-desktop .ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper:before{height:calc( 0px + 2px + 5px );}.ast-desktop .ast-builder-menu-1 .menu-item .sub-menu .menu-link{border-style:none;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-1 .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-1 .inline-on-mobile .menu-item.menu-item-has-children > .ast-menu-toggle{right:-15px;}.ast-builder-menu-1 .menu-item-has-children > .menu-link:after{content:unset;}.ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu,.ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper{margin-top:0;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-1 .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu,.ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper{margin-top:0;}}.ast-builder-menu-1{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-1{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-1{display:flex;}}.site-below-footer-wrap{padding-top:20px;padding-bottom:20px;}.site-below-footer-wrap[data-section="section-below-footer-builder"]{background-color:var(--ast-global-color-4 );min-height:60px;border-style:solid;border-width:0px;border-top-width:1px;border-top-color:var( --ast-global-color-subtle-background,--ast-global-color-7 );}.site-below-footer-wrap[data-section="section-below-footer-builder"] .ast-builder-grid-row{max-width:1200px;min-height:60px;margin-left:auto;margin-right:auto;}.site-below-footer-wrap[data-section="section-below-footer-builder"] .ast-builder-grid-row,.site-below-footer-wrap[data-section="section-below-footer-builder"] .site-footer-section{align-items:center;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-inline .site-footer-section{display:flex;margin-bottom:0;}.ast-builder-grid-row-full .ast-builder-grid-row{grid-template-columns:1fr;}@media (max-width:921px){.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-tablet-inline .site-footer-section{display:flex;margin-bottom:0;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-tablet-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-full .ast-builder-grid-row{grid-template-columns:1fr;}}@media (max-width:544px){.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-mobile-inline .site-footer-section{display:flex;margin-bottom:0;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-mobile-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-full .ast-builder-grid-row{grid-template-columns:1fr;}}.site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}@media (max-width:921px){.ast-header-break-point .site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}}@media (max-width:544px){.ast-header-break-point .site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}}.ast-footer-copyright{text-align:center;}.ast-footer-copyright {color:var(--ast-global-color-3);}@media (max-width:921px){.ast-footer-copyright{text-align:center;}}@media (max-width:544px){.ast-footer-copyright{text-align:center;}}.ast-footer-copyright {font-size:16px;font-size:1rem;}.ast-footer-copyright.ast-builder-layout-element{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-footer-copyright.ast-builder-layout-element{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-footer-copyright.ast-builder-layout-element{display:flex;}}.site-above-footer-wrap{padding-top:20px;padding-bottom:20px;}.site-above-footer-wrap[data-section="section-above-footer-builder"]{background-color:#eeeeee;min-height:60px;}.site-above-footer-wrap[data-section="section-above-footer-builder"] .ast-builder-grid-row{max-width:1200px;min-height:60px;margin-left:auto;margin-right:auto;}.site-above-footer-wrap[data-section="section-above-footer-builder"] .ast-builder-grid-row,.site-above-footer-wrap[data-section="section-above-footer-builder"] .site-footer-section{align-items:flex-start;}.site-above-footer-wrap[data-section="section-above-footer-builder"].ast-footer-row-inline .site-footer-section{display:flex;margin-bottom:0;}.ast-builder-grid-row-2-equal .ast-builder-grid-row{grid-template-columns:repeat( 2,1fr );}@media (max-width:921px){.site-above-footer-wrap[data-section="section-above-footer-builder"].ast-footer-row-tablet-inline .site-footer-section{display:flex;margin-bottom:0;}.site-above-footer-wrap[data-section="section-above-footer-builder"].ast-footer-row-tablet-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-2-equal .ast-builder-grid-row{grid-template-columns:repeat( 2,1fr );}}@media (max-width:544px){.site-above-footer-wrap[data-section="section-above-footer-builder"].ast-footer-row-mobile-inline .site-footer-section{display:flex;margin-bottom:0;}.site-above-footer-wrap[data-section="section-above-footer-builder"].ast-footer-row-mobile-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-full .ast-builder-grid-row{grid-template-columns:1fr;}}.site-above-footer-wrap[data-section="section-above-footer-builder"]{display:grid;}@media (max-width:921px){.ast-header-break-point .site-above-footer-wrap[data-section="section-above-footer-builder"]{display:grid;}}@media (max-width:544px){.ast-header-break-point .site-above-footer-wrap[data-section="section-above-footer-builder"]{display:grid;}}.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"].footer-widget-area-inner{text-align:left;}.footer-widget-area.widget-area.site-footer-focus-item{width:auto;}.ast-footer-row-inline .footer-widget-area.widget-area.site-footer-focus-item{width:100%;}.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"]{display:block;}@media (max-width:921px){.ast-header-break-point .footer-widget-area[data-section="sidebar-widgets-footer-widget-1"]{display:block;}}@media (max-width:544px){.ast-header-break-point .footer-widget-area[data-section="sidebar-widgets-footer-widget-1"]{display:block;}}.elementor-widget-heading .elementor-heading-title{margin:0;}.elementor-page .ast-menu-toggle{color:unset !important;background:unset !important;}.elementor-post.elementor-grid-item.hentry{margin-bottom:0;}.woocommerce div.product .elementor-element.elementor-products-grid .related.products ul.products li.product,.elementor-element .elementor-wc-products .woocommerce[class*='columns-'] ul.products li.product{width:auto;margin:0;float:none;}.elementor-toc__list-wrapper{margin:0;}body .elementor hr{background-color:#ccc;margin:0;}.ast-left-sidebar .elementor-section.elementor-section-stretched,.ast-right-sidebar .elementor-section.elementor-section-stretched{max-width:100%;left:0 !important;}.elementor-posts-container [CLASS*="ast-width-"]{width:100%;}.elementor-template-full-width .ast-container{display:block;}.elementor-screen-only,.screen-reader-text,.screen-reader-text span,.ui-helper-hidden-accessible{top:0 !important;}@media (max-width:544px){.elementor-element .elementor-wc-products .woocommerce[class*="columns-"] ul.products li.product{width:auto;margin:0;}.elementor-element .woocommerce .woocommerce-result-count{float:none;}}.ast-header-break-point .main-header-bar{border-bottom-width:1px;}@media (min-width:922px){.main-header-bar{border-bottom-width:1px;}}.main-header-menu .menu-item, #astra-footer-menu .menu-item, .main-header-bar .ast-masthead-custom-menu-items{-js-display:flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;}.main-header-menu > .menu-item > .menu-link, #astra-footer-menu > .menu-item > .menu-link{height:100%;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-js-display:flex;display:flex;}.ast-header-break-point .main-navigation ul .menu-item .menu-link .icon-arrow:first-of-type svg{top:.2em;margin-top:0px;margin-left:0px;width:.65em;transform:translate(0, -2px) rotateZ(270deg);}.ast-mobile-popup-content .ast-submenu-expanded > .ast-menu-toggle{transform:rotateX(180deg);overflow-y:auto;}@media (min-width:922px){.ast-builder-menu .main-navigation > ul > li:last-child a{margin-right:0;}}.ast-separate-container .ast-article-inner{background-color:var(--ast-global-color-4);}@media (max-width:921px){.ast-separate-container .ast-article-inner{background-color:var(--ast-global-color-4);}}@media (max-width:544px){.ast-separate-container .ast-article-inner{background-color:var(--ast-global-color-4);}}.ast-separate-container .ast-article-single:not(.ast-related-post), .ast-separate-container .error-404, .ast-separate-container .no-results, .single.ast-separate-container .site-main .ast-author-meta, .ast-separate-container .related-posts-title-wrapper, .ast-separate-container .comments-count-wrapper, .ast-box-layout.ast-plain-container .site-content, .ast-padded-layout.ast-plain-container .site-content, .ast-separate-container .ast-archive-description, .ast-separate-container .comments-area{background-color:var(--ast-global-color-4);}@media (max-width:921px){.ast-separate-container .ast-article-single:not(.ast-related-post), .ast-separate-container .error-404, .ast-separate-container .no-results, .single.ast-separate-container .site-main .ast-author-meta, .ast-separate-container .related-posts-title-wrapper, .ast-separate-container .comments-count-wrapper, .ast-box-layout.ast-plain-container .site-content, .ast-padded-layout.ast-plain-container .site-content, .ast-separate-container .ast-archive-description{background-color:var(--ast-global-color-4);}}@media (max-width:544px){.ast-separate-container .ast-article-single:not(.ast-related-post), .ast-separate-container .error-404, .ast-separate-container .no-results, .single.ast-separate-container .site-main .ast-author-meta, .ast-separate-container .related-posts-title-wrapper, .ast-separate-container .comments-count-wrapper, .ast-box-layout.ast-plain-container .site-content, .ast-padded-layout.ast-plain-container .site-content, .ast-separate-container .ast-archive-description{background-color:var(--ast-global-color-4);}}.ast-separate-container.ast-two-container #secondary .widget{background-color:var(--ast-global-color-4);}@media (max-width:921px){.ast-separate-container.ast-two-container #secondary .widget{background-color:var(--ast-global-color-4);}}@media (max-width:544px){.ast-separate-container.ast-two-container #secondary .widget{background-color:var(--ast-global-color-4);}}.ast-plain-container, .ast-page-builder-template{background-color:var(--ast-global-color-4);}@media (max-width:921px){.ast-plain-container, .ast-page-builder-template{background-color:var(--ast-global-color-4);}}@media (max-width:544px){.ast-plain-container, .ast-page-builder-template{background-color:var(--ast-global-color-4);}}
		#ast-scroll-top {
			display: none;
			position: fixed;
			text-align: center;
			cursor: pointer;
			z-index: 99;
			width: 2.1em;
			height: 2.1em;
			line-height: 2.1;
			color: #ffffff;
			border-radius: 2px;
			content: "";
			outline: inherit;
		}
		@media (min-width: 769px) {
			#ast-scroll-top {
				content: "769";
			}
		}
		#ast-scroll-top .ast-icon.icon-arrow svg {
			margin-left: 0px;
			vertical-align: middle;
			transform: translate(0, -20%) rotate(180deg);
			width: 1.6em;
		}
		.ast-scroll-to-top-right {
			right: 30px;
			bottom: 30px;
		}
		.ast-scroll-to-top-left {
			left: 30px;
			bottom: 30px;
		}
	#ast-scroll-top{background-color:var(--ast-global-color-0);font-size:15px;}@media (max-width:921px){#ast-scroll-top .ast-icon.icon-arrow svg{width:1em;}}.ast-mobile-header-content > *,.ast-desktop-header-content > * {padding: 10px 0;height: auto;}.ast-mobile-header-content > *:first-child,.ast-desktop-header-content > *:first-child {padding-top: 10px;}.ast-mobile-header-content > .ast-builder-menu,.ast-desktop-header-content > .ast-builder-menu {padding-top: 0;}.ast-mobile-header-content > *:last-child,.ast-desktop-header-content > *:last-child {padding-bottom: 0;}.ast-mobile-header-content .ast-search-menu-icon.ast-inline-search label,.ast-desktop-header-content .ast-search-menu-icon.ast-inline-search label {width: 100%;}.ast-desktop-header-content .main-header-bar-navigation .ast-submenu-expanded > .ast-menu-toggle::before {transform: rotateX(180deg);}#ast-desktop-header .ast-desktop-header-content,.ast-mobile-header-content .ast-search-icon,.ast-desktop-header-content .ast-search-icon,.ast-mobile-header-wrap .ast-mobile-header-content,.ast-main-header-nav-open.ast-popup-nav-open .ast-mobile-header-wrap .ast-mobile-header-content,.ast-main-header-nav-open.ast-popup-nav-open .ast-desktop-header-content {display: none;}.ast-main-header-nav-open.ast-header-break-point #ast-desktop-header .ast-desktop-header-content,.ast-main-header-nav-open.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content {display: block;}.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-up > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-up > .menu-item .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-down > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-down > .menu-item .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-fade > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-fade > .menu-item .menu-item > .sub-menu {opacity: 1;visibility: visible;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation {width: unset;margin: unset;}.ast-mobile-header-content.content-align-flex-end .main-header-bar-navigation .menu-item-has-children > .ast-menu-toggle,.ast-desktop-header-content.content-align-flex-end .main-header-bar-navigation .menu-item-has-children > .ast-menu-toggle {left: calc( 20px - 0.907em);right: auto;}.ast-mobile-header-content .ast-search-menu-icon,.ast-mobile-header-content .ast-search-menu-icon.slide-search,.ast-desktop-header-content .ast-search-menu-icon,.ast-desktop-header-content .ast-search-menu-icon.slide-search {width: 100%;position: relative;display: block;right: auto;transform: none;}.ast-mobile-header-content .ast-search-menu-icon.slide-search .search-form,.ast-mobile-header-content .ast-search-menu-icon .search-form,.ast-desktop-header-content .ast-search-menu-icon.slide-search .search-form,.ast-desktop-header-content .ast-search-menu-icon .search-form {right: 0;visibility: visible;opacity: 1;position: relative;top: auto;transform: none;padding: 0;display: block;overflow: hidden;}.ast-mobile-header-content .ast-search-menu-icon.ast-inline-search .search-field,.ast-mobile-header-content .ast-search-menu-icon .search-field,.ast-desktop-header-content .ast-search-menu-icon.ast-inline-search .search-field,.ast-desktop-header-content .ast-search-menu-icon .search-field {width: 100%;padding-right: 5.5em;}.ast-mobile-header-content .ast-search-menu-icon .search-submit,.ast-desktop-header-content .ast-search-menu-icon .search-submit {display: block;position: absolute;height: 100%;top: 0;right: 0;padding: 0 1em;border-radius: 0;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation ul .sub-menu .menu-link {padding-left: 30px;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation .sub-menu .menu-item .menu-item .menu-link {padding-left: 40px;}.ast-mobile-popup-drawer.active .ast-mobile-popup-inner{background-color:#ffffff;;}.ast-mobile-header-wrap .ast-mobile-header-content, .ast-desktop-header-content{background-color:#ffffff;;}.ast-mobile-popup-content > *, .ast-mobile-header-content > *, .ast-desktop-popup-content > *, .ast-desktop-header-content > *{padding-top:0px;padding-bottom:0px;}.content-align-flex-start .ast-builder-layout-element{justify-content:flex-start;}.content-align-flex-start .main-header-menu{text-align:left;}.ast-desktop-header-content, .ast-mobile-header-content{position:absolute;width:100%;}.ast-mobile-popup-drawer.active .menu-toggle-close{color:#3a3a3a;}.ast-mobile-header-wrap .ast-primary-header-bar,.ast-primary-header-bar .site-primary-header-wrap{min-height:80px;}.ast-desktop .ast-primary-header-bar .main-header-menu > .menu-item{line-height:80px;}.ast-header-break-point #masthead .ast-mobile-header-wrap .ast-primary-header-bar,.ast-header-break-point #masthead .ast-mobile-header-wrap .ast-below-header-bar,.ast-header-break-point #masthead .ast-mobile-header-wrap .ast-above-header-bar{padding-left:20px;padding-right:20px;}.ast-header-break-point .ast-primary-header-bar{border-bottom-width:1px;border-bottom-color:var( --ast-global-color-subtle-background,--ast-global-color-7 );border-bottom-style:solid;}@media (min-width:922px){.ast-primary-header-bar{border-bottom-width:1px;border-bottom-color:var( --ast-global-color-subtle-background,--ast-global-color-7 );border-bottom-style:solid;}}.ast-primary-header-bar{background-color:var( --ast-global-color-primary,--ast-global-color-4 );}.ast-primary-header-bar{display:block;}@media (max-width:921px){.ast-header-break-point .ast-primary-header-bar{display:grid;}}@media (max-width:544px){.ast-header-break-point .ast-primary-header-bar{display:grid;}}[data-section="section-header-mobile-trigger"] .ast-button-wrap .ast-mobile-menu-trigger-minimal{color:var(--ast-global-color-0);border:none;background:transparent;}[data-section="section-header-mobile-trigger"] .ast-button-wrap .mobile-menu-toggle-icon .ast-mobile-svg{width:20px;height:20px;fill:var(--ast-global-color-0);}[data-section="section-header-mobile-trigger"] .ast-button-wrap .mobile-menu-wrap .mobile-menu{color:var(--ast-global-color-0);}.ast-builder-menu-mobile .main-navigation .main-header-menu .menu-item > .menu-link{color:var(--ast-global-color-3);}.ast-builder-menu-mobile .main-navigation .main-header-menu .menu-item > .ast-menu-toggle{color:var(--ast-global-color-3);}.ast-builder-menu-mobile .main-navigation .main-header-menu .menu-item:hover > .menu-link, .ast-builder-menu-mobile .main-navigation .inline-on-mobile .menu-item:hover > .ast-menu-toggle{color:var(--ast-global-color-1);}.ast-builder-menu-mobile .menu-item:hover > .menu-link, .ast-builder-menu-mobile .main-navigation .inline-on-mobile .menu-item:hover > .ast-menu-toggle{color:var(--ast-global-color-1);}.ast-builder-menu-mobile .main-navigation .menu-item:hover > .ast-menu-toggle{color:var(--ast-global-color-1);}.ast-builder-menu-mobile .main-navigation .menu-item.current-menu-item > .menu-link, .ast-builder-menu-mobile .main-navigation .inline-on-mobile .menu-item.current-menu-item > .ast-menu-toggle, .ast-builder-menu-mobile .main-navigation .menu-item.current-menu-ancestor > .menu-link, .ast-builder-menu-mobile .main-navigation .menu-item.current-menu-ancestor > .ast-menu-toggle{color:var(--ast-global-color-1);}.ast-builder-menu-mobile .main-navigation .menu-item.current-menu-item > .ast-menu-toggle{color:var(--ast-global-color-1);}.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-mobile .main-navigation .menu-item-has-children > .menu-link:after{content:unset;}.ast-hfb-header .ast-builder-menu-mobile .main-header-menu, .ast-hfb-header .ast-builder-menu-mobile .main-navigation .menu-item .menu-link, .ast-hfb-header .ast-builder-menu-mobile .main-navigation .menu-item .sub-menu .menu-link{border-style:none;}.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}@media (max-width:921px){.ast-builder-menu-mobile .main-navigation .main-header-menu .menu-item > .menu-link{color:var(--ast-global-color-3);}.ast-builder-menu-mobile .main-navigation .main-header-menu .menu-item > .ast-menu-toggle{color:var(--ast-global-color-3);}.ast-builder-menu-mobile .main-navigation .main-header-menu .menu-item:hover > .menu-link, .ast-builder-menu-mobile .main-navigation .inline-on-mobile .menu-item:hover > .ast-menu-toggle{color:var(--ast-global-color-1);background:var(--ast-global-color-5);}.ast-builder-menu-mobile .main-navigation .menu-item:hover > .ast-menu-toggle{color:var(--ast-global-color-1);}.ast-builder-menu-mobile .main-navigation .menu-item.current-menu-item > .menu-link, .ast-builder-menu-mobile .main-navigation .inline-on-mobile .menu-item.current-menu-item > .ast-menu-toggle, .ast-builder-menu-mobile .main-navigation .menu-item.current-menu-ancestor > .menu-link, .ast-builder-menu-mobile .main-navigation .menu-item.current-menu-ancestor > .ast-menu-toggle{color:var(--ast-global-color-1);background:var(--ast-global-color-5);}.ast-builder-menu-mobile .main-navigation .menu-item.current-menu-item > .ast-menu-toggle{color:var(--ast-global-color-1);}.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-mobile .main-navigation .menu-item-has-children > .menu-link:after{content:unset;}.ast-builder-menu-mobile .main-navigation .main-header-menu , .ast-builder-menu-mobile .main-navigation .main-header-menu .menu-link, .ast-builder-menu-mobile .main-navigation .main-header-menu .sub-menu{background-color:var(--ast-global-color-4);}}@media (max-width:544px){.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}}.ast-builder-menu-mobile .main-navigation{display:block;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-mobile .main-navigation{display:block;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-mobile .main-navigation{display:block;}}:root{--e-global-color-astglobalcolor0:#046bd2;--e-global-color-astglobalcolor1:#045cb4;--e-global-color-astglobalcolor2:#1e293b;--e-global-color-astglobalcolor3:#334155;--e-global-color-astglobalcolor4:#FFFFFF;--e-global-color-astglobalcolor5:#F0F5FA;--e-global-color-astglobalcolor6:#111111;--e-global-color-astglobalcolor7:#D1D5DB;--e-global-color-astglobalcolor8:#111111;}
</style>
<link rel='stylesheet' id='hfe-widgets-style-css' href='https://tallypro.com/wp-content/plugins/header-footer-elementor/inc/widgets-css/frontend.css?ver=2.5.2' media='all' />
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--ast-global-color-0: var(--ast-global-color-0);--wp--preset--color--ast-global-color-1: var(--ast-global-color-1);--wp--preset--color--ast-global-color-2: var(--ast-global-color-2);--wp--preset--color--ast-global-color-3: var(--ast-global-color-3);--wp--preset--color--ast-global-color-4: var(--ast-global-color-4);--wp--preset--color--ast-global-color-5: var(--ast-global-color-5);--wp--preset--color--ast-global-color-6: var(--ast-global-color-6);--wp--preset--color--ast-global-color-7: var(--ast-global-color-7);--wp--preset--color--ast-global-color-8: var(--ast-global-color-8);--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:root { --wp--style--global--content-size: var(--wp--custom--ast-content-width-size);--wp--style--global--wide-size: var(--wp--custom--ast-wide-width-size); }:where(body) { margin: 0; }.wp-site-blocks > .alignleft { float: left; margin-right: 2em; }.wp-site-blocks > .alignright { float: right; margin-left: 2em; }.wp-site-blocks > .aligncenter { justify-content: center; margin-left: auto; margin-right: auto; }:where(.wp-site-blocks) > * { margin-block-start: 24px; margin-block-end: 0; }:where(.wp-site-blocks) > :first-child { margin-block-start: 0; }:where(.wp-site-blocks) > :last-child { margin-block-end: 0; }:root { --wp--style--block-gap: 24px; }:root :where(.is-layout-flow) > :first-child{margin-block-start: 0;}:root :where(.is-layout-flow) > :last-child{margin-block-end: 0;}:root :where(.is-layout-flow) > *{margin-block-start: 24px;margin-block-end: 0;}:root :where(.is-layout-constrained) > :first-child{margin-block-start: 0;}:root :where(.is-layout-constrained) > :last-child{margin-block-end: 0;}:root :where(.is-layout-constrained) > *{margin-block-start: 24px;margin-block-end: 0;}:root :where(.is-layout-flex){gap: 24px;}:root :where(.is-layout-grid){gap: 24px;}.is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}.is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}.is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}.is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}.is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}body{padding-top: 0px;padding-right: 0px;padding-bottom: 0px;padding-left: 0px;}a:where(:not(.wp-element-button)){text-decoration: none;}:root :where(.wp-element-button, .wp-block-button__link){background-color: #32373c;border-width: 0;color: #fff;font-family: inherit;font-size: inherit;line-height: inherit;padding: calc(0.667em + 2px) calc(1.333em + 2px);text-decoration: none;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-ast-global-color-0-color{color: var(--wp--preset--color--ast-global-color-0) !important;}.has-ast-global-color-1-color{color: var(--wp--preset--color--ast-global-color-1) !important;}.has-ast-global-color-2-color{color: var(--wp--preset--color--ast-global-color-2) !important;}.has-ast-global-color-3-color{color: var(--wp--preset--color--ast-global-color-3) !important;}.has-ast-global-color-4-color{color: var(--wp--preset--color--ast-global-color-4) !important;}.has-ast-global-color-5-color{color: var(--wp--preset--color--ast-global-color-5) !important;}.has-ast-global-color-6-color{color: var(--wp--preset--color--ast-global-color-6) !important;}.has-ast-global-color-7-color{color: var(--wp--preset--color--ast-global-color-7) !important;}.has-ast-global-color-8-color{color: var(--wp--preset--color--ast-global-color-8) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-ast-global-color-0-background-color{background-color: var(--wp--preset--color--ast-global-color-0) !important;}.has-ast-global-color-1-background-color{background-color: var(--wp--preset--color--ast-global-color-1) !important;}.has-ast-global-color-2-background-color{background-color: var(--wp--preset--color--ast-global-color-2) !important;}.has-ast-global-color-3-background-color{background-color: var(--wp--preset--color--ast-global-color-3) !important;}.has-ast-global-color-4-background-color{background-color: var(--wp--preset--color--ast-global-color-4) !important;}.has-ast-global-color-5-background-color{background-color: var(--wp--preset--color--ast-global-color-5) !important;}.has-ast-global-color-6-background-color{background-color: var(--wp--preset--color--ast-global-color-6) !important;}.has-ast-global-color-7-background-color{background-color: var(--wp--preset--color--ast-global-color-7) !important;}.has-ast-global-color-8-background-color{background-color: var(--wp--preset--color--ast-global-color-8) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-ast-global-color-0-border-color{border-color: var(--wp--preset--color--ast-global-color-0) !important;}.has-ast-global-color-1-border-color{border-color: var(--wp--preset--color--ast-global-color-1) !important;}.has-ast-global-color-2-border-color{border-color: var(--wp--preset--color--ast-global-color-2) !important;}.has-ast-global-color-3-border-color{border-color: var(--wp--preset--color--ast-global-color-3) !important;}.has-ast-global-color-4-border-color{border-color: var(--wp--preset--color--ast-global-color-4) !important;}.has-ast-global-color-5-border-color{border-color: var(--wp--preset--color--ast-global-color-5) !important;}.has-ast-global-color-6-border-color{border-color: var(--wp--preset--color--ast-global-color-6) !important;}.has-ast-global-color-7-border-color{border-color: var(--wp--preset--color--ast-global-color-7) !important;}.has-ast-global-color-8-border-color{border-color: var(--wp--preset--color--ast-global-color-8) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='contact-form-7-css' href='https://tallypro.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=6.1.1' media='all' />
<link rel='stylesheet' id='astra-contact-form-7-css' href='https://tallypro.com/wp-content/themes/astra/assets/css/minified/compatibility/contact-form-7-main.min.css?ver=4.11.7' media='all' />
<link rel='stylesheet' id='hfe-style-css' href='https://tallypro.com/wp-content/plugins/header-footer-elementor/assets/css/header-footer-elementor.css?ver=2.5.2' media='all' />
<link rel='stylesheet' id='elementor-frontend-css' href='https://tallypro.com/wp-content/plugins/elementor/assets/css/frontend.min.css?ver=3.31.0' media='all' />
<link rel='stylesheet' id='elementor-post-21-css' href='https://tallypro.com/wp-content/uploads/elementor/css/post-21.css?ver=1762004175' media='all' />
<link rel='stylesheet' id='widget-heading-css' href='https://tallypro.com/wp-content/plugins/elementor/assets/css/widget-heading.min.css?ver=3.31.0' media='all' />
<link rel='stylesheet' id='widget-testimonial-css' href='https://tallypro.com/wp-content/plugins/elementor/assets/css/widget-testimonial.min.css?ver=3.31.0' media='all' />
<link rel='stylesheet' id='widget-image-css' href='https://tallypro.com/wp-content/plugins/elementor/assets/css/widget-image.min.css?ver=3.31.0' media='all' />
<link rel='stylesheet' id='widget-toggle-css' href='https://tallypro.com/wp-content/plugins/elementor/assets/css/widget-toggle.min.css?ver=3.31.0' media='all' />
<link rel='stylesheet' id='elementor-post-5-css' href='https://tallypro.com/wp-content/uploads/elementor/css/post-5.css?ver=1762004176' media='all' />
<link rel='stylesheet' id='elementor-post-208-css' href='https://tallypro.com/wp-content/uploads/elementor/css/post-208.css?ver=1762004176' media='all' />
<link rel='stylesheet' id='elementor-post-228-css' href='https://tallypro.com/wp-content/uploads/elementor/css/post-228.css?ver=1762004176' media='all' />
<link rel='stylesheet' id='hfe-elementor-icons-css' href='https://tallypro.com/wp-content/plugins/elementor/assets/lib/eicons/css/elementor-icons.min.css?ver=5.34.0' media='all' />
<link rel='stylesheet' id='hfe-icons-list-css' href='https://tallypro.com/wp-content/plugins/elementor/assets/css/widget-icon-list.min.css?ver=3.24.3' media='all' />
<link rel='stylesheet' id='hfe-social-icons-css' href='https://tallypro.com/wp-content/plugins/elementor/assets/css/widget-social-icons.min.css?ver=3.24.0' media='all' />
<link rel='stylesheet' id='hfe-social-share-icons-brands-css' href='https://tallypro.com/wp-content/plugins/elementor/assets/lib/font-awesome/css/brands.css?ver=5.15.3' media='all' />
<link rel='stylesheet' id='hfe-social-share-icons-fontawesome-css' href='https://tallypro.com/wp-content/plugins/elementor/assets/lib/font-awesome/css/fontawesome.css?ver=5.15.3' media='all' />
<link rel='stylesheet' id='hfe-nav-menu-icons-css' href='https://tallypro.com/wp-content/plugins/elementor/assets/lib/font-awesome/css/solid.css?ver=5.15.3' media='all' />
<link rel='stylesheet' id='elementor-gf-local-roboto-css' href='http://tallypro.com/wp-content/uploads/elementor/google-fonts/css/roboto.css?ver=1752312076' media='all' />
<link rel='stylesheet' id='elementor-gf-local-robotoslab-css' href='http://tallypro.com/wp-content/uploads/elementor/google-fonts/css/robotoslab.css?ver=1752312080' media='all' />
<link rel='stylesheet' id='elementor-gf-local-poppins-css' href='http://tallypro.com/wp-content/uploads/elementor/google-fonts/css/poppins.css?ver=1752319045' media='all' />
<link rel='stylesheet' id='elementor-gf-local-figtree-css' href='http://tallypro.com/wp-content/uploads/elementor/google-fonts/css/figtree.css?ver=1752340115' media='all' />
<!--[if IE]>
<script src="https://tallypro.com/wp-content/themes/astra/assets/js/minified/flexibility.min.js?ver=4.11.7" id="astra-flexibility-js"></script>
<script id="astra-flexibility-js-after">
flexibility(document.documentElement);
</script>
<![endif]-->
<script src="https://tallypro.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://tallypro.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="jquery-js-after">
!function($){"use strict";$(document).ready(function(){$(this).scrollTop()>100&&$(".hfe-scroll-to-top-wrap").removeClass("hfe-scroll-to-top-hide"),$(window).scroll(function(){$(this).scrollTop()<100?$(".hfe-scroll-to-top-wrap").fadeOut(300):$(".hfe-scroll-to-top-wrap").fadeIn(300)}),$(".hfe-scroll-to-top-wrap").on("click",function(){$("html, body").animate({scrollTop:0},300);return!1})})}(jQuery);
!function($){'use strict';$(document).ready(function(){var bar=$('.hfe-reading-progress-bar');if(!bar.length)return;$(window).on('scroll',function(){var s=$(window).scrollTop(),d=$(document).height()-$(window).height(),p=d? s/d*100:0;bar.css('width',p+'%')});});}(jQuery);
</script>

<!-- Google tag (gtag.js) snippet added by Site Kit -->

<!-- Google Analytics snippet added by Site Kit -->
<script src="https://www.googletagmanager.com/gtag/js?id=GT-MKR687GB" id="google_gtagjs-js" async></script>
<script id="google_gtagjs-js-after">
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}
gtag("set","linker",{"domains":["tallypro.com"]});
gtag("js", new Date());
gtag("set", "developer_id.dZTNiMT", true);
gtag("config", "GT-MKR687GB");
 window._googlesitekit = window._googlesitekit || {}; window._googlesitekit.throttledEvents = []; window._googlesitekit.gtagEvent = (name, data) => { var key = JSON.stringify( { name, data } ); if ( !! window._googlesitekit.throttledEvents[ key ] ) { return; } window._googlesitekit.throttledEvents[ key ] = true; setTimeout( () => { delete window._googlesitekit.throttledEvents[ key ]; }, 5 ); gtag( "event", name, { ...data, event_source: "site-kit" } ); };
</script>

<!-- End Google tag (gtag.js) snippet added by Site Kit -->
<link rel="https://api.w.org/" href="https://tallypro.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://tallypro.com/wp-json/wp/v2/pages/5" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://tallypro.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.8.3" />
<link rel='shortlink' href='https://tallypro.com/' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://tallypro.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Foctotally.com%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://tallypro.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Foctotally.com%2F&#038;format=xml" />
<meta name="generator" content="Site Kit by Google 1.157.0" /><!-- HFCM by 99 Robots - Snippet # 1: Adsense verify -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2645733024587772"
     crossorigin="anonymous"></script>
<!-- /end HFCM by 99 Robots -->

<!-- Google AdSense meta tags added by Site Kit -->
<meta name="google-adsense-platform-account" content="ca-host-pub-2644536267352236">
<meta name="google-adsense-platform-domain" content="sitekit.withgoogle.com">
<!-- End Google AdSense meta tags added by Site Kit -->
<meta name="generator" content="Elementor 3.31.0; features: e_font_icon_svg, additional_custom_breakpoints, e_element_cache; settings: css_print_method-external, google_font-enabled, font_display-swap">
			<style>
				.e-con.e-parent:nth-of-type(n+4):not(.e-lazyloaded):not(.e-no-lazyload),
				.e-con.e-parent:nth-of-type(n+4):not(.e-lazyloaded):not(.e-no-lazyload) * {
					background-image: none !important;
				}
				@media screen and (max-height: 1024px) {
					.e-con.e-parent:nth-of-type(n+3):not(.e-lazyloaded):not(.e-no-lazyload),
					.e-con.e-parent:nth-of-type(n+3):not(.e-lazyloaded):not(.e-no-lazyload) * {
						background-image: none !important;
					}
				}
				@media screen and (max-height: 640px) {
					.e-con.e-parent:nth-of-type(n+2):not(.e-lazyloaded):not(.e-no-lazyload),
					.e-con.e-parent:nth-of-type(n+2):not(.e-lazyloaded):not(.e-no-lazyload) * {
						background-image: none !important;
					}
				}
			</style>
			<script>// Helper to generate unique IDs
const generateId = () => Math.random().toString(36).substr(2, 9);

// Define financial account types and categories for dropdowns
const ACCOUNT_TYPES = ['Income', 'Expense', 'Asset', 'Liability', 'Equity'];
const ACCOUNT_CATEGORIES = {
    Income: ['Sales Revenue', 'Service Revenue', 'Other Income'],
    Expense: ['Rent Expense', 'Utilities Expense', 'Salaries Expense', 'Marketing Expense', 'Other Expenses'],
    Asset: ['Cash', 'Bank', 'Accounts Receivable', 'Fixed Assets'],
    Liability: ['Accounts Payable', 'Loans Payable'],
    Equity: ['Owner\'s Capital', 'Retained Earnings'],
};

// Static conversion rate (for demonstration purposes)
const USD_TO_INR_RATE = 83.00; // Example rate: 1 USD = 83 INR

let transactions = []; // Global array to store transactions

// --- Currency Conversion Helpers ---
function convertToUSD(amount, currency) {
    if (currency === 'INR') {
        return amount / USD_TO_INR_RATE;
    }
    return amount; // Already in USD
}

function convertToINR(amount, currency) {
    if (currency === 'USD') {
        return amount * USD_TO_INR_RATE;
    }
    return amount; // Already in INR
}

function formatAmountDisplay(amount, originalCurrency) {
    let primarySymbol = originalCurrency === 'INR' ? '₹' : '$';
    let secondarySymbol = originalCurrency === 'INR' ? '$' : '₹';

    let convertedAmount;
    if (originalCurrency === 'INR') {
        convertedAmount = convertToUSD(amount, 'INR');
    } else {
        convertedAmount = convertToINR(amount, 'USD');
    }

    return `${primarySymbol}${amount.toFixed(2)} (${secondarySymbol}${convertedAmount.toFixed(2)})`;
}

// --- Initialization Functions ---

// Populate Type dropdown
function populateTypeSelect() {
    // Ensure typeSelect exists before trying to populate
    const typeSelect = document.getElementById('typeSelect');
    if (!typeSelect) {
        console.error("typeSelect element not found for populating.");
        return;
    }
    typeSelect.innerHTML = '';
    ACCOUNT_TYPES.forEach(type => {
        const option = document.createElement('option');
        option.value = type;
        option.textContent = type;
        typeSelect.appendChild(option);
    });
    populateCategorySelect(); // Populate categories based on initial type
}

// Populate Category dropdown based on selected Type
function populateCategorySelect() {
    const typeSelect = document.getElementById('typeSelect');
    const categorySelect = document.getElementById('categorySelect');
    if (!typeSelect || !categorySelect) {
        console.error("typeSelect or categorySelect element not found for populating categories.");
        return;
    }
    const selectedType = typeSelect.value;
    const categories = ACCOUNT_CATEGORIES[selectedType] || [];
    categorySelect.innerHTML = '';
    categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category;
        option.textContent = category;
        categorySelect.appendChild(option);
    });
    toggleRelatedPartyFields(); // Adjust visibility of related party fields
}

// Toggle visibility of Related Party and Is Paid fields
function toggleRelatedPartyFields() {
    const categorySelect = document.getElementById('categorySelect');
    const relatedPartyField = document.getElementById('relatedPartyField');
    const relatedPartyInput = document.getElementById('relatedPartyInput');
    const isPaidField = document.getElementById('isPaidField');
    const isPaidCheckbox = document.getElementById('isPaidCheckbox'); // Added to ensure it's reset
    if (!categorySelect || !relatedPartyField || !relatedPartyInput || !isPaidField || !isPaidCheckbox) {
        console.error("One or more related party elements not found for toggling.");
        return;
    }

    const selectedCategory = categorySelect.value;
    const isARAP = ['Accounts Receivable', 'Accounts Payable'].includes(selectedCategory);
    relatedPartyField.classList.toggle('hidden', !isARAP);
    isPaidField.classList.toggle('hidden', !isARAP);
    relatedPartyInput.required = isARAP; // Make required if visible
    if (!isARAP) {
        isPaidCheckbox.checked = true; // Default to paid if not AR/AP
    }
}

// Set initial date to today
function setInitialDate() {
    const dateInput = document.getElementById('dateInput');
    const paymentDateInput = document.getElementById('paymentDateInput');
    const startDateInputReport = document.getElementById('startDateInputReport');
    const endDateInputReport = document.getElementById('endDateInputReport');

    const today = new Date().toISOString().split('T')[0];
    if (dateInput) dateInput.value = today;
    if (paymentDateInput) paymentDateInput.value = today;

    // Set initial date range for reports (e.g., last 30 days or empty)
    const thirtyDaysAgo = new Date(new Date());
    thirtyDaysAgo.setDate(new Date().getDate() - 30);
    if (startDateInputReport) startDateInputReport.value = thirtyDaysAgo.toISOString().split('T')[0];
    if (endDateInputReport) endDateInputReport.value = today;
}

// --- Event Handlers ---

// Tab switching
function switchTab(tabName) {
    // Get all tab buttons and sections
    const dataEntryTab = document.getElementById('dataEntryTab');
    const uploadTab = document.getElementById('uploadTab');
    const reportsTab = document.getElementById('reportsTab');
    const dashboardTab = document.getElementById('dashboardTab');

    const dataEntrySection = document.getElementById('dataEntrySection');
    const uploadSection = document.getElementById('uploadSection');
    const reportsSection = document.getElementById('reportsSection');
    const dashboardSection = document.getElementById('dashboardSection');

    // Remove 'active' from all tabs
    [dataEntryTab, uploadTab, reportsTab, dashboardTab].forEach(tab => {
        if (tab) tab.classList.remove('active');
    });

    // Hide all sections
    [dataEntrySection, uploadSection, reportsSection, dashboardSection].forEach(section => {
        if (section) section.classList.add('hidden');
    });

    // Activate selected tab and show section
    let targetTab, targetSection;
    if (tabName === 'dataEntry') {
        targetTab = dataEntryTab;
        targetSection = dataEntrySection;
    } else if (tabName === 'upload') {
        targetTab = uploadTab;
        targetSection = uploadSection;
    } else if (tabName === 'reports') {
        targetTab = reportsTab;
        targetSection = reportsSection;
        renderReport(currentReportType); // Render the current report when switching to reports tab
    } else if (tabName === 'dashboard') {
        targetTab = dashboardTab;
        targetSection = dashboardSection;
        renderDashboard(); // Render dashboard when switching to dashboard tab
    }

    if (targetTab) targetTab.classList.add('active');
    if (targetSection) targetSection.classList.remove('hidden');
    currentTab = tabName;
}

// Function to display upload message
function showUploadMessage(message, isError = false) {
    const uploadMessage = document.getElementById('uploadMessage');
    if (!uploadMessage) return;

    uploadMessage.textContent = message;
    uploadMessage.classList.remove('hidden');
    if (isError) {
        uploadMessage.classList.remove('text-green-600');
        uploadMessage.classList.add('text-red-600');
    } else {
        uploadMessage.classList.remove('text-red-600');
        uploadMessage.classList.add('text-green-600');
    }
    setTimeout(() => {
        uploadMessage.classList.add('hidden');
    }, 3000); // Hide after 3 seconds
}

// Function to show temporary messages (e.g., for export success)
function showTemporaryMessage(message, isError = false) {
    const messageDiv = document.createElement('div');
    messageDiv.textContent = message;
    messageDiv.className = `fixed bottom-4 right-4 p-3 rounded-md shadow-lg text-white ${isError ? 'bg-red-500' : 'bg-green-500'} z-50`;
    document.body.appendChild(messageDiv);

    setTimeout(() => {
        messageDiv.remove();
    }, 3000);
}

// --- Report Filtering Helper ---
function getFilteredTransactions() {
    const startDateInputReport = document.getElementById('startDateInputReport');
    const endDateInputReport = document.getElementById('endDateInputReport');

    const startDate = startDateInputReport && startDateInputReport.value ? new Date(startDateInputReport.value + 'T00:00:00') : null;
    const endDate = endDateInputReport && endDateInputReport.value ? new Date(endDateInputReport.value + 'T23:59:59') : null;

    return transactions.filter(t => {
        const transactionDate = new Date(t.date + 'T12:00:00');
        let inDateRange = true;
        if (startDate && transactionDate < startDate) {
            inDateRange = false;
        }
        if (endDate && transactionDate > endDate) {
            inDateRange = false;
        }
        return inDateRange;
    });
}

/**
 * Escapes a field for CSV export.
 * Encloses the field in double quotes if it contains commas, double quotes, or newlines.
 * Doubles any internal double quotes.
 * @param {string} field The string to escape.
 * @returns {string} The escaped string.
 */
function escapeCsvField(field) {
    if (typeof field !== 'string') {
        field = String(field); // Ensure it's a string
    }
    // If the field contains a comma, double quote, or newline, enclose it in double quotes
    if (field.includes(',') || field.includes('"') || field.includes('\n')) {
        // Escape internal double quotes by doubling them
        return `"${field.replace(/"/g, '""')}"`;
    }
    return field;
}

// --- Export CSV Helper ---
function exportToCsv(filename, csvContent) {
    console.log(`Attempting to export ${filename}. Content length: ${csvContent.length}`);
    console.log("CSV Content preview:", csvContent.substring(0, 200) + (csvContent.length > 200 ? '...' : ''));

    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;

    document.body.appendChild(a);
    a.click();

    setTimeout(() => {
        URL.revokeObjectURL(url);
        if (a.parentNode) {
            document.body.removeChild(a);
        }
    }, 100);

    showTemporaryMessage(`${filename} exported successfully!`);
}

// --- Copy to Clipboard Helper ---
function copyToClipboard(text, message) {
    try {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        showTemporaryMessage(message);
    } catch (err) {
        console.error('Failed to copy text: ', err);
        showTemporaryMessage('Failed to copy to clipboard.', true);
    }
}

// --- Render Functions ---

// Render all transactions in a table
function renderTransactions() {
    const transactionsList = document.getElementById('transactionsList');
    if (!transactionsList) {
        console.error("transactionsList element not found.");
        return;
    }

    if (transactions.length === 0) {
        transactionsList.innerHTML = '<p class="text-gray-600">No transactions added yet. Start by adding some data!</p>';
        return;
    }

    let tableHtml = `
        <table class="min-w-full bg-white border border-gray-200 rounded-lg">
            <thead class="bg-gray-100">
                <tr>
                    <th class="py-2 px-4 border-b text-left text-gray-600">Date</th>
                    <th class="py-2 px-4 border-b text-left text-gray-600">Description</th>
                    <th class="py-2 px-4 border-b text-right text-gray-600">Amount</th>
                    <th class="py-2 px-4 border-b text-left text-gray-600">Type</th>
                    <th class="py-2 px-4 border-b text-left text-gray-600">Category</th>
                    <th class="py-2 px-4 border-b text-left text-gray-600">Status</th>
                    <th class="py-2 px-4 border-b text-left text-gray-600">Action</th>
                </tr>
            </thead>
            <tbody>
    `;
    // Sort transactions by date in descending order (most recent first)
    const sortedTransactions = [...transactions].sort((a, b) => new Date(b.date) - new Date(a.date));

    sortedTransactions.forEach(t => {
        const status = ['Accounts Receivable', 'Accounts Payable'].includes(t.category) ? (t.isPaid ? 'Paid' : 'Outstanding') : 'N/A';
        tableHtml += `
            <tr class="table-row">
                <td class="py-2 px-4 border-b">${escapeCsvField(t.date)}</td>
                <td class="py-2 px-4 border-b">${escapeCsvField(t.description)}</td>
                <td class="py-2 px-4 border-b text-right">${formatAmountDisplay(t.amount, t.currency)}</td>
                <td class="py-2 px-4 border-b">${escapeCsvField(t.type)}</td>
                <td class="py-2 px-4 border-b">${escapeCsvField(t.category)}</td>
                <td class="py-2 px-4 border-b">${escapeCsvField(status)}</td>
                <td class="py-2 px-4 border-b">
                    <button data-id="${t.id}" class="delete-btn bg-red-500 hover:bg-red-600 text-white text-sm py-1 px-2 rounded-md transition duration-200">
                        Delete
                    </button>
                </td>
            </tr>
        `;
    });
    tableHtml += `</tbody></table>`;
    transactionsList.innerHTML = tableHtml;

    // Re-attach event listeners for delete buttons after rendering
    transactionsList.querySelectorAll('.delete-btn').forEach(button => {
        button.onclick = (e) => {
            const idToDelete = e.target.dataset.id;
            deleteTransaction(idToDelete);
        };
    });
}

// Delete transaction function (called from rendered HTML)
function deleteTransaction(id) {
    transactions = transactions.filter(t => t.id !== id);
    renderTransactions();
    renderReport(currentReportType); // Re-render report if data changes
    renderDashboard(); // Update dashboard after deleting transaction
}

// Mark AR/AP as paid (called from rendered HTML)
function markAsPaid(id) {
    transactions = transactions.map(t =>
        t.id === id ? { ...t, isPaid: true } : t
    );
    renderReport(currentReportType); // Re-render report
    renderDashboard(); // Update dashboard after marking as paid
}

// --- Clear All Transactions Function ---
function clearAllTransactions() {
    const clearConfirmModal = document.getElementById('clearConfirmModal');
    if (clearConfirmModal) {
        clearConfirmModal.classList.remove('hidden');
        clearConfirmModal.style.display = 'flex'; // Ensure it's visible when clicked
    }
}

// Main report rendering function
function renderReport(type) {
    const reportDisplay = document.getElementById('reportDisplay');
    const reportDateFilters = document.getElementById('reportDateFilters');
    const startDateInputReport = document.getElementById('startDateInputReport');
    const endDateInputReport = document.getElementById('endDateInputReport');

    if (!reportDisplay || !reportDateFilters || !startDateInputReport || !endDateInputReport) {
        console.error("Report elements not found for rendering.");
        return;
    }

    const filteredTransactions = getFilteredTransactions();

    // Hide/show date filters based on report type
    if (type === 'pnl' || type === 'balanceSheet' || type === 'cashFlow' || type === 'bankAccountStatements' || type === 'ledgerStatements') {
        reportDateFilters.classList.remove('hidden');
    } else {
        reportDateFilters.classList.add('hidden');
    }

    if (filteredTransactions.length === 0 && type !== 'bankAccountStatements' && type !== 'ledgerStatements') {
        reportDisplay.innerHTML = `
            <div class="text-center text-gray-600 p-8 bg-white rounded-lg shadow-md">
                <p class="text-lg">No transactions found for the selected date range. Please add some data or adjust the filter.</p>
            </div>
        `;
        return;
    }

    switch (type) {
        case 'pnl':
            renderPnLReport(filteredTransactions);
            break;
        case 'balanceSheet':
            renderBalanceSheetReport(filteredTransactions);
            break;
        case 'cashFlow':
            renderCashFlowReport(filteredTransactions);
            break;
        case 'bankAccountStatements':
            renderBankAccountStatements(filteredTransactions);
            break;
        case 'ledgerStatements':
            renderLedgerStatements(filteredTransactions);
            break;
        default:
            // If the current type is no longer valid, default to P&L
            currentReportType = 'pnl';
            renderPnLReport(filteredTransactions);
    }
}

// P&L Report
function renderPnLReport(filteredTransactions) {
    const reportDisplay = document.getElementById('reportDisplay');
    if (!reportDisplay) return;

    // Convert all amounts to USD for consistent calculation
    const incomeUSD = filteredTransactions
        .filter(t => t.type === 'Income')
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    const expensesUSD = filteredTransactions
        .filter(t => t.type === 'Expense')
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    const netProfitUSD = incomeUSD - expensesUSD;

    // Prepare CSV content (using USD as base for export)
    const csvContent = `Report Type,Amount (USD)\n${escapeCsvField("Total Income")},${incomeUSD.toFixed(2)}\n${escapeCsvField("Total Expenses")},${expensesUSD.toFixed(2)}\n${escapeCsvField("Net Profit (Loss)")},${netProfitUSD.toFixed(2)}`;

    reportDisplay.innerHTML = `
        <div class="p-4 bg-white rounded-lg shadow-md">
            <h3 class="text-xl font-bold mb-4 text-gray-800">Profit & Loss Statement</h3>
            <div class="grid grid-cols-2 gap-4 text-lg">
                <div class="font-semibold text-gray-700">Total Income:</div>
                <div class="text-right text-green-600">${formatAmountDisplay(incomeUSD, 'USD')}</div>
                <div class="font-semibold text-gray-700">Total Expenses:</div>
                <div class="text-right text-red-600">${formatAmountDisplay(expensesUSD, 'USD')}</div>
                <div class="font-bold text-gray-800 border-t-2 border-gray-300 pt-2">Net Profit (Loss):</div>
                <div class="font-bold text-right border-t-2 border-gray-300 pt-2 ${netProfitUSD >= 0 ? 'text-green-700' : 'text-red-700'}">
                    ${formatAmountDisplay(netProfitUSD, 'USD')}
                </div>
            </div>
            <div class="flex justify-end gap-2 mt-4">
                <button onclick="exportToCsv('profit_loss_report.csv', \`${csvContent}\`)" class="btn-secondary">Export to CSV</button>
                <button onclick="copyToClipboard(\`Profit & Loss Statement:\nTotal Income: ${formatAmountDisplay(incomeUSD, 'USD')}\nTotal Expenses: ${formatAmountDisplay(expensesUSD, 'USD')}\nNet Profit (Loss): ${formatAmountDisplay(netProfitUSD, 'USD')}\`, 'Profit & Loss report copied to clipboard!')" class="btn-secondary">Copy to Clipboard</button>
            </div>
        </div>
    `;
}

// Balance Sheet Report
function renderBalanceSheetReport(filteredTransactions) {
    const reportDisplay = document.getElementById('reportDisplay');
    const endDateInputReport = document.getElementById('endDateInputReport');
    if (!reportDisplay || !endDateInputReport) return;

    // For Balance Sheet, we need to consider ALL transactions up to the end date, not just within the range.
    // This is because assets, liabilities, and equity are cumulative.
    const endDate = endDateInputReport.value ? new Date(endDateInputReport.value + 'T23:59:59') : new Date();

    const relevantTransactions = transactions.filter(t => {
        const transactionDate = new Date(t.date + 'T12:00:00');
        return transactionDate <= endDate;
    });

    const calculateAccountBalance = (accountCategory) => {
        return relevantTransactions
            .filter(t => t.category === accountCategory)
            .reduce((sum, t) => {
                // Convert all amounts to USD for consistent calculation
                const amountInUSD = convertToUSD(t.amount, t.currency);

                if (t.type === 'Asset' || t.type === 'Expense') {
                    return sum + amountInUSD;
                } else if (t.type === 'Liability' || t.type === 'Income' || t.type === 'Equity') {
                    return sum + amountInUSD;
                }
                return sum;
            }, 0);
    };

    const assetsUSD = {
        cash: calculateAccountBalance('Cash') + calculateAccountBalance('Bank'),
        accountsReceivable: calculateAccountBalance('Accounts Receivable'),
        fixedAssets: calculateAccountBalance('Fixed Assets'),
    };
    const totalAssetsUSD = Object.values(assetsUSD).reduce((sum, val) => sum + val, 0);

    const liabilitiesUSD = {
        accountsPayable: calculateAccountBalance('Accounts Payable'),
        loansPayable: calculateAccountBalance('Loans Payable'),
    };
    const totalLiabilitiesUSD = Object.values(liabilitiesUSD).reduce((sum, val) => sum + val, 0);

    // Retained earnings calculation for Balance Sheet should be cumulative profit up to end date
    const cumulativeIncomeUSD = relevantTransactions.filter(t => t.type === 'Income').reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);
    const cumulativeExpensesUSD = relevantTransactions.filter(t => t.type === 'Expense').reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);
    const retainedEarningsUSD = cumulativeIncomeUSD - cumulativeExpensesUSD;

    const equityUSD = {
        ownersCapital: calculateAccountBalance('Owner\'s Capital'),
        retainedEarnings: retainedEarningsUSD,
    };
    const totalEquityUSD = Object.values(equityUSD).reduce((sum, val) => sum + val, 0);

    let csvContent = `Account,Amount (USD)\n`;
    csvContent += `${escapeCsvField("Cash & Bank")},${assetsUSD.cash.toFixed(2)}\n`;
    csvContent += `${escapeCsvField("Accounts Receivable")},${assetsUSD.accountsReceivable.toFixed(2)}\n`;
    csvContent += `${escapeCsvField("Fixed Assets")},${assetsUSD.fixedAssets.toFixed(2)}\n`;
    csvContent += `${escapeCsvField("Total Assets")},${totalAssetsUSD.toFixed(2)}\n`;
    csvContent += `${escapeCsvField("Accounts Payable")},${liabilitiesUSD.accountsPayable.toFixed(2)}\n`;
    csvContent += `${escapeCsvField("Loans Payable")},${liabilitiesUSD.loansPayable.toFixed(2)}\n`;
    csvContent += `${escapeCsvField("Total Liabilities")},${totalLiabilitiesUSD.toFixed(2)}\n`;
    csvContent += `${escapeCsvField("Owner's Capital")},${equityUSD.ownersCapital.toFixed(2)}\n`;
    csvContent += `${escapeCsvField("Retained Earnings")},${equityUSD.retainedEarnings.toFixed(2)}\n`;
    csvContent += `${escapeCsvField("Total Equity")},${totalEquityUSD.toFixed(2)}\n`;
    csvContent += `${escapeCsvField("Total Liabilities & Equity")},${(totalLiabilitiesUSD + totalEquityUSD).toFixed(2)}`;


    reportDisplay.innerHTML = `
        <div class="p-4 bg-white rounded-lg shadow-md">
            <h3 class="text-xl font-bold mb-4 text-gray-800">Balance Sheet</h3>
            <p class="text-sm text-gray-600 mb-4">As of: ${endDateInputReport.value || new Date().toISOString().split('T')[0]}</p>
            <div class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mb-2">Assets</h4>
                <ul class="list-disc list-inside ml-4">
                    <li>Cash & Bank: <span class="float-right">${formatAmountDisplay(assetsUSD.cash, 'USD')}</span></li>
                    <li>Accounts Receivable: <span class="float-right">${formatAmountDisplay(assetsUSD.accountsReceivable, 'USD')}</span></li>
                    <li>Fixed Assets: <span class="float-right">${formatAmountDisplay(assetsUSD.fixedAssets, 'USD')}</span></li>
                </ul>
                <div class="font-bold border-t-2 border-gray-300 pt-2 mt-2">
                    Total Assets: <span class="float-right">${formatAmountDisplay(totalAssetsUSD, 'USD')}</span>
                </div>
            </div>

            <div class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mb-2">Liabilities</h4>
                <ul class="list-disc list-inside ml-4">
                    <li>Accounts Payable: <span class="float-right">${formatAmountDisplay(liabilitiesUSD.accountsPayable, 'USD')}</span></li>
                    <li>Loans Payable: <span class="float-right">${formatAmountDisplay(liabilitiesUSD.loansPayable, 'USD')}</span></li>
                </ul>
                <div class="font-bold border-t-2 border-gray-300 pt-2 mt-2">
                    Total Liabilities: <span class="float-right">${formatAmountDisplay(totalLiabilitiesUSD, 'USD')}</span>
                </div>
            </div>

            <div>
                <h4 class="text-lg font-semibold text-gray-700 mb-2">Equity</h4>
                <ul class="list-disc list-inside ml-4">
                    <li>Owner's Capital: <span class="float-right">${formatAmountDisplay(equityUSD.ownersCapital, 'USD')}</span></li>
                    <li>Retained Earnings: <span class="float-right">${formatAmountDisplay(equityUSD.retainedEarnings, 'USD')}</span></li>
                </ul>
                <div class="font-bold border-t-2 border-gray-300 pt-2 mt-2">
                    Total Equity: <span class="float-right">${formatAmountDisplay(totalEquityUSD, 'USD')}</span>
                </div>
            </div>

            <div class="font-bold text-lg mt-4 border-t-2 border-gray-400 pt-4">
                Total Liabilities & Equity: <span class="float-right">${formatAmountDisplay((totalLiabilitiesUSD + totalEquityUSD), 'USD')}</span>
            </div>
            <p class="mt-2 text-sm ${Math.abs(totalAssetsUSD - (totalLiabilitiesUSD + totalEquityUSD)) < 0.01 ? 'text-green-600' : 'text-red-600'}">
                Assets = Liabilities + Equity: ${Math.abs(totalAssetsUSD - (totalLiabilitiesUSD + totalEquityUSD)) < 0.01 ? 'Balanced' : 'Unbalanced'}
            </p>
            <div class="flex justify-end gap-2 mt-4">
                <button onclick="exportToCsv('balance_sheet_report.csv', \`${csvContent}\`)" class="btn-secondary">Export to CSV</button>
                <button onclick="copyToClipboard(\`Balance Sheet:\nAs of: ${endDateInputReport.value || new Date().toISOString().split('T')[0]}\nAssets:\n  Cash & Bank: ${formatAmountDisplay(assetsUSD.cash, 'USD')}\n  Accounts Receivable: ${formatAmountDisplay(assetsUSD.accountsReceivable, 'USD')}\n  Fixed Assets: ${formatAmountDisplay(assetsUSD.fixedAssets, 'USD')}\nTotal Assets: ${formatAmountDisplay(totalAssetsUSD, 'USD')}\nLiabilities:\n  Accounts Payable: ${formatAmountDisplay(liabilitiesUSD.accountsPayable, 'USD')}\n  Loans Payable: ${formatAmountDisplay(liabilitiesUSD.loansPayable, 'USD')}\nTotal Liabilities: ${formatAmountDisplay(totalLiabilitiesUSD, 'USD')}\nEquity:\n  Owner's Capital: ${formatAmountDisplay(equityUSD.ownersCapital, 'USD')}\n  Retained Earnings: ${formatAmountDisplay(equityUSD.retainedEarnings, 'USD')}\nTotal Equity: ${formatAmountDisplay(totalEquityUSD, 'USD')}\nTotal Liabilities & Equity: ${formatAmountDisplay((totalLiabilitiesUSD + totalEquityUSD), 'USD')}\nAssets = Liabilities + Equity: ${Math.abs(totalAssetsUSD - (totalLiabilitiesUSD + totalEquityUSD)) < 0.01 ? 'Balanced' : 'Unbalanced'}\`, 'Balance Sheet report copied to clipboard!')" class="btn-secondary">Copy to Clipboard</button>
            </div>
        </div>
    `;
}

// Cash Flow Statement
function renderCashFlowReport(filteredTransactions) {
    const reportDisplay = document.getElementById('reportDisplay');
    if (!reportDisplay) return;

    const cashInflowsUSD = filteredTransactions
        .filter(t => (t.type === 'Income' && t.isPaid) || (t.type === 'Liability' && t.category === 'Loans Payable'))
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    const cashOutflowsUSD = filteredTransactions
        .filter(t => (t.type === 'Expense' && t.isPaid) || (t.type === 'Asset' && t.category === 'Fixed Assets') || (t.type === 'Liability' && t.category === 'Loans Payable' && t.amount < 0))
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    const netCashFlowUSD = cashInflowsUSD - cashOutflowsUSD;

    const csvContent = `Report Type,Amount (USD)\n${escapeCsvField("Cash Inflows")},${cashInflowsUSD.toFixed(2)}\n${escapeCsvField("Cash Outflows")},${cashOutflowsUSD.toFixed(2)}\n${escapeCsvField("Net Cash Flow")},${netCashFlowUSD.toFixed(2)}`;

    reportDisplay.innerHTML = `
        <div class="p-4 bg-white rounded-lg shadow-md">
            <h3 class="text-xl font-bold mb-4 text-gray-800">Cash Flow Statement</h3>
            <div class="grid grid-cols-2 gap-4 text-lg">
                <div class="font-semibold text-gray-700">Cash Inflows:</div>
                <div class="text-right text-green-600">${formatAmountDisplay(cashInflowsUSD, 'USD')}</div>
                <div class="font-semibold text-gray-700">Cash Outflows:</div>
                <div class="text-right text-red-600">${formatAmountDisplay(cashOutflowsUSD, 'USD')}</div>
                <div class="font-bold text-gray-800 border-t-2 border-gray-300 pt-2">Net Cash Flow:</div>
                <div class="font-bold text-right border-t-2 border-gray-300 pt-2 ${netCashFlowUSD >= 0 ? 'text-green-700' : 'text-red-700'}">
                    ${formatAmountDisplay(netCashFlowUSD, 'USD')}
                </div>
            </div>
            <p class="text-sm text-gray-600 mt-4">
                Note: This is a simplified direct cash flow statement. A full statement would categorize activities into Operating, Investing, and Financing.
            </p>
            <div class="flex justify-end gap-2 mt-4">
                <button onclick="exportToCsv('cash_flow_report.csv', \`${csvContent}\`)" class="btn-secondary">Export to CSV</button>
                <button onclick="copyToClipboard(\`Cash Flow Statement:\nCash Inflows: ${formatAmountDisplay(cashInflowsUSD, 'USD')}\nCash Outflows: ${formatAmountDisplay(cashOutflowsUSD, 'USD')}\nNet Cash Flow: ${formatAmountDisplay(netCashFlowUSD, 'USD')}\`, 'Cash Flow report copied to clipboard!')" class="btn-secondary">Copy to Clipboard</button>
            </div>
        </div>
    `;
}

// New function to render Bank Account Statements
function renderBankAccountStatements(filteredTransactions) {
    const reportDisplay = document.getElementById('reportDisplay');
    const startDateInputReport = document.getElementById('startDateInputReport');
    const endDateInputReport = document.getElementById('endDateInputReport');
    if (!reportDisplay || !startDateInputReport || !endDateInputReport) return;

    const bankTransactions = filteredTransactions.filter(t => t.category === 'Cash' || t.category === 'Bank');

    if (bankTransactions.length === 0) {
        reportDisplay.innerHTML = `
            <div class="text-center text-gray-600 p-8 bg-white rounded-lg shadow-md">
                <p class="text-lg">No Cash or Bank transactions found for the selected date range.</p>
            </div>
        `;
        return;
    }

    // Sort by date ascending for statement view
    bankTransactions.sort((a, b) => new Date(a.date) - new Date(b.date));

    let tableHtml = `
        <div class="p-4 bg-white rounded-lg shadow-md">
            <h3 class="text-xl font-bold mb-4 text-gray-800">Bank Account Statements</h3>
            <p class="text-sm text-gray-600 mb-4">Showing transactions for 'Cash' and 'Bank' categories from ${startDateInputReport.value} to ${endDateInputReport.value}.</p>
            <div class="overflow-x-auto">
                <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="py-2 px-4 border-b text-left text-gray-600">Date</th>
                            <th class="py-2 px-4 border-b text-left text-gray-600">Description</th>
                            <th class="py-2 px-4 border-b text-right text-gray-600">Amount</th>
                            <th class="py-2 px-4 border-b text-left text-gray-600">Type</th>
                            <th class="py-2 px-4 border-b text-left text-gray-600">Category</th>
                        </tr>
                    </thead>
                    <tbody>
    `;
    let csvContent = `Date,Description,Amount (Original),Currency,Amount (USD),Type,Category\n`; // Updated CSV header

    bankTransactions.forEach(t => {
        const amountInUSD = convertToUSD(t.amount, t.currency);
        tableHtml += `
            <tr class="table-row">
                <td class="py-2 px-4 border-b">${escapeCsvField(t.date)}</td>
                <td class="py-2 px-4 border-b">${escapeCsvField(t.description)}</td>
                <td class="py-2 px-4 border-b text-right ${t.type === 'Income' || t.type === 'Liability' ? 'text-green-600' : 'text-red-600'}">${formatAmountDisplay(t.amount, t.currency)}</td>
                <td class="py-2 px-4 border-b">${escapeCsvField(t.type)}</td>
                <td class="py-2 px-4 border-b">${escapeCsvField(t.category)}</td>
            </tr>
        `;
        csvContent += `${escapeCsvField(t.date)},${escapeCsvField(t.description)},${t.amount.toFixed(2)},${t.currency},${amountInUSD.toFixed(2)},${escapeCsvField(t.type)},${escapeCsvField(t.category)}\n`;
    });
    tableHtml += `</tbody></table></div>
        <div class="flex justify-end gap-2 mt-4">
            <button onclick="exportToCsv('bank_account_statements.csv', \`${csvContent}\`)" class="btn-secondary">Export to CSV</button>
            <button onclick="copyToClipboard(\`Bank Account Statements:\nDate,Description,Amount,Type,Category\n${bankTransactions.map(t => `${escapeCsvField(t.date)},${escapeCsvField(t.description)},${formatAmountDisplay(t.amount, t.currency)},${escapeCsvField(t.type)},${escapeCsvField(t.category)}`).join('\n')}\`, 'Bank Account Statements copied to clipboard!')" class="btn-secondary">Copy to Clipboard</button>
        </div>
        </div>
    `;
    reportDisplay.innerHTML = tableHtml;
}

// New function to render Ledger Statements
function renderLedgerStatements(filteredTransactions) {
    const reportDisplay = document.getElementById('reportDisplay');
    const startDateInputReport = document.getElementById('startDateInputReport');
    const endDateInputReport = document.getElementById('endDateInputReport');
    if (!reportDisplay || !startDateInputReport || !endDateInputReport) return;

    const transactionsByCategory = {};
    ACCOUNT_TYPES.forEach(type => {
        ACCOUNT_CATEGORIES[type].forEach(category => {
            transactionsByCategory[category] = [];
        });
    });

    filteredTransactions.forEach(t => {
        if (transactionsByCategory[t.category]) {
            transactionsByCategory[t.category].push(t);
        }
    });

    let reportHtml = `
        <div class="p-4 bg-white rounded-lg shadow-md">
            <h3 class="text-xl font-bold mb-4 text-gray-800">Ledger Statements</h3>
            <p class="text-sm text-gray-600 mb-4">Showing all transactions grouped by ledger account category from ${startDateInputReport.value} to ${endDateInputReport.value}.</p>
    `;
    let csvContent = `Category,Date,Description,Amount (Original),Currency,Amount (USD),Type\n`; // Updated CSV header

    let hasData = false;

    for (const category in transactionsByCategory) {
        const categoryTransactions = transactionsByCategory[category].sort((a, b) => new Date(a.date) - new Date(b.date));
        if (categoryTransactions.length > 0) {
            hasData = true;
            reportHtml += `
                <div class="mb-6">
                    <h4 class="text-lg font-semibold text-gray-700 mb-2">${category}</h4>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="py-2 px-4 border-b text-left text-gray-600">Date</th>
                                    <th class="py-2 px-4 border-b text-left text-gray-600">Description</th>
                                    <th class="py-2 px-4 border-b text-right text-gray-600">Amount</th>
                                    <th class="py-2 px-4 border-b text-left text-gray-600">Type</th>
                                </tr>
                            </thead>
                            <tbody>
            `;
            categoryTransactions.forEach(t => {
                const amountInUSD = convertToUSD(t.amount, t.currency);
                reportHtml += `
                    <tr class="table-row">
                        <td class="py-2 px-4 border-b">${escapeCsvField(t.date)}</td>
                        <td class="py-2 px-4 border-b">${escapeCsvField(t.description)}</td>
                        <td class="py-2 px-4 border-b text-right ${t.type === 'Income' || t.type === 'Liability' ? 'text-green-600' : 'text-red-600'}">${formatAmountDisplay(t.amount, t.currency)}</td>
                        <td class="py-2 px-4 border-b">${escapeCsvField(t.type)}</td>
                    </tr>
                `;
                csvContent += `${escapeCsvField(category)},${escapeCsvField(t.date)},${escapeCsvField(t.description)},${t.amount.toFixed(2)},${t.currency},${amountInUSD.toFixed(2)},${escapeCsvField(t.type)}\n`;
            });
            reportHtml += `
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }
    }

    if (!hasData) {
        reportDisplay.innerHTML = `
            <div class="text-center text-gray-600 p-8 bg-white rounded-lg shadow-md">
                <p class="text-lg">No transactions found for any ledger accounts in the selected date range.</p>
            </div>
        `;
        return;
    }

    reportHtml += `
        <div class="flex justify-end gap-2 mt-4">
            <button onclick="exportToCsv('ledger_statements.csv', \`${csvContent}\`)" class="btn-secondary">Export to CSV</button>
            <button onclick="copyToClipboard(\`Ledger Statements:\nCategory,Date,Description,Amount,Type\n${Object.entries(transactionsByCategory).flatMap(([category, txns]) => txns.map(t => `${escapeCsvField(category)},${escapeCsvField(t.date)},${escapeCsvField(t.description)},${formatAmountDisplay(t.amount, t.currency)},${escapeCsvField(t.type)}`)).join('\n')}\`, 'Ledger Statements copied to clipboard!')" class="btn-secondary">Copy to Clipboard</button>
        </div>
        </div>
    `;
    reportDisplay.innerHTML = reportHtml;
}


// Function to switch active report button and render the corresponding report
function switchReport(type) {
    // Remove 'active' class from all report buttons
    const allReportButtons = document.querySelectorAll('#reportsSection .btn-secondary');
    allReportButtons.forEach(btn => btn.classList.remove('active'));

    // Add 'active' class to the clicked button
    let clickedButton;
    switch(type) {
        case 'pnl': clickedButton = document.getElementById('pnlReportBtn'); break;
        case 'balanceSheet': clickedButton = document.getElementById('balanceSheetReportBtn'); break;
        case 'cashFlow': clickedButton = document.getElementById('cashFlowReportBtn'); break;
        case 'bankAccountStatements': clickedButton = document.getElementById('bankAccountStatementsBtn'); break;
        case 'ledgerStatements': clickedButton = document.getElementById('ledgerStatementsBtn'); break;
    }
    if (clickedButton) {
        clickedButton.classList.add('active');
    }

    currentReportType = type;
    renderReport(currentReportType);
}

// Helper function to render a simulated pie chart
function renderSimulatedPieChart(element, data, totalValue, colors) {
    if (!element) {
        console.error("Pie chart element not found.");
        return;
    }
    if (totalValue === 0 || Object.keys(data).length === 0) {
        element.innerHTML = '<p class="text-gray-600 text-center">No data to display.</p>';
        return;
    }

    let pieChartHtml = `<div class="pie-chart-container">`;
    let currentAngle = 0;
    let legendHtml = `<div class="pie-chart-legend">`;

    // Data passed to this function should already be in the base currency (USD) for consistency
    // The `data` object keys are categories, values are amounts in USD.
    const sortedData = Object.entries(data).sort(([, a], [, b]) => b - a); // Sort by amount descending

    sortedData.forEach(([category, amountInUSD], index) => {
        const percentage = (amountInUSD / totalValue) * 100;
        const color = colors[index % colors.length];

        legendHtml += `
            <div class="pie-chart-legend-item">
                <div class="pie-chart-legend-color" style="background-color: ${color};"></div>
                <span>${category}: ${percentage.toFixed(1)}% (${formatAmountDisplay(amountInUSD, 'USD')})</span>
            </div>
        `;
    });
    pieChartHtml += `</div>`; // Close pie-chart-container
    legendHtml += `</div>`; // Close pie-chart-legend

    element.innerHTML = pieChartHtml + legendHtml;

    // Simple background for the "pie" to show it's a circle
    const pieContainer = element.querySelector('.pie-chart-container');
    if (pieContainer) {
        pieContainer.style.backgroundColor = '#f0f0f0'; // Light gray circle
    }
}


// --- Dashboard Rendering Functions ---
function renderDashboard() {
    const totalRevenueKPI = document.getElementById('totalRevenueKPI');
    const totalExpensesKPI = document.getElementById('totalExpensesKPI');
    const netProfitLossKPI = document.getElementById('netProfitLossKPI');
    const totalTransactionsKPI = document.getElementById('totalTransactionsKPI');
    const avgTransactionSizeKPI = document.getElementById('avgTransactionSizeKPI');
    const totalOutstandingReceivablesKPI = document.getElementById('totalOutstandingReceivablesKPI');
    const totalOutstandingPayablesKPI = document.getElementById('totalOutstandingPayablesKPI');
    const totalAssetsKPI = document.getElementById('totalAssetsKPI');
    const totalLiabilitiesKPI = document.getElementById('totalLiabilitiesKPI');
    const monthlyRevenueChart = document.getElementById('monthlyRevenueChart');
    const incomeDistributionPieChart = document.getElementById('incomeDistributionPieChart');
    const topExpensesChart = document.getElementById('topExpensesChart');
    const expenseDistributionPieChart = document.getElementById('expenseDistributionPieChart');
    const recentTransactionsList = document.getElementById('recentTransactionsList');

    // Ensure KPI elements are available
    if (!totalRevenueKPI || !totalExpensesKPI || !netProfitLossKPI || !totalTransactionsKPI || !avgTransactionSizeKPI || !totalOutstandingReceivablesKPI || !totalOutstandingPayablesKPI || !totalAssetsKPI || !totalLiabilitiesKPI || !monthlyRevenueChart || !incomeDistributionPieChart || !topExpensesChart || !expenseDistributionPieChart || !recentTransactionsList) {
        console.error("One or more Dashboard KPI elements not found. Dashboard rendering skipped.");
        return;
    }

    // Calculate KPIs (all converted to USD for consistent summation)
    const totalRevenueUSD = transactions
        .filter(t => t.type === 'Income')
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    const totalExpensesUSD = transactions
        .filter(t => t.type === 'Expense')
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    const netProfitLossUSD = totalRevenueUSD - totalExpensesUSD;

    const totalTransactionsCount = transactions.length;

    const avgTransactionSizeUSD = totalTransactionsCount > 0 ? (totalRevenueUSD / totalTransactionsCount) : 0;

    const totalOutstandingReceivablesUSD = transactions
        .filter(t => t.category === 'Accounts Receivable' && !t.isPaid)
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    const totalOutstandingPayablesUSD = transactions
        .filter(t => t.category === 'Accounts Payable' && !t.isPaid)
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    // Calculate total assets and liabilities (simplified for dashboard view)
    const totalAssetsUSD = transactions
        .filter(t => t.type === 'Asset')
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    const totalLiabilitiesUSD = transactions
        .filter(t => t.type === 'Liability')
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);


    totalRevenueKPI.textContent = formatAmountDisplay(totalRevenueUSD, 'USD');
    totalExpensesKPI.textContent = formatAmountDisplay(totalExpensesUSD, 'USD');
    netProfitLossKPI.textContent = formatAmountDisplay(netProfitLossUSD, 'USD');
    netProfitLossKPI.style.color = netProfitLossUSD >= 0 ? '#10b981' : '#ef4444'; // green-500 vs red-500
    totalTransactionsKPI.textContent = totalTransactionsCount;
    avgTransactionSizeKPI.textContent = formatAmountDisplay(avgTransactionSizeUSD, 'USD');
    totalOutstandingReceivablesKPI.textContent = formatAmountDisplay(totalOutstandingReceivablesUSD, 'USD');
    totalOutstandingPayablesKPI.textContent = formatAmountDisplay(totalOutstandingPayablesUSD, 'USD');
    totalAssetsKPI.textContent = formatAmountDisplay(totalAssetsUSD, 'USD');
    totalLiabilitiesKPI.textContent = formatAmountDisplay(totalLiabilitiesUSD, 'USD');


    // Monthly Revenue Trend
    const monthlyRevenueUSD = transactions
        .filter(t => t.type === 'Income')
        .reduce((acc, t) => {
            const monthYear = new Date(t.date).toLocaleString('en-US', { month: 'short', year: 'numeric' });
            acc[monthYear] = (acc[monthYear] || 0) + convertToUSD(t.amount, t.currency);
            return acc;
        }, {});

    let monthlyRevenueHtml = '';
    const sortedMonths = Object.keys(monthlyRevenueUSD).sort((a, b) => {
        const dateA = new Date(a);
        const dateB = new Date(b);
        return dateA - dateB;
    });

    const maxMonthlyRevenueUSD = Math.max(...Object.values(monthlyRevenueUSD), 0);

    if (sortedMonths.length === 0) {
        monthlyRevenueHtml = '<p class="text-gray-600 text-center">No income data for monthly trend.</p>';
    } else {
        sortedMonths.forEach(monthYear => {
            const revenue = monthlyRevenueUSD[monthYear];
            const width = maxMonthlyRevenueUSD > 0 ? (revenue / maxMonthlyRevenueUSD) * 100 : 0;
            monthlyRevenueHtml += `
                <div class="flex items-center text-sm">
                    <span class="w-24 flex-shrink-0 text-gray-700">${monthYear}:</span>
                    <div class="bar-chart-bar" style="width: ${width.toFixed(2)}%;">
                        ${formatAmountDisplay(revenue, 'USD')}
                    </div>
                </div>
            `;
        });
    }
    monthlyRevenueChart.innerHTML = monthlyRevenueHtml;

    // Income Distribution by Category (Pie Chart)
    const incomeCategoriesUSD = transactions
        .filter(t => t.type === 'Income')
        .reduce((acc, t) => {
            acc[t.category] = (acc[t.category] || 0) + convertToUSD(t.amount, t.currency);
            return acc;
        }, {});

    const totalIncomeForDistributionUSD = Object.values(incomeCategoriesUSD).reduce((sum, val) => sum + val, 0);
    const pieColors = [
        '#4f46e5', '#10b981', '#f59e0b', '#ef4444', '#3b82f6',
        '#8b5cf6', '#ec4899', '#6b7280', '#14b8a6', '#f97316'
    ];
    renderSimulatedPieChart(incomeDistributionPieChart, incomeCategoriesUSD, totalIncomeForDistributionUSD, pieColors);


    // Top Expense Categories
    const expenseCategoriesUSD = transactions
        .filter(t => t.type === 'Expense')
        .reduce((acc, t) => {
            acc[t.category] = (acc[t.category] || 0) + convertToUSD(t.amount, t.currency);
            return acc;
        }, {});

    let topExpensesHtml = '';
    const sortedExpenses = Object.entries(expenseCategoriesUSD).sort(([, a], [, b]) => b - a);
    const maxExpenseAmountUSD = Math.max(...Object.values(expenseCategoriesUSD), 0);

    if (sortedExpenses.length === 0) {
        topExpensesHtml = '<p class="text-gray-600 text-center">No expense data for top categories.</p>';
    } else {
        sortedExpenses.slice(0, 5).forEach(([category, amount]) => { // Show top 5 expenses
            const width = maxExpenseAmountUSD > 0 ? (amount / maxExpenseAmountUSD) * 100 : 0;
            topExpensesHtml += `
                <div class="flex items-center text-sm">
                    <span class="w-32 flex-shrink-0 text-gray-700">${category}:</span>
                    <div class="bar-chart-bar bg-red-500" style="width: ${width.toFixed(2)}%;">
                        ${formatAmountDisplay(amount, 'USD')}
                    </div>
                </div>
            `;
        });
    }
    topExpensesChart.innerHTML = topExpensesHtml;

    // Expense Distribution by Category (Pie Chart)
    const totalExpensesForDistributionUSD = Object.values(expenseCategoriesUSD).reduce((sum, val) => sum + val, 0);
    renderSimulatedPieChart(expenseDistributionPieChart, expenseCategoriesUSD, totalExpensesForDistributionUSD, pieColors);


    // Recent Transactions
    const recentTransactions = [...transactions].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
    let recentTransactionsHtml = '';
    if (recentTransactions.length === 0) {
        recentTransactionsHtml = '<p class="text-gray-600 text-center">No recent transactions to display.</p>';
    } else {
        recentTransactionsHtml = `
            <table class="min-w-full bg-white recent-transactions-table rounded-lg overflow-hidden">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Description</th>
                        <th>Amount</th>
                        <th>Type</th>
                    </tr>
                </thead>
                <tbody>
        `;
        recentTransactions.forEach(t => {
            recentTransactionsHtml += `
                <tr>
                    <td>${escapeCsvField(t.date)}</td>
                    <td>${escapeCsvField(t.description)}</td>
                    <td class="${t.type === 'Income' ? 'text-green-600' : 'text-red-600'}">${formatAmountDisplay(t.amount, t.currency)}</td>
                    <td>${escapeCsvField(t.type)}</td>
                </tr>
            `;
        });
        recentTransactionsHtml += `
                </tbody>
            </table>
        `;
    }
    recentTransactionsList.innerHTML = recentTransactionsHtml;
}

// Function to copy dashboard summary to clipboard
function copyDashboardSummaryToClipboard() {
    const totalRevenueUSD = transactions
        .filter(t => t.type === 'Income')
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);
    const totalExpensesUSD = transactions
        .filter(t => t.type === 'Expense')
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);
    const netProfitLossUSD = totalRevenueUSD - totalExpensesUSD;
    const totalTransactions = transactions.length;

    const totalOutstandingReceivablesUSD = transactions
        .filter(t => t.category === 'Accounts Receivable' && !t.isPaid)
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    const totalOutstandingPayablesUSD = transactions
        .filter(t => t.category === 'Accounts Payable' && !t.isPaid)
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    const totalAssetsUSD = transactions
        .filter(t => t.type === 'Asset')
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    const totalLiabilitiesUSD = transactions
        .filter(t => t.type === 'Liability')
        .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

    const avgTransactionSizeUSD = totalTransactions > 0 ? (totalRevenueUSD / totalTransactions) : 0;

    let summary = "Dashboard Summary:\n";
    summary += `Total Revenue: ${formatAmountDisplay(totalRevenueUSD, 'USD')}\n`;
    summary += `Total Expenses: ${formatAmountDisplay(totalExpensesUSD, 'USD')}\n`;
    summary += `Net Profit/Loss: ${formatAmountDisplay(netProfitLossUSD, 'USD')}\n`;
    summary += `Total Transactions: ${totalTransactions}\n`;
    summary += `Avg. Transaction Value: ${formatAmountDisplay(avgTransactionSizeUSD, 'USD')}\n`;
    summary += `Outstanding Receivables: ${formatAmountDisplay(totalOutstandingReceivablesUSD, 'USD')}\n`;
    summary += `Outstanding Payables: ${formatAmountDisplay(totalOutstandingPayablesUSD, 'USD')}\n`;
    summary += `Total Assets: ${formatAmountDisplay(totalAssetsUSD, 'USD')}\n`;
    summary += `Total Liabilities: ${formatAmountDisplay(totalLiabilitiesUSD, 'USD')}\n\n`;

    const incomeCategoriesUSD = transactions
        .filter(t => t.type === 'Income')
        .reduce((acc, t) => {
            acc[t.category] = (acc[t.category] || 0) + convertToUSD(t.amount, t.currency);
            return acc;
        }, {});
    const totalIncomeForDistributionUSD = Object.values(incomeCategoriesUSD).reduce((sum, val) => sum + val, 0);

    if (totalIncomeForDistributionUSD > 0) {
        summary += "Income Distribution by Category:\n";
        Object.entries(incomeCategoriesUSD).sort(([, a], [, b]) => b - a).forEach(([category, amount]) => {
            const percentage = (amount / totalIncomeForDistributionUSD) * 100;
            summary += `- ${category}: ${percentage.toFixed(1)}% (${formatAmountDisplay(amount, 'USD')})\n`;
        });
        summary += "\n";
    }


    const expenseCategoriesUSD = transactions
        .filter(t => t.type === 'Expense')
        .reduce((acc, t) => {
            acc[t.category] = (acc[t.category] || 0) + convertToUSD(t.amount, t.currency);
            return acc;
        }, {});
    const totalExpensesForDistributionUSD = Object.values(expenseCategoriesUSD).reduce((sum, val) => sum + val, 0);

    if (totalExpensesForDistributionUSD > 0) {
        summary += "Expense Distribution by Category:\n";
        Object.entries(expenseCategoriesUSD).sort(([, a], [, b]) => b - a).forEach(([category, amount]) => {
            const percentage = (amount / totalExpensesForDistributionUSD) * 100;
            summary += `- ${category}: ${percentage.toFixed(1)}% (${formatAmountDisplay(amount, 'USD')})\n`;
        });
        summary += "\n";
    }

    summary += "Recent Transactions:\n";
    const recentTransactions = [...transactions].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
    if (recentTransactions.length > 0) {
        summary += "Date,Description,Amount,Type\n";
        recentTransactions.forEach(t => {
            summary += `${escapeCsvField(t.date)},${escapeCsvField(t.description)},${formatAmountDisplay(t.amount, t.currency)},${escapeCsvField(t.type)}\n`;
        });
    } else {
        summary += "No recent transactions.\n";
    }

    copyToClipboard(summary, 'Dashboard summary copied to clipboard!');
}

let currentReportType = 'pnl'; // Default report type
let currentTab = 'dataEntry'; // Default tab

document.addEventListener('DOMContentLoaded', () => {
    try {
        // Initialize ALL DOM elements at the very beginning
        const dataEntryTab = document.getElementById('dataEntryTab');
        const uploadTab = document.getElementById('uploadTab');
        const reportsTab = document.getElementById('reportsTab');
        const dashboardTab = document.getElementById('dashboardTab');

        const transactionForm = document.getElementById('transactionForm');
        const dateInput = document.getElementById('dateInput');
        const descriptionInput = document.getElementById('descriptionInput');
        const amountInput = document.getElementById('amountInput');
        const currencySelect = document.getElementById('currencySelect');
        const typeSelect = document.getElementById('typeSelect');
        const categorySelect = document.getElementById('categorySelect');
        const relatedPartyField = document.getElementById('relatedPartyField');
        const relatedPartyInput = document.getElementById('relatedPartyInput');
        const isPaidField = document.getElementById('isPaidField');
        const isPaidCheckbox = document.getElementById('isPaidCheckbox');
        const transactionsList = document.getElementById('transactionsList');
        const clearTransactionsBtn = document.getElementById('clearTransactionsBtn');

        const paymentReceivedForm = document.getElementById('paymentReceivedForm');
        const paymentDateInput = document.getElementById('paymentDateInput');
        const paymentDescriptionInput = document.getElementById('paymentDescriptionInput');
        const paymentAmountInput = document.getElementById('paymentAmountInput');
        const paymentCurrencySelect = document.getElementById('paymentCurrencySelect');
        const paymentMethodSelect = document.getElementById('paymentMethodSelect');

        const dragDropArea = document.getElementById('dragDropArea');
        const excelFileInput = document.getElementById('excelFileInput');
        const browseFilesBtn = document.getElementById('browseFilesBtn');
        const downloadTemplateBtn = document.getElementById('downloadTemplateBtn');
        const uploadMessage = document.getElementById('uploadMessage');

        const pnlReportBtn = document.getElementById('pnlReportBtn');
        const balanceSheetReportBtn = document.getElementById('balanceSheetReportBtn');
        const cashFlowReportBtn = document.getElementById('cashFlowReportBtn');
        const bankAccountStatementsBtn = document.getElementById('bankAccountStatementsBtn');
        const ledgerStatementsBtn = document.getElementById('ledgerStatementsBtn');

        const startDateInputReport = document.getElementById('startDateInputReport');
        const endDateInputReport = document.getElementById('endDateInputReport');
        const applyDateFilterBtn = document.getElementById('applyDateFilterBtn');
        const reportDateFilters = document.getElementById('reportDateFilters');

        const reportDisplay = document.getElementById('reportDisplay');

        const helpButton = document.getElementById('helpButton');
        const helpModal = document.getElementById('helpModal');
        const closeButton = document.querySelector('#helpModal .close-button');

        const clearConfirmModal = document.getElementById('clearConfirmModal');
        const confirmClearBtn = document.getElementById('confirmClearBtn');
        const cancelClearBtn = document.getElementById('cancelClearBtn');

        const copyDashboardSummaryBtn = document.getElementById('copyDashboardSummaryBtn');

        // Attach event listeners with checks for existence
        if (dataEntryTab) dataEntryTab.addEventListener('click', () => switchTab('dataEntry'));
        if (uploadTab) uploadTab.addEventListener('click', () => switchTab('upload'));
        if (reportsTab) reportsTab.addEventListener('click', () => switchTab('reports'));
        if (dashboardTab) dashboardTab.addEventListener('click', () => switchTab('dashboard'));

        if (transactionForm) transactionForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const newTransaction = {
                id: generateId(),
                date: dateInput.value,
                description: descriptionInput.value,
                amount: parseFloat(amountInput.value),
                currency: currencySelect.value,
                type: typeSelect.value,
                category: categorySelect.value,
                isPaid: ['Accounts Receivable', 'Accounts Payable'].includes(categorySelect.value) ? isPaidCheckbox.checked : true,
                relatedParty: ['Accounts Receivable', 'Accounts Payable'].includes(categorySelect.value) ? relatedPartyInput.value : '',
                source: 'manual'
            };
            transactions.push(newTransaction);
            renderTransactions();
            renderDashboard();
            transactionForm.reset();
            setInitialDate();
            populateTypeSelect();
            isPaidCheckbox.checked = true;
            currencySelect.value = 'INR';
        });

        if (paymentReceivedForm) {
            paymentReceivedForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const paymentMethod = paymentMethodSelect.value;
                let category;
                if (paymentMethod === 'Cash') {
                    category = 'Cash';
                } else {
                    category = 'Bank';
                }

                const newTransaction = {
                    id: generateId(),
                    date: paymentDateInput.value,
                    description: paymentDescriptionInput.value + ` (via ${paymentMethod})`,
                    amount: parseFloat(paymentAmountInput.value),
                    currency: paymentCurrencySelect.value,
                    type: 'Income',
                    category: category,
                    isPaid: true,
                    relatedParty: '',
                    source: 'manual'
                };
                transactions.push(newTransaction);
                renderTransactions();
                renderDashboard();
                paymentReceivedForm.reset();
                setInitialDate();
                paymentCurrencySelect.value = 'INR';
            });
        }

        if (typeSelect) typeSelect.addEventListener('change', populateCategorySelect);
        if (categorySelect) categorySelect.addEventListener('change', toggleRelatedPartyFields);

        if (browseFilesBtn) browseFilesBtn.addEventListener('click', () => {
            if (excelFileInput) excelFileInput.click();
        });

        if (excelFileInput) excelFileInput.addEventListener('change', (event) => {
            const files = event.target.files;
            if (files.length > 0) {
                showUploadMessage('Excel file uploaded successfully!');
                const dummyTransactions = [
                    { id: generateId(), date: '2024-01-05', description: 'Initial Capital', amount: 10000, currency: 'INR', type: 'Equity', category: 'Owner\'s Capital', isPaid: true, relatedParty: '', source: 'excel' },
                    { id: generateId(), date: '2024-01-10', description: 'Sales Revenue Q1', amount: 5000, currency: 'INR', type: 'Income', category: 'Sales Revenue', isPaid: true, relatedParty: '', source: 'excel' },
                    { id: generateId(), date: '2024-01-15', description: 'Office Rent', amount: 1200, currency: 'INR', type: 'Expense', category: 'Rent Expense', isPaid: true, relatedParty: '', source: 'excel' },
                    { id: generateId(), date: '2024-01-20', description: 'Marketing Campaign', amount: 300, currency: 'USD', type: 'Expense', category: 'Marketing Expense', isPaid: true, relatedParty: '', source: 'excel' },
                    { id: generateId(), date: '2024-02-01', description: 'Service Income', amount: 2500, currency: 'INR', type: 'Income', category: 'Service Revenue', isPaid: true, relatedParty: '', source: 'excel' },
                    { id: generateId(), date: '2024-02-10', description: 'Utilities Bill', amount: 150, currency: 'USD', type: 'Expense', category: 'Utilities Expense', isPaid: true, relatedParty: '', source: 'excel' },
                    { id: generateId(), date: '2024-03-01', description: 'Accounts Receivable (Customer A)', amount: 800, currency: 'INR', type: 'Asset', category: 'Accounts Receivable', isPaid: false, relatedParty: 'Customer A', source: 'excel' },
                    { id: generateId(), date: '2024-03-05', description: 'Accounts Payable (Supplier B)', amount: 400, currency: 'INR', type: 'Liability', category: 'Accounts Payable', isPaid: false, relatedParty: 'Supplier B', source: 'excel' },
                    { id: generateId(), date: '2024-03-15', description: 'Loan Received', amount: 2000, currency: 'USD', type: 'Liability', category: 'Loans Payable', isPaid: true, relatedParty: '', source: 'excel' },
                    { id: generateId(), date: '2024-03-20', description: 'Fixed Asset Purchase', amount: 1500, currency: 'INR', type: 'Asset', category: 'Fixed Assets', isPaid: true, relatedParty: '', source: 'excel' },
                ];
                transactions.push(...dummyTransactions);
                renderTransactions();
                excelFileInput.value = null;
                renderDashboard();
            }
        });

        if (dragDropArea) {
            dragDropArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                dragDropArea.classList.add('hover');
            });

            dragDropArea.addEventListener('dragleave', () => {
                dragDropArea.classList.remove('hover');
            });

            dragDropArea.addEventListener('drop', (e) => {
                e.preventDefault();
                dragDropArea.classList.remove('hover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    showUploadMessage('Excel file uploaded successfully!');
                    const dummyTransactions = [
                        { id: generateId(), date: '2024-04-01', description: 'Sales Revenue Q2', amount: 7000, currency: 'INR', type: 'Income', category: 'Sales Revenue', isPaid: true, relatedParty: '', source: 'excel' },
                        { id: generateId(), date: '2024-04-10', description: 'New Office Equipment', amount: 800, currency: 'USD', type: 'Expense', category: 'Other Expenses', isPaid: true, relatedParty: '', source: 'excel' },
                    ];
                    transactions.push(...dummyTransactions);
                    renderTransactions();
                    renderDashboard();
                }
            });
        }

        if (downloadTemplateBtn) downloadTemplateBtn.addEventListener('click', () => {
            const templateContent = "Date (MM/DD/YYYY),Description,Category,Amount,Type,Currency (INR/USD)\n";
            const blob = new Blob([templateContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'finance_template.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        if (helpButton) helpButton.addEventListener('click', () => {
            if (helpModal) {
                helpModal.classList.remove('hidden');
                helpModal.style.display = 'flex';
            }
        });

        if (closeButton) closeButton.addEventListener('click', () => {
            if (helpModal) {
                helpModal.classList.add('hidden');
                helpModal.style.display = 'none';
            }
        });

        window.addEventListener('click', (event) => {
            if (helpModal && event.target === helpModal) {
                helpModal.classList.add('hidden');
                helpModal.style.display = 'none';
            }
            if (clearConfirmModal && event.target === clearConfirmModal) {
                clearConfirmModal.classList.add('hidden');
                clearConfirmModal.style.display = 'none';
            }
        });

        if (clearTransactionsBtn) clearTransactionsBtn.addEventListener('click', clearAllTransactions);
        if (cancelClearBtn) cancelClearBtn.addEventListener('click', () => {
            if (clearConfirmModal) {
                clearConfirmModal.classList.add('hidden');
                clearConfirmModal.style.display = 'none';
            }
        });
        if (confirmClearBtn) confirmClearBtn.addEventListener('click', () => {
            transactions = [];
            renderTransactions();
            renderReport(currentReportType);
            renderDashboard();
            if (clearConfirmModal) {
                clearConfirmModal.classList.add('hidden');
                clearConfirmModal.style.display = 'none';
            }
        });

        if (pnlReportBtn) pnlReportBtn.addEventListener('click', () => switchReport('pnl'));
        if (balanceSheetReportBtn) balanceSheetReportBtn.addEventListener('click', () => switchReport('balanceSheet'));
        if (cashFlowReportBtn) cashFlowReportBtn.addEventListener('click', () => switchReport('cashFlow'));
        if (bankAccountStatementsBtn) bankAccountStatementsBtn.addEventListener('click', () => switchReport('bankAccountStatements'));
        if (ledgerStatementsBtn) ledgerStatementsBtn.addEventListener('click', () => switchReport('ledgerStatements'));

        if (applyDateFilterBtn) applyDateFilterBtn.addEventListener('click', () => renderReport(currentReportType));

        if (copyDashboardSummaryBtn) copyDashboardSummaryBtn.addEventListener('click', copyDashboardSummaryToClipboard);

        if (transactionsList) {
            transactionsList.addEventListener('click', (e) => {
                if (e.target.classList.contains('delete-btn')) {
                    const idToDelete = e.target.dataset.id;
                    deleteTransaction(idToDelete);
                }
            });
        }

        // Initial setup calls
        setInitialDate();
        populateTypeSelect();
        renderTransactions();
        switchTab('dataEntry');
        renderDashboard();

        // Defensive measure: Ensure modals are hidden on load, in case of external interference
        if (helpModal) helpModal.classList.add('hidden');
        if (clearConfirmModal) clearConfirmModal.classList.add('hidden');

    } catch (error) {
        console.error("Error during DOMContentLoaded initialization:", error);
        // You might want to display a user-friendly message here too
        showTemporaryMessage("An error occurred during initialization. Please check the console.", true);
    }
});
</script><style class="wpcode-css-snippet">body {
    font-family: 'Inter', sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f3f4f6; /* Light gray background */
}
/* Custom styles for better readability and spacing */
.container {
    max-width: 1024px;
    margin: 2rem auto;
    padding: 1.5rem;
    background-color: #ffffff;
    border-radius: 0.75rem;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}
.tab-button {
    padding: 0.75rem 1.5rem;
    font-weight: 600;
    border-radius: 0.5rem 0.5rem 0 0;
    transition: all 0.3s ease;
    cursor: pointer;
    border-bottom: 2px solid transparent;
}
.tab-button.active {
    background-color: #4f46e5;
    color: white;
    border-color: #4f46e5;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
}
.tab-button:not(.active):hover {
    background-color: #e5e7eb;
    color: #4b5563;
}
.form-input, .form-select {
    display: block;
    width: 100%;
    padding: 0.5rem;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}
.form-input:focus, .form-select:focus {
    border-color: #6366f1;
    outline: 0;
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.25);
}
.btn-primary {
    background-color: #4f46e5;
    color: white;
    font-weight: 700;
    padding: 0.75rem 1.5rem;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    transition: background-color 0.3s ease, transform 0.2s ease;
}
.btn-primary:hover {
    background-color: #4338ca;
    transform: translateY(-2px);
}
.btn-secondary {
    background-color: #e5e7eb;
    color: #4b5563;
    font-weight: 600;
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    transition: background-color 0.3s ease;
}
.btn-secondary:hover {
    background-color: #d1d5db;
}
.table-header th {
    background-color: #f9fafb;
    text-align: left;
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #e5e7eb;
    color: #4b5563;
}
.table-row td {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #e5e7eb;
}
.table-row:nth-child(even) {
    background-color: #f9fafb;
}
.table-row:hover {
    background-color: #f3f4f6;
}

/* Modal specific styles */
.modal {
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4);
    display: flex;
    align-items: center;
    justify-content: center;
}
.modal-content {
    background-color: #fefefe;
    margin: auto;
    padding: 20px;
    border: 1px solid #888;
    width: 90%;
    max-width: 700px;
    border-radius: 0.75rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    position: relative;
    max-height: 90vh; /* Limit height to enable scrolling */
    overflow-y: auto; /* Enable vertical scrolling */
}
.close-button {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
}
.close-button:hover,
.close-button:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}
/* Drag and Drop styles */
.drag-drop-area {
    border: 2px dashed #d1d5db;
    border-radius: 0.75rem;
    padding: 2rem;
    text-align: center;
    background-color: #f9fafb;
    transition: background-color 0.2s ease, border-color 0.2s ease;
}
.drag-drop-area.hover {
    background-color: #e0e7ff;
    border-color: #6366f1;
}
.cloud-icon {
    margin: 0 auto 1rem auto;
    width: 64px;
    height: 64px;
    color: #9ca3af;
}

/* Dashboard specific styles */
.kpi-card {
    background-color: #edf2f7; /* Light blue-gray */
    padding: 1.5rem;
    border-radius: 0.75rem;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
.kpi-card .value {
    font-size: 2.25rem; /* text-4xl */
    font-weight: 700; /* font-bold */
    color: #4f46e5; /* indigo-600 */
    margin-bottom: 0.25rem;
}
.kpi-card .label {
    font-size: 0.875rem; /* text-sm */
    color: #4b5563; /* gray-600 */
}
.chart-container {
    background-color: #ffffff;
    padding: 1.5rem;
    border-radius: 0.75rem;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}
.bar-chart-bar {
    height: 20px;
    background-color: #6366f1; /* indigo-500 */
    border-radius: 0.25rem;
    margin-bottom: 0.5rem;
    color: white;
    text-align: right;
    padding-right: 0.5rem;
    font-size: 0.75rem; /* text-xs */
    display: flex;
    align-items: center;
    justify-content: flex-end;
    transition: width 0.5s ease-out;
    min-width: 10%; /* Ensure bars are visible even for small values */
}
.pie-chart-segment {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.25rem 0;
    border-bottom: 1px dashed #e5e7eb;
}
.pie-chart-segment:last-child {
    border-bottom: none;
}
.color-box {
    width: 1rem;
    height: 1rem;
    border-radius: 0.25rem;
    margin-right: 0.5rem;
    display: inline-block;
}
.recent-transactions-table th, .recent-transactions-table td {
    padding: 0.5rem 0.75rem;
    border-bottom: 1px solid #e5e7eb;
    text-align: left;
}
.recent-transactions-table th {
    background-color: #f9fafb;
    color: #4b5563;
    font-weight: 600;
}
.recent-transactions-table tr:last-child td {
    border-bottom: none;
}

/* Pie Chart Specific Styles (Simulated) */
.pie-chart-container {
    position: relative;
    width: 180px;
    height: 180px;
    border-radius: 50%;
    overflow: hidden;
    margin: 0 auto 1rem;
    background-color: #e5e7eb; /* Fallback background */
}

.pie-chart-slice {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    transform-origin: 50% 50%;
    clip-path: polygon(50% 50%, 100% 0, 100% 100%, 0 100%, 0 0); /* A large enough polygon to cover the circle */
    background-color: currentColor; /* Will use the color set by JS */
}
.pie-chart-legend {
    margin-top: 1rem;
    font-size: 0.875rem;
}
.pie-chart-legend-item {
    display: flex;
    align-items: center;
    margin-bottom: 0.25rem;
}
.pie-chart-legend-color {
    width: 1rem;
    height: 1rem;
    border-radius: 0.25rem;
    margin-right: 0.5rem;
}
</style><script id="google_gtagjs" src="https://www.googletagmanager.com/gtag/js?id=G-CBKB73CQXT" async></script>
<script id="google_gtagjs-inline">
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-CBKB73CQXT', {} );
</script>
<link rel="icon" href="https://tallypro.com/wp-content/uploads/2025/07/cropped-TallyPro-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://tallypro.com/wp-content/uploads/2025/07/cropped-TallyPro-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://tallypro.com/wp-content/uploads/2025/07/cropped-TallyPro-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://tallypro.com/wp-content/uploads/2025/07/cropped-TallyPro-1-270x270.png" />
</head>

<body itemtype='https://schema.org/WebPage' itemscope='itemscope' class="home wp-singular page-template-default page page-id-5 wp-custom-logo wp-theme-astra eio-default ehf-header ehf-footer ehf-template-astra ehf-stylesheet-astra ast-desktop ast-plain-container ast-no-sidebar astra-4.11.7 ast-single-post ast-inherit-site-logo-transparent ast-hfb-header ast-normal-title-enabled elementor-default elementor-kit-21 elementor-page elementor-page-5">
<!-- Converted to TallyPro — all OctoTally URLs removed and assets embedded locally -->


<div class="hfeed site" id="page">
			<header id="masthead" itemscope="itemscope" itemtype="https://schema.org/WPHeader">
			<p class="main-title bhf-hidden" itemprop="headline"><a href="https://tallypro.com" title="" rel="home"></a></p>
					<div data-elementor-type="wp-post" data-elementor-id="208" class="elementor elementor-208">
				<div class="elementor-element elementor-element-9dcd368 e-flex e-con-boxed e-con e-parent" data-id="9dcd368" data-element_type="container">
					<div class="e-con-inner">
		
		<div class="elementor-element elementor-element-b534186 e-con-full e-flex e-con e-child" data-id="b534186" data-element_type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
				<div class="elementor-element elementor-element-777193f elementor-widget__width-initial hfe-nav-menu__align-left hfe-submenu-icon-arrow hfe-submenu-animation-none hfe-link-redirect-child hfe-nav-menu__breakpoint-tablet elementor-widget elementor-widget-navigation-menu" data-id="777193f" data-element_type="widget" data-settings="{&quot;padding_vertical_menu_item&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:26,&quot;sizes&quot;:[]},&quot;menu_space_between&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:52,&quot;sizes&quot;:[]},&quot;menu_row_space&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:21,&quot;sizes&quot;:[]},&quot;padding_horizontal_menu_item&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:15,&quot;sizes&quot;:[]},&quot;padding_horizontal_menu_item_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_menu_item_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_menu_item_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_menu_item_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_space_between_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_space_between_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_row_space_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_row_space_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;dropdown_border_radius&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;top&quot;:&quot;&quot;,&quot;right&quot;:&quot;&quot;,&quot;bottom&quot;:&quot;&quot;,&quot;left&quot;:&quot;&quot;,&quot;isLinked&quot;:true},&quot;dropdown_border_radius_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;top&quot;:&quot;&quot;,&quot;right&quot;:&quot;&quot;,&quot;bottom&quot;:&quot;&quot;,&quot;left&quot;:&quot;&quot;,&quot;isLinked&quot;:true},&quot;dropdown_border_radius_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;top&quot;:&quot;&quot;,&quot;right&quot;:&quot;&quot;,&quot;bottom&quot;:&quot;&quot;,&quot;left&quot;:&quot;&quot;,&quot;isLinked&quot;:true},&quot;width_dropdown_item&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;220&quot;,&quot;sizes&quot;:[]},&quot;width_dropdown_item_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;width_dropdown_item_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_dropdown_item&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_dropdown_item_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_dropdown_item_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_dropdown_item&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:15,&quot;sizes&quot;:[]},&quot;padding_vertical_dropdown_item_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_dropdown_item_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;distance_from_menu&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;distance_from_menu_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;distance_from_menu_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_size&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_size_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_size_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_width&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_width_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_width_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_radius&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_radius_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_radius_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]}}" data-widget_type="navigation-menu.default">
				<div class="elementor-widget-container">
								<div class="hfe-nav-menu hfe-layout-horizontal hfe-nav-menu-layout horizontal hfe-pointer__text hfe-animation__grow" data-layout="horizontal">
				
				<nav class="hfe-nav-menu__layout-horizontal hfe-nav-menu__submenu-arrow" data-toggle-icon="&lt;svg aria-hidden=&quot;true&quot; tabindex=&quot;0&quot; class=&quot;e-font-icon-svg e-fas-align-justify&quot; viewBox=&quot;0 0 448 512&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;path d=&quot;M432 416H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-128H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-128H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-128H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;" data-close-icon="&lt;svg aria-hidden=&quot;true&quot; tabindex=&quot;0&quot; class=&quot;e-font-icon-svg e-far-window-close&quot; viewBox=&quot;0 0 512 512&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;path d=&quot;M464 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm0 394c0 3.3-2.7 6-6 6H54c-3.3 0-6-2.7-6-6V86c0-3.3 2.7-6 6-6h404c3.3 0 6 2.7 6 6v340zM356.5 194.6L295.1 256l61.4 61.4c4.6 4.6 4.6 12.1 0 16.8l-22.3 22.3c-4.6 4.6-12.1 4.6-16.8 0L256 295.1l-61.4 61.4c-4.6 4.6-12.1 4.6-16.8 0l-22.3-22.3c-4.6-4.6-4.6-12.1 0-16.8l61.4-61.4-61.4-61.4c-4.6-4.6-4.6-12.1 0-16.8l22.3-22.3c4.6-4.6 12.1-4.6 16.8 0l61.4 61.4 61.4-61.4c4.6-4.6 12.1-4.6 16.8 0l22.3 22.3c4.7 4.6 4.7 12.1 0 16.8z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;" data-full-width="yes">
					
				</nav>
			</div>
							</div>
				</div>
				</div>
					</div>
				</div>
				</div>
				</header>

		<div id="content" class="site-content">
		<div class="ast-container">
		

	<div id="primary" class="content-area primary">

		
					<main id="main" class="site-main">
				<article
class="post-5 page type-page status-publish ast-article-single" id="post-5" itemtype="https://schema.org/CreativeWork" itemscope="itemscope">
	
				<header class="entry-header ast-no-thumbnail ast-no-title ast-header-without-markup">
				<h1 class="entry-title" itemprop="headline"></h1>			</header> <!-- .entry-header -->
		
<div class="entry-content clear"
	itemprop="text">

	
			<div data-elementor-type="wp-page" data-elementor-id="5" class="elementor elementor-5">
				<div class="elementor-element elementor-element-7bebba9 e-con-full e-flex e-con e-parent" data-id="7bebba9" data-element_type="container">
				<div class="elementor-element elementor-element-774f972 elementor-widget-mobile__width-initial elementor-widget elementor-widget-shortcode" data-id="774f972" data-element_type="widget" data-widget_type="shortcode.default">
							<div class="elementor-shortcode"><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Accounting Tools for Small Business Owners & Freelancers | Your Finance Manager</title>
    <meta name="description" content="Make me your finance manager with almost free, easy-to-use accounting software. Track income, expenses, generate P&L, Balance Sheets, and More. Free Small Business Accounting Software">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f3f4f6; /* Light gray background */
        }
        /* Custom styles for better readability and spacing */
        /* Adjusted container for better mobile padding */
        .container-wrapper {
            max-width: 1024px;
            margin: 2rem auto;
            padding: 1rem; /* Reduced padding for smaller screens */
            background-color: #ffffff;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        @media (min-width: 640px) { /* sm breakpoint */
            .container-wrapper {
                padding: 1.5rem; /* Restore normal padding on larger screens */
            }
        }
        @media (min-width: 1024px) { /* lg breakpoint */
            .container-wrapper {
                padding: 2rem; /* Even more padding on very large screens */
            }
        }

        .tab-button {
            padding: 0.75rem 1.25rem; /* Slightly reduced horizontal padding for tabs on mobile */
            font-weight: 600;
            border-radius: 0.5rem 0.5rem 0 0;
            transition: all 0.3s ease;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            font-size: 0.9rem; /* Slightly smaller font for tabs on mobile */
        }
        @media (min-width: 640px) { /* sm breakpoint */
            .tab-button {
                padding: 0.75rem 1.5rem;
                font-size: 1rem;
            }
        }
        .tab-button.active {
            background-color: #4f46e5;
            color: white;
            border-color: #4f46e5;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .tab-button:not(.active):hover {
            background-color: #e5e7eb;
            color: #4b5563;
        }
        .form-input, .form-select {
            display: block;
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        .form-input:focus, .form-select:focus {
            border-color: #6366f1;
            outline: 0;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.25);
        }
        .btn-primary {
            background-color: #4f46e5;
            color: white;
            font-weight: 700;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .btn-primary:hover {
            background-color: #4338ca;
            transform: translateY(-2px);
        }
        .btn-secondary {
            background-color: #e5e7eb;
            color: #4b5563;
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            transition: background-color 0.3s ease;
        }
        .btn-secondary:hover {
            background-color: #d1d5db;
        }
        .table-header th {
            background-color: #f9fafb;
            text-align: left;
            padding: 0.75rem 0.5rem; /* Reduced padding for mobile tables */
            border-bottom: 1px solid #e5e7eb;
            color: #4b5563;
            font-size: 0.8rem; /* Smaller font for table headers on mobile */
        }
        .table-row td {
            padding: 0.75rem 0.5rem; /* Reduced padding for mobile tables */
            border-bottom: 1px solid #e5e7eb;
            font-size: 0.8rem; /* Smaller font for table cells on mobile */
        }
        @media (min-width: 640px) { /* sm breakpoint */
            .table-header th, .table-row td {
                padding: 0.75rem 1rem;
                font-size: 1rem;
            }
        }
        .table-row:nth-child(even) {
            background-color: #f9fafb;
        }
        .table-row:hover {
            background-color: #f3f4f6;
        }

        /* Modal specific styles */
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 90%;
            max-width: 700px;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            position: relative;
            max-height: 90vh; /* Limit height to enable scrolling */
            overflow-y: auto; /* Enable vertical scrolling */
        }
        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        /* Drag and Drop styles */
        .drag-drop-area {
            border: 2px dashed #d1d5db;
            border-radius: 0.75rem;
            padding: 2rem;
            text-align: center;
            background-color: #f9fafb;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        .drag-drop-area.hover {
            background-color: #e0e7ff;
            border-color: #6366f1;
        }
        .cloud-icon {
            margin: 0 auto 1rem auto;
            width: 64px;
            height: 64px;
            color: #9ca3af;
        }

        /* Dashboard specific styles */
        .kpi-card {
            background-color: #edf2f7; /* Light blue-gray */
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .kpi-card .value {
            font-size: 1.875rem; /* text-3xl for mobile */
            font-weight: 700; /* font-bold */
            color: #4f46e5; /* indigo-600 */
            margin-bottom: 0.25rem;
        }
        @media (min-width: 640px) { /* sm breakpoint */
            .kpi-card .value {
                font-size: 2.25rem; /* text-4xl on larger screens */
            }
        }
        .kpi-card .label {
            font-size: 0.875rem; /* text-sm */
            color: #4b5563; /* gray-600 */
        }
        .chart-container {
            background-color: #ffffff;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .bar-chart-bar {
            height: 20px;
            background-color: #6366f1; /* indigo-500 */
            border-radius: 0.25rem;
            margin-bottom: 0.5rem;
            color: white;
            text-align: right;
            padding-right: 0.5rem;
            font-size: 0.75rem; /* text-xs */
            display: flex;
            align-items: center;
            justify-content: flex-end;
            transition: width 0.5s ease-out;
            min-width: 10%; /* Ensure bars are visible even for small values */
        }
        .pie-chart-segment {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.25rem 0;
            border-bottom: 1px dashed #e5e7eb;
        }
        .pie-chart-segment:last-child {
            border-bottom: none;
        }
        .color-box {
            width: 1rem;
            height: 1rem;
            border-radius: 0.25rem;
            margin-right: 0.5rem;
            display: inline-block;
        }
        .recent-transactions-table th, .recent-transactions-table td {
            padding: 0.5rem 0.75rem;
            border-bottom: 1px solid #e5e7eb;
            text-align: left;
        }
        .recent-transactions-table th {
            background-color: #f9fafb;
            color: #4b5563;
            font-weight: 600;
        }
        .recent-transactions-table tr:last-child td {
            border-bottom: none;
        }

        /* Pie Chart Specific Styles (Simulated) */
        .pie-chart-container {
            position: relative;
            width: 150px; /* Slightly smaller for mobile */
            height: 150px; /* Slightly smaller for mobile */
            border-radius: 50%;
            overflow: hidden;
            margin: 0 auto 1rem;
            background-color: #e5e7eb; /* Fallback background */
        }
        @media (min-width: 640px) { /* sm breakpoint */
            .pie-chart-container {
                width: 180px;
                height: 180px;
            }
        }

        .pie-chart-slice {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transform-origin: 50% 50%;
            clip-path: polygon(50% 50%, 100% 0, 100% 100%, 0 100%, 0 0); /* A large enough polygon to cover the circle */
            background-color: currentColor; /* Will use the color set by JS */
        }
        .pie-chart-legend {
            margin-top: 1rem;
            font-size: 0.8rem; /* Smaller font for legend on mobile */
        }
        @media (min-width: 640px) { /* sm breakpoint */
            .pie-chart-legend {
                font-size: 0.875rem;
            }
        }
        .pie-chart-legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 0.25rem;
        }
        .pie-chart-legend-color {
            width: 0.8rem; /* Smaller color box */
            height: 0.8rem; /* Smaller color box */
            border-radius: 0.25rem;
            margin-right: 0.5rem;
        }
        @media (min-width: 640px) { /* sm breakpoint */
            .pie-chart-legend-color {
                width: 1rem;
                height: 1rem;
            }
        }
    </style>
	
</head>
<body>

    <div id="app" class="min-h-screen bg-gray-100 font-sans text-gray-900 flex flex-col items-center py-8 px-4 sm:px-6 lg:px-8">
        <div class="w-full max-w-4xl bg-white rounded-xl shadow-lg p-6 sm:p-8 container-wrapper">
            <div class="flex justify-between items-center mb-6 sm:mb-8">
                <h1 class="text-2xl sm:text-3xl lg:text-4xl font-extrabold text-center text-indigo-700 flex-grow">
                    Accounting Tools for Small Business
                </h1>
                <button id="helpButton" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-md transition duration-300">
                    Help
                </button>
            </div>

            <!-- New descriptive text added here -->
            <p class="text-center text-gray-600 text-base sm:text-lg mb-6">
                This is an easy-to-use accounting tools designed for sole proprietors, and small business owners. Input your profit & expense data (manual or Excel) to get instant, accurate Profit & Loss, Balance Sheet, Cash Flow, and more.
            </p>

            <!-- Navigation Tabs -->
            <div class="flex justify-center flex-wrap gap-2 mb-6 sm:mb-8 border-b border-gray-200">
                <button id="dataEntryTab" class="tab-button active">Data Entry</button>
                <button id="uploadTab" class="tab-button">Upload</button>
                <button id="reportsTab" class="tab-button">Reports</button>
                <button id="dashboardTab" class="tab-button">Dashboard</button>
            </div>

            <!-- Data Entry Section -->
            <div id="dataEntrySection" class="space-y-6">
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg shadow-inner">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4">Input Your Data</h2>
                    <form id="transactionForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="dateInput" class="block text-sm font-medium text-gray-700 mb-1">Date</label>
                            <input type="date" id="dateInput" class="form-input" required>
                        </div>
                        <div>
                            <label for="descriptionInput" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                            <input type="text" id="descriptionInput" placeholder="e.g., Sales, Rent Payment" class="form-input" required>
                        </div>
                        <div>
                            <label for="amountInput" class="block text-sm font-medium text-gray-700 mb-1">Amount</label>
                            <input type="number" id="amountInput" placeholder="e.g., 1500.00" step="0.01" min="0" class="form-input" required>
                        </div>
                        <div>
                            <label for="currencySelect" class="block text-sm font-medium text-gray-700 mb-1">Currency</label>
                            <select id="currencySelect" class="form-select" required>
                                <option value="INR">INR (₹)</option>
                                <option value="USD">USD ($)</option>
                            </select>
                        </div>
                        <div>
                            <label for="typeSelect" class="block text-sm font-medium text-gray-700 mb-1">Type</label>
                            <select id="typeSelect" class="form-select" required></select>
                        </div>
                        <div>
                            <label for="categorySelect" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                            <select id="categorySelect" class="form-select" required></select>
                        </div>
                        <div id="relatedPartyField" class="hidden">
                            <label for="relatedPartyInput" class="block text-sm font-medium text-gray-700 mb-1">Related Party (Customer/Vendor)</label>
                            <input type="text" id="relatedPartyInput" placeholder="e.g., Customer A, Supplier B" class="form-input">
                        </div>
                        <div id="isPaidField" class="hidden flex items-center col-span-1 md:col-span-2 mt-2">
                            <input type="checkbox" id="isPaidCheckbox" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                            <label for="isPaidCheckbox" class="ml-2 block text-sm font-medium text-gray-700">Mark as Paid (for AR/AP)</label>
                        </div>
                        <div class="md:col-span-2 flex justify-center mt-4">
                            <button type="submit" class="btn-primary w-full sm:w-auto">Add Transaction</button>
                        </div>
                    </form>
                </div>

                <!-- New Payments Received Section -->
                <div class="bg-gradient-to-r from-yellow-50 to-orange-50 p-6 rounded-lg shadow-inner">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4">Record Payments Received</h2>
                    <form id="paymentReceivedForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="paymentDateInput" class="block text-sm font-medium text-gray-700 mb-1">Date</label>
                            <input type="date" id="paymentDateInput" class="form-input" required>
                        </div>
                        <div>
                            <label for="paymentDescriptionInput" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                            <input type="text" id="paymentDescriptionInput" placeholder="e.g., Sales from Customer X" class="form-input" required>
                        </div>
                        <div>
                            <label for="paymentAmountInput" class="block text-sm font-medium text-gray-700 mb-1">Amount</label>
                            <input type="number" id="paymentAmountInput" placeholder="e.g., 500.00" step="0.01" min="0" class="form-input" required>
                        </div>
                        <div>
                            <label for="paymentCurrencySelect" class="block text-sm font-medium text-gray-700 mb-1">Currency</label>
                            <select id="paymentCurrencySelect" class="form-select" required>
                                <option value="INR">INR (₹)</option>
                                <option value="USD">USD ($)</option>
                            </select>
                        </div>
                        <div>
                            <label for="paymentMethodSelect" class="block text-sm font-medium text-gray-700 mb-1">Payment Method</label>
                            <select id="paymentMethodSelect" class="form-select" required>
                                <option value="Cash">Cash</option>
                                <option value="UPI">UPI</option>
                                <option value="Bank Transfer">Bank Transfer</option>
                                <option value="Cheque Deposit">Cheque Deposit</option>
                            </select>
                        </div>
                        <div class="md:col-span-2 flex justify-center mt-4">
                            <button type="submit" class="btn-primary w-full sm:w-auto bg-green-600 hover:bg-green-700">Add Payment</button>
                        </div>
                    </form>
                </div>
                <!-- End New Payments Received Section -->

                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl sm:text-2xl font-bold text-gray-800">All Transactions</h2>
                        <button id="clearTransactionsBtn" class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-md transition duration-300">
                            Clear All Transactions
                        </button>
                    </div>
                    <div id="transactionsList" class="overflow-x-auto">
                        <!-- Transactions will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- Upload Section (New) -->
            <div id="uploadSection" class="space-y-6 hidden">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4">Excel/CSV Upload</h2>
                    <div id="dragDropArea" class="drag-drop-area">
                        <!-- Cloud SVG Icon -->
                        <svg class="cloud-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v7"></path>
                        </svg>
                        <p class="text-gray-600 mb-2">Drag and drop your Excel or CSV file here, or</p>
                        <input type="file" id="excelFileInput" accept=".xlsx, .xls, .csv" class="hidden">
                        <button id="browseFilesBtn" class="btn-primary px-6 py-2">Browse Files</button>
                        <p class="text-gray-500 text-sm mt-2">Supported formats: .xlsx, .xls, .csv</p>
                    </div>
                    <div id="uploadMessage" class="mt-4 text-center text-sm font-medium hidden"></div>

                    <div class="bg-blue-50 border border-blue-200 text-blue-800 p-4 rounded-lg mt-6">
                        <h3 class="text-lg font-semibold mb-2 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 10a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1-6a1 1 0 00-1 1v3a1 1 0 102 0V9a1 1 0 00-1-1z" clip-rule="evenodd" />
                            </svg>
                            Excel/CSV Template Requirements:
                        </h3>
                        <ul class="list-disc list-inside ml-4 text-sm">
                            <li>Column A: Date (MM/DD/YYYY)</li>
                            <li>Column B: Description</li>
                            <li>Column C: Category</li>
                            <li>Column D: Amount</li>
                            <li>Column E: Type (Income/Expense/Asset/Liability/Equity)</li>
                            <li>Column F: Currency (INR/USD) - New!</li>
                        </ul>
                        <div class="text-right mt-4">
                            <button id="downloadTemplateBtn" class="btn-secondary flex items-center justify-center float-right">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L10 11.586l2.293-2.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414zM9 4a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1z" clip-rule="evenodd" />
                                </svg>
                                Download Template
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reports Section -->
            <div id="reportsSection" class="space-y-6 hidden">
                <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg shadow-inner">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4">View Your Reports</h2>
                    <div class="flex flex-wrap justify-center gap-2 sm:gap-4 mb-4">
                        <button id="pnlReportBtn" class="btn-secondary active">Profit & Loss</button>
                        <button id="balanceSheetReportBtn" class="btn-secondary">Balance Sheet</button>
                        <button id="cashFlowReportBtn" class="btn-secondary">Cash Flow</button>
                        <button id="bankAccountStatementsBtn" class="btn-secondary">Bank Account Statements</button>
                        <button id="ledgerStatementsBtn" class="btn-secondary">Ledger Statements</button>
                    </div>

                    <div class="flex flex-wrap justify-center gap-2 sm:gap-4 mb-6 items-center" id="reportDateFilters">
                        <label for="startDateInputReport" class="text-sm font-medium text-gray-700">From:</label>
                        <input type="date" id="startDateInputReport" class="form-input w-auto">
                        <label for="endDateInputReport" class="text-sm font-medium text-gray-700">To:</label>
                        <input type="date" id="endDateInputReport" class="form-input w-auto">
                        <button id="applyDateFilterBtn" class="btn-primary py-1 px-3 text-sm">Apply Filter</button>
                    </div>

                    <div id="reportDisplay">
                        <!-- Reports will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- Dashboard Section -->
            <div id="dashboardSection" class="space-y-6 hidden">
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg shadow-inner">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-6">Financial Dashboard Overview</h2>

                    <!-- KPIs -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-8">
                        <div class="kpi-card">
                            <div class="value" id="totalRevenueKPI"></div>
                            <div class="label">Total Revenue</div>
                        </div>
                        <div class="kpi-card">
                            <div class="value" id="totalExpensesKPI"></div>
                            <div class="label">Total Expenses</div>
                        </div>
                        <div class="kpi-card">
                            <div class="value" id="netProfitLossKPI"></div>
                            <div class="label">Net Profit/Loss</div>
                        </div>
                        <div class="kpi-card">
                            <div class="value" id="totalTransactionsKPI"></div>
                            <div class="label">Total Transactions</div>
                        </div>
                        <div class="kpi-card">
                            <div class="value" id="avgTransactionSizeKPI"></div>
                            <div class="label">Avg. Transaction Value</div>
                        </div>
                        <div class="kpi-card">
                            <div class="value" id="totalOutstandingReceivablesKPI"></div>
                            <div class="label">Outstanding Receivables</div>
                        </div>
                        <div class="kpi-card">
                            <div class="value" id="totalOutstandingPayablesKPI"></div>
                            <div class="label">Outstanding Payables</div>
                        </div>
                        <div class="kpi-card">
                            <div class="value" id="totalAssetsKPI"></div>
                            <div class="label">Total Assets</div>
                        </div>
                        <div class="kpi-card">
                            <div class="value" id="totalLiabilitiesKPI"></div>
                            <div class="label">Total Liabilities</div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Monthly Revenue Trend -->
                        <div class="chart-container">
                            <h3 class="text-lg sm:text-xl font-bold text-gray-800 mb-4">Monthly Revenue Trend</h3>
                            <div id="monthlyRevenueChart" class="space-y-2">
                                <!-- Monthly revenue bars will be rendered here -->
                            </div>
                            <p class="text-xs sm:text-sm text-gray-600 mt-4">
                                (Income transactions grouped by month)
                            </p>
                        </div>

                        <!-- Income Distribution Pie Chart -->
                        <div class="chart-container flex flex-col items-center">
                            <h3 class="text-lg sm:text-xl font-bold text-gray-800 mb-4">Income Distribution by Category</h3>
                            <div id="incomeDistributionPieChart" class="w-full flex justify-center">
                                <!-- Pie chart will be rendered here -->
                            </div>
                            <p class="text-xs sm:text-sm text-gray-600 mt-4 text-center">
                                (Percentage of total income from each category)
                            </p>
                        </div>

                        <!-- Top Expense Categories -->
                        <div class="chart-container">
                            <h3 class="text-lg sm:text-xl font-bold text-gray-800 mb-4">Top Expense Categories</h3>
                            <div id="topExpensesChart" class="space-y-2">
                                <!-- Top expense bars will be rendered here -->
                            </div>
                            <p class="text-xs sm:text-sm text-gray-600 mt-4">
                                (Largest expenses by category)
                            </p>
                        </div>

                        <!-- Expense Distribution Pie Chart -->
                        <div class="chart-container flex flex-col items-center">
                            <h3 class="text-lg sm:text-xl font-bold text-gray-800 mb-4">Expense Distribution by Category</h3>
                            <div id="expenseDistributionPieChart" class="w-full flex justify-center">
                                <!-- Pie chart will be rendered here -->
                            </div>
                            <p class="text-xs sm:text-sm text-gray-600 mt-4 text-center">
                                (Percentage of total expenses from each category)
                            </p>
                        </div>

                        <!-- Recent Transactions -->
                        <div class="chart-container lg:col-span-2">
                            <h3 class="text-lg sm:text-xl font-bold text-gray-800 mb-4">Recent Transactions</h3>
                            <div id="recentTransactionsList" class="overflow-x-auto">
                                <!-- Recent transactions table will be rendered here -->
                            </div>
                            <p class="text-xs sm:text-sm text-gray-600 mt-4">
                                (Last 5 transactions added, sorted by date descending)
                            </p>
                        </div>
                    </div>
                    <div class="flex justify-end gap-2 mt-6">
                        <button id="copyDashboardSummaryBtn" class="btn-secondary">Copy Dashboard Summary</button>
                        <!-- PDF Download Button was here, now removed -->
                    </div>
                </div>
            </div>
        </div>

        

    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4">Financial Terms Defined</h2>

            <div class="space-y-4 text-gray-700 text-sm sm:text-base">
                <div>
                    <h3 class="text-lg sm:text-xl font-semibold text-indigo-700 mb-2">1. Income: Money Coming In</h3>
                    <p>The amount of money you earns by selling goods or services in your business.</p>
                    <p class="text-xs sm:text-sm text-gray-600 italic">
                        **Example:** When you sell something for $100 or $80, then $100 and $80 is your income. When you perform a service for $20, then $20 is income as well.
                    </p>
                </div>
                <div>
                    <h3 class="text-lg sm:text-xl font-semibold text-indigo-700 mb-2">2. Expenses: Money Going Out</h3>
                    <p>These are the costs your company pays to operate. They eat into your profit.</p>
                    <p class="text-xs sm:text-sm text-gray-600 italic">
                        **Example:** Your monthly rent, wages paid to employees or worker, electricity bill, or money spent on marketing or ads.
                    </p>
                </div>
                <div>
                    <h3 class="text-lg sm:text-xl font-semibold text-indigo-700 mb-2">3. Assets: All that things which belongs to your business or a company.</h3>
                    <p class="text-xs sm:text-sm text-gray-600 italic">
                        **Example:** Money in your bank account, computers, equipment, inventory (the goods you are going to sell), or money owed to you by customers (Accounts Receivable).
                    </p>
                </div>
                <div>
                    <h3 class="text-lg sm:text-xl font-semibold text-indigo-700 mb-2">4. Liabilities: What Your Business Owes</h3>
                    <p>These are what other parties owe your business. They are debts that your business has to pay.</p>
                    <p class="text-xs sm:text-sm text-gray-600 italic">
                        **Example:** Amounts owed to suppliers for purchases on credit (Accounts Payable), bank loan, or electricity bills not yet paid.
                    </p>
                </div>
                <div>
                    <h3 class="text-lg sm:text-xl font-semibold text-indigo-700 mb-2">5. Equity: The Owner's Share</h3>
                    <p>This is what you, the owner, have been left with if your entire assets were sold and all your debts were paid. It's your ownership stake.</p>
                    <p class="text-xs sm:text-sm text-gray-600 italic">
                        **Equation:** Assets - Liabilities = Equity
                        <br>
                        **Example:** How much money you originally invested in the business, and profits you've retained and reinvested.
                    </p>
                </div>

                <hr class="my-6 border-gray-300">

                <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4">Category Explanations</h2>

                <div class="space-y-3">
                    <h3 class="text-lg sm:text-xl font-semibold text-blue-700 mb-1">Income Categories:</h3>
                    <ul class="list-disc list-inside ml-4 space-y-2 text-sm sm:text-base">
                        <li>
                            <strong class="text-gray-800">Sales Revenue:</strong> Money generated from the direct sale of your main products or services.
                            <p class="text-xs sm:text-sm text-gray-600 italic">**Example:** 10 t-shirts sold at $20 each is $200 Sales Revenue.</p>
                        </li>
                        <li>
                            <strong class="text-gray-800">Service Revenue:</strong> Money received for providing services.
                            <p class="text-xs sm:text-sm text-gray-600 italic">**Example:** Receiving $500 from consulting services provided to a client.</p>
                        </li>
                        <li>
                            <strong class="text-gray-800">Other Income:</strong> Any other income aside from your main sales or services.
                            <p class="text-xs sm:text-sm text-gray-600 italic">**Example:** Interest accrued on a business savings account or selling used office equipment.</p>
                        </li>
                    </ul>

                    <h3 class="text-lg sm:text-xl font-semibold text-blue-700 mb-1 mt-6">Expense Categories:</h3>
                    <ul class="list-disc list-inside ml-4 space-y-2 text-sm sm:text-base">
                        <li>
                            <strong class="text-gray-800">Rent Cost:</strong> Cost of renting business premises, a store, or machinery.
                            <p class="text-xs sm:text-sm text-gray-600 italic">**Illustration:** Payment for a $1,000 monthly office rent.</p>
                        </li>
                        <li>
                            <strong class="text-gray-800">Utilities Costs:</strong> These include expenses for services such as electricity, water, gas, and internet.
                            <p class="text-xs sm:text-sm text-gray-600 italic">For instance, you might pay $150 for electricity every month.</p>
                        </li>
                        <li>
                            <strong class="text-gray-800">Salaries Expense:</strong> Payments to employees as wages for work.
                            <p class="text-xs sm:text-sm text-gray-600 italic">**Example:** Paying your weekend worker $800 for the month.</p>
                        </li>
                        <li>
                            <strong class="text-gray-800">Marketing Expense:</strong> This is the money you spend to promote your business.
                            <p class="text-xs sm:text-sm text-gray-600 italic">**Example:** Putting $200 into a social media advertising campaign.</p>
                        </li>
                        <li>
                            <strong class="text-gray-800">Other Expenses:</strong> All other operating expenditures of your company not covered under other given categories.
                            <p class="text-xs sm:text-sm text-gray-600 italic">**Illustration:** Office supplies, minor maintenance, or software subscription.</p>
                        </li>
                    </ul>

                    <h3 class="text-lg sm:text-xl font-semibold text-blue-700 mb-1 mt-6">Asset Classes:</h3>
                    <ul class="list-disc list-inside ml-4 space-y-2 text-sm sm:text-base">
                        <li>
                            <strong class="text-gray-800">Cash:</strong> Actual money in possession.
                            <p class="text-xs sm:text-sm text-gray-600 italic">**Example:** Draw money out of your firm's petty cash box or cash drawer.</p>
                        </li>
                        <li>
                            <strong class="text-gray-800">Bank:</strong> Funds in your business savings and checking accounts.
                            <p class="text-xs sm:text-sm text-gray-600 italic">**Example:** The balance of your savings or business checking account.</p>
                        </li>
                        <li>
                            <strong class="text-gray-800">Accounts Receivable:</strong> Amounts owing to your business by customers in credit sales.
                            <p class="text-xs sm:text-sm text-gray-600 italic">Imagine you sold an item to a customer for $300, and they’ll pay you next month.</p>
                        </li>
                        <li>
                            <strong class="text-gray-800">Fixed Assets:</strong> These are long-term things your business owns that you don’t plan to sell, like office buildings, heavy machinery, vehicles, or big computer systems.
                        </li>
                    </ul>

                    <h3 class="text-lg sm:text-xl font-semibold text-blue-700 mb-1 mt-6">Liability Categories:</h3>
                    <ul class="list-disc list-inside ml-4 space-y-2 text-sm sm:text-base">
                        <li>
                            <strong class="text-gray-800">Accounts Payable:</strong> This is the money your company owes to suppliers or vendors for goods or services you received on credit.
                            <p class="text-xs sm:text-sm text-gray-600 italic">For instance, if you bought printer ink for $150, you need to pay for it next week.</p>
                        </li>
                        <li>
                            <strong class="text-800">Loans Payable:</strong> This is the money your business has borrowed that needs to be repaid.
                            <p class="text-xs sm:text-sm text-gray-600 italic">This could be a loan from a bank or from a private lender.</p>
                        </li>
                    </ul>

                    <h3 class="text-lg sm:text-xl font-semibold text-blue-700 mb-1 mt-6">Equity Categories:</h3>
                    <ul class="list-disc list-inside ml-4 space-y-2 text-sm sm:text-base">
                        <li>
                            <strong class="text-gray-800">Owner's Capital:</strong> Is the money or property that the owner first invests in the business.
                            <p class="text-xs sm:text-sm text-gray-600 italic">For example, if you put in $5,000 of your own money to start the business, that’s your capital.</p>
                        </li>
                        <li>
                            <strong class="text-gray-800">Retained Earnings:</strong> This refers to the profits your business has made that you’ve kept to use for reinvesting instead of paying them out to owners.
                            <p class="text-xs sm:text-sm text-gray-600 italic">For instance, if your business earned $1,000 last year and you decided to use that money to buy new equipment, that’s retained earnings.</p>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Immediately hide the help modal as soon as it's parsed
        document.getElementById('helpModal').style.display = 'none';
    </script>

    <!-- Clear Confirmation Modal -->
    <div id="clearConfirmModal" class="modal hidden">
        <div class="modal-content max-w-md">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Confirm Clear All Transactions</h2>
            <p class="text-gray-700 mb-6">
                Are you sure you want to clear ALL transactions? This action cannot be undone.
                All your financial data will be permanently deleted.
            </p>
            <div class="flex justify-end gap-3">
                <button id="cancelClearBtn" class="btn-secondary">Cancel</button>
                <button id="confirmClearBtn" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-md transition duration-300">
                    Clear All
                </button>
            </div>
        </div>
    </div>
    <script>
        // Immediately hide the clear confirmation modal as soon as it's parsed
        document.getElementById('clearConfirmModal').style.display = 'none';
    </script>

    <script>
        // Helper to generate unique IDs
        const generateId = () => Math.random().toString(36).substr(2, 9);

        // Define financial account types and categories for dropdowns
        const ACCOUNT_TYPES = ['Income', 'Expense', 'Asset', 'Liability', 'Equity'];
        const ACCOUNT_CATEGORIES = {
            Income: ['Sales Revenue', 'Service Revenue', 'Other Income'],
            Expense: ['Rent Expense', 'Utilities Expense', 'Salaries Expense', 'Marketing Expense', 'Other Expenses'],
            Asset: ['Cash', 'Bank', 'Accounts Receivable', 'Fixed Assets'],
            Liability: ['Accounts Payable', 'Loans Payable'],
            Equity: ['Owner\'s Capital', 'Retained Earnings'],
        };

        // Static conversion rate (for demonstration purposes)
        const USD_TO_INR_RATE = 83.00; // Example rate: 1 USD = 83 INR

        let transactions = []; // Global array to store transactions

        // --- Currency Conversion Helpers ---
        function convertToUSD(amount, currency) {
            if (currency === 'INR') {
                return amount / USD_TO_INR_RATE;
            }
            return amount; // Already in USD
        }

        function convertToINR(amount, currency) {
            if (currency === 'USD') {
                return amount * USD_TO_INR_RATE;
            }
            return amount; // Already in INR
        }

        function formatAmountDisplay(amount, originalCurrency) {
            let primarySymbol = originalCurrency === 'INR' ? '₹' : '$';
            let secondarySymbol = originalCurrency === 'INR' ? '$' : '₹';

            let convertedAmount;
            if (originalCurrency === 'INR') {
                convertedAmount = convertToUSD(amount, 'INR');
            } else {
                convertedAmount = convertToINR(amount, 'USD');
            }

            return `${primarySymbol}${amount.toFixed(2)} (${secondarySymbol}${convertedAmount.toFixed(2)})`;
        }

        // --- Initialization Functions ---

        // Populate Type dropdown
        function populateTypeSelect() {
            // Ensure typeSelect exists before trying to populate
            const typeSelect = document.getElementById('typeSelect');
            if (!typeSelect) {
                console.error("typeSelect element not found for populating.");
                return;
            }
            typeSelect.innerHTML = '';
            ACCOUNT_TYPES.forEach(type => {
                const option = document.createElement('option');
                option.value = type;
                option.textContent = type;
                typeSelect.appendChild(option);
            });
            populateCategorySelect(); // Populate categories based on initial type
        }

        // Populate Category dropdown based on selected Type
        function populateCategorySelect() {
            const typeSelect = document.getElementById('typeSelect');
            const categorySelect = document.getElementById('categorySelect');
            if (!typeSelect || !categorySelect) {
                console.error("typeSelect or categorySelect element not found for populating categories.");
                return;
            }
            const selectedType = typeSelect.value;
            const categories = ACCOUNT_CATEGORIES[selectedType] || [];
            categorySelect.innerHTML = '';
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categorySelect.appendChild(option);
            });
            toggleRelatedPartyFields(); // Adjust visibility of related party fields
        }

        // Toggle visibility of Related Party and Is Paid fields
        function toggleRelatedPartyFields() {
            const categorySelect = document.getElementById('categorySelect');
            const relatedPartyField = document.getElementById('relatedPartyField');
            const relatedPartyInput = document.getElementById('relatedPartyInput');
            const isPaidField = document.getElementById('isPaidField');
            if (!categorySelect || !relatedPartyField || !relatedPartyInput || !isPaidField) {
                console.error("One or more related party elements not found for toggling.");
                return;
            }

            const selectedCategory = categorySelect.value;
            const isARAP = ['Accounts Receivable', 'Accounts Payable'].includes(selectedCategory);
            relatedPartyField.classList.toggle('hidden', !isARAP);
            isPaidField.classList.toggle('hidden', !isARAP);
            relatedPartyInput.required = isARAP; // Make required if visible
        }

        // Set initial date to today
        function setInitialDate() {
            const dateInput = document.getElementById('dateInput');
            const paymentDateInput = document.getElementById('paymentDateInput');
            const startDateInputReport = document.getElementById('startDateInputReport');
            const endDateInputReport = document.getElementById('endDateInputReport');

            const today = new Date().toISOString().split('T')[0];
            if (dateInput) dateInput.value = today;
            if (paymentDateInput) paymentDateInput.value = today;

            // Set initial date range for reports (e.g., last 30 days or empty)
            const thirtyDaysAgo = new Date(new Date());
            thirtyDaysAgo.setDate(new Date().getDate() - 30);
            if (startDateInputReport) startDateInputReport.value = thirtyDaysAgo.toISOString().split('T')[0];
            if (endDateInputReport) endDateInputReport.value = today;
        }

        // --- Event Handlers ---

        // Tab switching
        function switchTab(tabName) {
            // Get all tab buttons and sections
            const dataEntryTab = document.getElementById('dataEntryTab');
            const uploadTab = document.getElementById('uploadTab');
            const reportsTab = document.getElementById('reportsTab');
            const dashboardTab = document.getElementById('dashboardTab');

            const dataEntrySection = document.getElementById('dataEntrySection');
            const uploadSection = document.getElementById('uploadSection');
            const reportsSection = document.getElementById('reportsSection');
            const dashboardSection = document.getElementById('dashboardSection');

            // Remove 'active' from all tabs
            [dataEntryTab, uploadTab, reportsTab, dashboardTab].forEach(tab => {
                if (tab) tab.classList.remove('active');
            });

            // Hide all sections
            [dataEntrySection, uploadSection, reportsSection, dashboardSection].forEach(section => {
                if (section) section.classList.add('hidden');
            });

            // Activate selected tab and show section
            let targetTab, targetSection;
            if (tabName === 'dataEntry') {
                targetTab = dataEntryTab;
                targetSection = dataEntrySection;
            } else if (tabName === 'upload') {
                targetTab = uploadTab;
                targetSection = uploadSection;
            } else if (tabName === 'reports') {
                targetTab = reportsTab;
                targetSection = reportsSection;
                renderReport(currentReportType); // Render the current report when switching to reports tab
            } else if (tabName === 'dashboard') {
                targetTab = dashboardTab;
                targetSection = dashboardSection;
                renderDashboard(); // Render dashboard when switching to dashboard tab
            }

            if (targetTab) targetTab.classList.add('active');
            if (targetSection) targetSection.classList.remove('hidden');
            currentTab = tabName;
        }

        // Function to display upload message
        function showUploadMessage(message, isError = false) {
            const uploadMessage = document.getElementById('uploadMessage');
            if (!uploadMessage) return;

            uploadMessage.textContent = message;
            uploadMessage.classList.remove('hidden');
            if (isError) {
                uploadMessage.classList.remove('text-green-600');
                uploadMessage.classList.add('text-red-600');
            } else {
                uploadMessage.classList.remove('text-red-600');
                uploadMessage.classList.add('text-green-600');
            }
            setTimeout(() => {
                uploadMessage.classList.add('hidden');
            }, 3000); // Hide after 3 seconds
        }

        // Function to show temporary messages (e.g., for export success)
        function showTemporaryMessage(message, isError = false) {
            const messageDiv = document.createElement('div');
            messageDiv.textContent = message;
            messageDiv.className = `fixed bottom-4 right-4 p-3 rounded-md shadow-lg text-white ${isError ? 'bg-red-500' : 'bg-green-500'} z-50`;
            document.body.appendChild(messageDiv);

            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        // --- Report Filtering Helper ---
        function getFilteredTransactions() {
            const startDateInputReport = document.getElementById('startDateInputReport');
            const endDateInputReport = document.getElementById('endDateInputReport');

            const startDate = startDateInputReport && startDateInputReport.value ? new Date(startDateInputReport.value + 'T00:00:00') : null;
            const endDate = endDateInputReport && endDateInputReport.value ? new Date(endDateInputReport.value + 'T23:59:59') : null;

            return transactions.filter(t => {
                const transactionDate = new Date(t.date + 'T12:00:00');
                let inDateRange = true;
                if (startDate && transactionDate < startDate) {
                    inDateRange = false;
                }
                if (endDate && transactionDate > endDate) {
                    inDateRange = false;
                }
                return inDateRange;
            });
        }

        /**
         * Escapes a field for CSV export.
         * Encloses the field in double quotes if it contains commas, double quotes, or newlines.
         * Doubles any internal double quotes.
         * @param {string} field The string to escape.
         * @returns {string} The escaped string.
         */
        function escapeCsvField(field) {
            if (typeof field !== 'string') {
                field = String(field); // Ensure it's a string
            }
            // If the field contains a comma, double quote, or newline, enclose it in double quotes
            if (field.includes(',') || field.includes('"') || field.includes('\n')) {
                // Escape internal double quotes by doubling them
                return `"${field.replace(/"/g, '""')}"`;
            }
            return field;
        }

        // --- Export CSV Helper ---
        function exportToCsv(filename, csvContent) {
            console.log(`Attempting to export ${filename}. Content length: ${csvContent.length}`);
            console.log("CSV Content preview:", csvContent.substring(0, 200) + (csvContent.length > 200 ? '...' : ''));

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;

            document.body.appendChild(a);
            a.click();

            setTimeout(() => {
                URL.revokeObjectURL(url);
                if (a.parentNode) {
                    document.body.removeChild(a);
                }
            }, 100);

            showTemporaryMessage(`${filename} exported successfully!`);
        }

        // --- Copy to Clipboard Helper ---
        function copyToClipboard(text, message) {
            try {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showTemporaryMessage(message);
            } catch (err) {
                console.error('Failed to copy text: ', err);
                showTemporaryMessage('Failed to copy to clipboard.', true);
            }
        }

        // --- Render Functions ---

        // Render all transactions in a table
        function renderTransactions() {
            const transactionsList = document.getElementById('transactionsList');
            if (!transactionsList) {
                console.error("transactionsList element not found.");
                return;
            }

            if (transactions.length === 0) {
                transactionsList.innerHTML = '<p class="text-gray-600">No transactions added yet. Start by adding some data!</p>';
                return;
            }

            let tableHtml = `
                <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="py-2 px-4 border-b text-left text-gray-600">Date</th>
                            <th class="py-2 px-4 border-b text-left text-gray-600">Description</th>
                            <th class="py-2 px-4 border-b text-right text-gray-600">Amount</th>
                            <th class="py-2 px-4 border-b text-left text-gray-600">Type</th>
                            <th class="py-2 px-4 border-b text-left text-gray-600">Category</th>
                            <th class="py-2 px-4 border-b text-left text-gray-600">Status</th>
                            <th class="py-2 px-4 border-b text-left text-gray-600">Action</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            // Sort transactions by date in descending order (most recent first)
            const sortedTransactions = [...transactions].sort((a, b) => new Date(b.date) - new Date(a.date));

            sortedTransactions.forEach(t => {
                const status = ['Accounts Receivable', 'Accounts Payable'].includes(t.category) ? (t.isPaid ? 'Paid' : 'Outstanding') : 'N/A';
                tableHtml += `
                    <tr class="table-row">
                        <td class="py-2 px-4 border-b">${escapeCsvField(t.date)}</td>
                        <td class="py-2 px-4 border-b">${escapeCsvField(t.description)}</td>
                        <td class="py-2 px-4 border-b text-right">${formatAmountDisplay(t.amount, t.currency)}</td>
                        <td class="py-2 px-4 border-b">${escapeCsvField(t.type)}</td>
                        <td class="py-2 px-4 border-b">${escapeCsvField(t.category)}</td>
                        <td class="py-2 px-4 border-b">${escapeCsvField(status)}</td>
                        <td class="py-2 px-4 border-b">
                            <button data-id="${t.id}" class="delete-btn bg-red-500 hover:bg-red-600 text-white text-sm py-1 px-2 rounded-md transition duration-200">
                                Delete
                            </button>
                        </td>
                    </tr>
                `;
            });
            tableHtml += `</tbody></table>`;
            transactionsList.innerHTML = tableHtml;
        }

        // Delete transaction function (called from rendered HTML)
        function deleteTransaction(id) {
            transactions = transactions.filter(t => t.id !== id);
            renderTransactions();
            renderReport(currentReportType); // Re-render report if data changes
            renderDashboard(); // Update dashboard after deleting transaction
        }

        // Mark AR/AP as paid (called from rendered HTML)
        function markAsPaid(id) {
            transactions = transactions.map(t =>
                t.id === id ? { ...t, isPaid: true } : t
            );
            renderReport(currentReportType); // Re-render report
            renderDashboard(); // Update dashboard after marking as paid
        }

        // --- Clear All Transactions Function ---
        function clearAllTransactions() {
            const clearConfirmModal = document.getElementById('clearConfirmModal');
            if (clearConfirmModal) {
                clearConfirmModal.classList.remove('hidden');
                clearConfirmModal.style.display = 'flex'; // Ensure it's visible when clicked
            }
        }

        // Main report rendering function
        function renderReport(type) {
            const reportDisplay = document.getElementById('reportDisplay');
            const reportDateFilters = document.getElementById('reportDateFilters');
            const startDateInputReport = document.getElementById('startDateInputReport');
            const endDateInputReport = document.getElementById('endDateInputReport');

            if (!reportDisplay || !reportDateFilters || !startDateInputReport || !endDateInputReport) {
                console.error("Report elements not found for rendering.");
                return;
            }

            const filteredTransactions = getFilteredTransactions();

            // Hide/show date filters based on report type
            if (type === 'pnl' || type === 'balanceSheet' || type === 'cashFlow' || type === 'bankAccountStatements' || type === 'ledgerStatements') {
                reportDateFilters.classList.remove('hidden');
            } else {
                reportDateFilters.classList.add('hidden');
            }

            if (filteredTransactions.length === 0 && type !== 'bankAccountStatements' && type !== 'ledgerStatements') {
                reportDisplay.innerHTML = `
                    <div class="text-center text-gray-600 p-8 bg-white rounded-lg shadow-md">
                        <p class="text-lg">No transactions found for the selected date range. Please add some data or adjust the filter.</p>
                    </div>
                `;
                return;
            }

            switch (type) {
                case 'pnl':
                    renderPnLReport(filteredTransactions);
                    break;
                case 'balanceSheet':
                    renderBalanceSheetReport(filteredTransactions);
                    break;
                case 'cashFlow':
                    renderCashFlowReport(filteredTransactions);
                    break;
                case 'bankAccountStatements':
                    renderBankAccountStatements(filteredTransactions);
                    break;
                case 'ledgerStatements':
                    renderLedgerStatements(filteredTransactions);
                    break;
                default:
                    // If the current type is no longer valid, default to P&L
                    currentReportType = 'pnl';
                    renderPnLReport(filteredTransactions);
            }
        }

        // P&L Report
        function renderPnLReport(filteredTransactions) {
            const reportDisplay = document.getElementById('reportDisplay');
            if (!reportDisplay) return;

            // Convert all amounts to USD for consistent calculation
            const incomeUSD = filteredTransactions
                .filter(t => t.type === 'Income')
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            const expensesUSD = filteredTransactions
                .filter(t => t.type === 'Expense')
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            const netProfitUSD = incomeUSD - expensesUSD;

            // Prepare CSV content (using USD as base for export)
            const csvContent = `Report Type,Amount (USD)\n${escapeCsvField("Total Income")},${incomeUSD.toFixed(2)}\n${escapeCsvField("Total Expenses")},${expensesUSD.toFixed(2)}\n${escapeCsvField("Net Profit (Loss)")},${netProfitUSD.toFixed(2)}`;

            reportDisplay.innerHTML = `
                <div class="p-4 bg-white rounded-lg shadow-md">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">Profit & Loss Statement</h3>
                    <div class="grid grid-cols-2 gap-4 text-lg">
                        <div class="font-semibold text-gray-700">Total Income:</div>
                        <div class="text-right text-green-600">${formatAmountDisplay(incomeUSD, 'USD')}</div>
                        <div class="font-semibold text-gray-700">Total Expenses:</div>
                        <div class="text-right text-red-600">${formatAmountDisplay(expensesUSD, 'USD')}</div>
                        <div class="font-bold text-gray-800 border-t-2 border-gray-300 pt-2">Net Profit (Loss):</div>
                        <div class="font-bold text-right border-t-2 border-gray-300 pt-2 ${netProfitUSD >= 0 ? 'text-green-700' : 'text-red-700'}">
                            ${formatAmountDisplay(netProfitUSD, 'USD')}
                        </div>
                    </div>
                    <div class="flex justify-end gap-2 mt-4">
                        <button onclick="exportToCsv('profit_loss_report.csv', \`${csvContent}\`)" class="btn-secondary">Export to CSV</button>
                        <button onclick="copyToClipboard(\`Profit & Loss Statement:\nTotal Income: ${formatAmountDisplay(incomeUSD, 'USD')}\nTotal Expenses: ${formatAmountDisplay(expensesUSD, 'USD')}\nNet Profit (Loss): ${formatAmountDisplay(netProfitUSD, 'USD')}\`, 'Profit & Loss report copied to clipboard!')" class="btn-secondary">Copy to Clipboard</button>
                    </div>
                </div>
            `;
        }

        // Balance Sheet Report
        function renderBalanceSheetReport(filteredTransactions) {
            const reportDisplay = document.getElementById('reportDisplay');
            const endDateInputReport = document.getElementById('endDateInputReport');
            if (!reportDisplay || !endDateInputReport) return;

            // For Balance Sheet, we need to consider ALL transactions up to the end date, not just within the range.
            // This is because assets, liabilities, and equity are cumulative.
            const endDate = endDateInputReport.value ? new Date(endDateInputReport.value + 'T23:59:59') : new Date();

            const relevantTransactions = transactions.filter(t => {
                const transactionDate = new Date(t.date + 'T12:00:00');
                return transactionDate <= endDate;
            });

            const calculateAccountBalance = (accountCategory) => {
                return relevantTransactions
                    .filter(t => t.category === accountCategory)
                    .reduce((sum, t) => {
                        // Convert all amounts to USD for consistent calculation
                        const amountInUSD = convertToUSD(t.amount, t.currency);

                        if (t.type === 'Asset' || t.type === 'Expense') {
                            return sum + amountInUSD;
                        } else if (t.type === 'Liability' || t.type === 'Income' || t.type === 'Equity') {
                            return sum + amountInUSD;
                        }
                        return sum;
                    }, 0);
            };

            const assetsUSD = {
                cash: calculateAccountBalance('Cash') + calculateAccountBalance('Bank'),
                accountsReceivable: calculateAccountBalance('Accounts Receivable'),
                fixedAssets: calculateAccountBalance('Fixed Assets'),
            };
            const totalAssetsUSD = Object.values(assetsUSD).reduce((sum, val) => sum + val, 0);

            const liabilitiesUSD = {
                accountsPayable: calculateAccountBalance('Accounts Payable'),
                loansPayable: calculateAccountBalance('Loans Payable'),
            };
            const totalLiabilitiesUSD = Object.values(liabilitiesUSD).reduce((sum, val) => sum + val, 0);

            // Retained earnings calculation for Balance Sheet should be cumulative profit up to end date
            const cumulativeIncomeUSD = relevantTransactions.filter(t => t.type === 'Income').reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);
            const cumulativeExpensesUSD = relevantTransactions.filter(t => t.type === 'Expense').reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);
            const retainedEarningsUSD = cumulativeIncomeUSD - cumulativeExpensesUSD;

            const equityUSD = {
                ownersCapital: calculateAccountBalance('Owner\'s Capital'),
                retainedEarnings: retainedEarningsUSD,
            };
            const totalEquityUSD = Object.values(equityUSD).reduce((sum, val) => sum + val, 0);

            let csvContent = `Account,Amount (USD)\n`;
            csvContent += `${escapeCsvField("Cash & Bank")},${assetsUSD.cash.toFixed(2)}\n`;
            csvContent += `${escapeCsvField("Accounts Receivable")},${assetsUSD.accountsReceivable.toFixed(2)}\n`;
            csvContent += `${escapeCsvField("Fixed Assets")},${assetsUSD.fixedAssets.toFixed(2)}\n`;
            csvContent += `${escapeCsvField("Total Assets")},${totalAssetsUSD.toFixed(2)}\n`;
            csvContent += `${escapeCsvField("Accounts Payable")},${liabilitiesUSD.accountsPayable.toFixed(2)}\n`;
            csvContent += `${escapeCsvField("Loans Payable")},${liabilitiesUSD.loansPayable.toFixed(2)}\n`;
            csvContent += `${escapeCsvField("Total Liabilities")},${totalLiabilitiesUSD.toFixed(2)}\n`;
            csvContent += `${escapeCsvField("Owner's Capital")},${equityUSD.ownersCapital.toFixed(2)}\n`;
            csvContent += `${escapeCsvField("Retained Earnings")},${equityUSD.retainedEarnings.toFixed(2)}\n`;
            csvContent += `${escapeCsvField("Total Equity")},${totalEquityUSD.toFixed(2)}\n`;
            csvContent += `${escapeCsvField("Total Liabilities & Equity")},${(totalLiabilitiesUSD + totalEquityUSD).toFixed(2)}`;


            reportDisplay.innerHTML = `
                <div class="p-4 bg-white rounded-lg shadow-md">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">Balance Sheet</h3>
                    <p class="text-sm text-gray-600 mb-4">As of: ${endDateInputReport.value || new Date().toISOString().split('T')[0]}</p>
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-700 mb-2">Assets</h4>
                        <ul class="list-disc list-inside ml-4">
                            <li>Cash & Bank: <span class="float-right">${formatAmountDisplay(assetsUSD.cash, 'USD')}</span></li>
                            <li>Accounts Receivable: <span class="float-right">${formatAmountDisplay(assetsUSD.accountsReceivable, 'USD')}</span></li>
                            <li>Fixed Assets: <span class="float-right">${formatAmountDisplay(assetsUSD.fixedAssets, 'USD')}</span></li>
                        </ul>
                        <div class="font-bold border-t-2 border-gray-300 pt-2 mt-2">
                            Total Assets: <span class="float-right">${formatAmountDisplay(totalAssetsUSD, 'USD')}</span>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-700 mb-2">Liabilities</h4>
                        <ul class="list-disc list-inside ml-4">
                            <li>Accounts Payable: <span class="float-right">${formatAmountDisplay(liabilitiesUSD.accountsPayable, 'USD')}</span></li>
                            <li>Loans Payable: <span class="float-right">${formatAmountDisplay(liabilitiesUSD.loansPayable, 'USD')}</span></li>
                        </ul>
                        <div class="font-bold border-t-2 border-gray-300 pt-2 mt-2">
                            Total Liabilities: <span class="float-right">${formatAmountDisplay(totalLiabilitiesUSD, 'USD')}</span>
                        </div>
                    </div>

                    <div>
                        <h4 class="text-lg font-semibold text-gray-700 mb-2">Equity</h4>
                        <ul class="list-disc list-inside ml-4">
                            <li>Owner's Capital: <span class="float-right">${formatAmountDisplay(equityUSD.ownersCapital, 'USD')}</span></li>
                            <li>Retained Earnings: <span class="float-right">${formatAmountDisplay(equityUSD.retainedEarnings, 'USD')}</span></li>
                        </ul>
                        <div class="font-bold border-t-2 border-gray-300 pt-2 mt-2">
                            Total Equity: <span class="float-right">${formatAmountDisplay(totalEquityUSD, 'USD')}</span>
                        </div>
                    </div>

                    <div class="font-bold text-lg mt-4 border-t-2 border-gray-400 pt-4">
                        Total Liabilities & Equity: <span class="float-right">${formatAmountDisplay((totalLiabilitiesUSD + totalEquityUSD), 'USD')}</span>
                    </div>
                    <p class="mt-2 text-sm ${Math.abs(totalAssetsUSD - (totalLiabilitiesUSD + totalEquityUSD)) < 0.01 ? 'text-green-600' : 'text-red-600'}">
                        Assets = Liabilities + Equity: ${Math.abs(totalAssetsUSD - (totalLiabilitiesUSD + totalEquityUSD)) < 0.01 ? 'Balanced' : 'Unbalanced'}
                    </p>
                    <div class="flex justify-end gap-2 mt-4">
                        <button onclick="exportToCsv('balance_sheet_report.csv', \`${csvContent}\`)" class="btn-secondary">Export to CSV</button>
                        <button onclick="copyToClipboard(\`Balance Sheet:\nAs of: ${endDateInputReport.value || new Date().toISOString().split('T')[0]}\nAssets:\n  Cash & Bank: ${formatAmountDisplay(assetsUSD.cash, 'USD')}\n  Accounts Receivable: ${formatAmountDisplay(assetsUSD.accountsReceivable, 'USD')}\n  Fixed Assets: ${formatAmountDisplay(assetsUSD.fixedAssets, 'USD')}\nTotal Assets: ${formatAmountDisplay(totalAssetsUSD, 'USD')}\nLiabilities:\n  Accounts Payable: ${formatAmountDisplay(liabilitiesUSD.accountsPayable, 'USD')}\n  Loans Payable: ${formatAmountDisplay(liabilitiesUSD.loansPayable, 'USD')}\nTotal Liabilities: ${formatAmountDisplay(totalLiabilitiesUSD, 'USD')}\nEquity:\n  Owner's Capital: ${formatAmountDisplay(equityUSD.ownersCapital, 'USD')}\n  Retained Earnings: ${formatAmountDisplay(equityUSD.retainedEarnings, 'USD')}\nTotal Equity: ${formatAmountDisplay(totalEquityUSD, 'USD')}\nTotal Liabilities & Equity: ${formatAmountDisplay((totalLiabilitiesUSD + totalEquityUSD), 'USD')}\nAssets = Liabilities + Equity: ${Math.abs(totalAssetsUSD - (totalLiabilitiesUSD + totalEquityUSD)) < 0.01 ? 'Balanced' : 'Unbalanced'}\`, 'Balance Sheet report copied to clipboard!')" class="btn-secondary">Copy to Clipboard</button>
                    </div>
                </div>
            `;
        }

        // Cash Flow Statement
        function renderCashFlowReport(filteredTransactions) {
            const reportDisplay = document.getElementById('reportDisplay');
            if (!reportDisplay) return;

            const cashInflowsUSD = filteredTransactions
                .filter(t => (t.type === 'Income' && t.isPaid) || (t.type === 'Liability' && t.category === 'Loans Payable'))
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            const cashOutflowsUSD = filteredTransactions
                .filter(t => (t.type === 'Expense' && t.isPaid) || (t.type === 'Asset' && t.category === 'Fixed Assets') || (t.type === 'Liability' && t.category === 'Loans Payable' && t.amount < 0))
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            const netCashFlowUSD = cashInflowsUSD - cashOutflowsUSD;

            const csvContent = `Report Type,Amount (USD)\n${escapeCsvField("Cash Inflows")},${cashInflowsUSD.toFixed(2)}\n${escapeCsvField("Cash Outflows")},${cashOutflowsUSD.toFixed(2)}\n${escapeCsvField("Net Cash Flow")},${netCashFlowUSD.toFixed(2)}`;

            reportDisplay.innerHTML = `
                <div class="p-4 bg-white rounded-lg shadow-md">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">Cash Flow Statement</h3>
                    <div class="grid grid-cols-2 gap-4 text-lg">
                        <div class="font-semibold text-gray-700">Cash Inflows:</div>
                        <div class="text-right text-green-600">${formatAmountDisplay(cashInflowsUSD, 'USD')}</div>
                        <div class="font-semibold text-gray-700">Cash Outflows:</div>
                        <div class="text-right text-red-600">${formatAmountDisplay(cashOutflowsUSD, 'USD')}</div>
                        <div class="font-bold text-gray-800 border-t-2 border-gray-300 pt-2">Net Cash Flow:</div>
                        <div class="font-bold text-right border-t-2 border-gray-300 pt-2 ${netCashFlowUSD >= 0 ? 'text-green-700' : 'text-red-700'}">
                            ${formatAmountDisplay(netCashFlowUSD, 'USD')}
                        </div>
                    </div>
                    <p class="text-sm text-gray-600 mt-4">
                        Note: This is a simplified direct cash flow statement. A full statement would categorize activities into Operating, Investing, and Financing.
                    </p>
                    <div class="flex justify-end gap-2 mt-4">
                        <button onclick="exportToCsv('cash_flow_report.csv', \`${csvContent}\`)" class="btn-secondary">Export to CSV</button>
                        <button onclick="copyToClipboard(\`Cash Flow Statement:\nCash Inflows: ${formatAmountDisplay(cashInflowsUSD, 'USD')}\nCash Outflows: ${formatAmountDisplay(cashOutflowsUSD, 'USD')}\nNet Cash Flow: ${formatAmountDisplay(netCashFlowUSD, 'USD')}\`, 'Cash Flow report copied to clipboard!')" class="btn-secondary">Copy to Clipboard</button>
                    </div>
                </div>
            `;
        }

        // New function to render Bank Account Statements
        function renderBankAccountStatements(filteredTransactions) {
            const reportDisplay = document.getElementById('reportDisplay');
            const startDateInputReport = document.getElementById('startDateInputReport');
            const endDateInputReport = document.getElementById('endDateInputReport');
            if (!reportDisplay || !startDateInputReport || !endDateInputReport) return;

            const bankTransactions = filteredTransactions.filter(t => t.category === 'Cash' || t.category === 'Bank');

            if (bankTransactions.length === 0) {
                reportDisplay.innerHTML = `
                    <div class="text-center text-gray-600 p-8 bg-white rounded-lg shadow-md">
                        <p class="text-lg">No Cash or Bank transactions found for the selected date range.</p>
                    </div>
                `;
                return;
            }

            // Sort by date ascending for statement view
            bankTransactions.sort((a, b) => new Date(a.date) - new Date(b.date));

            let tableHtml = `
                <div class="p-4 bg-white rounded-lg shadow-md">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">Bank Account Statements</h3>
                    <p class="text-sm text-gray-600 mb-4">Showing transactions for 'Cash' and 'Bank' categories from ${startDateInputReport.value} to ${endDateInputReport.value}.</p>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="py-2 px-4 border-b text-left text-gray-600">Date</th>
                                    <th class="py-2 px-4 border-b text-left text-gray-600">Description</th>
                                    <th class="py-2 px-4 border-b text-right text-gray-600">Amount</th>
                                    <th class="py-2 px-4 border-b text-left text-gray-600">Type</th>
                                    <th class="py-2 px-4 border-b text-left text-gray-600">Category</th>
                                </tr>
                            </thead>
                            <tbody>
            `;
            let csvContent = `Date,Description,Amount (Original),Currency,Amount (USD),Type,Category\n`; // Updated CSV header

            bankTransactions.forEach(t => {
                const amountInUSD = convertToUSD(t.amount, t.currency);
                tableHtml += `
                    <tr class="table-row">
                        <td class="py-2 px-4 border-b">${escapeCsvField(t.date)}</td>
                        <td class="py-2 px-4 border-b">${escapeCsvField(t.description)}</td>
                        <td class="py-2 px-4 border-b text-right ${t.type === 'Income' || t.type === 'Liability' ? 'text-green-600' : 'text-red-600'}">${formatAmountDisplay(t.amount, t.currency)}</td>
                        <td class="py-2 px-4 border-b">${escapeCsvField(t.type)}</td>
                        <td class="py-2 px-4 border-b">${escapeCsvField(t.category)}</td>
                    </tr>
                `;
                csvContent += `${escapeCsvField(t.date)},${escapeCsvField(t.description)},${t.amount.toFixed(2)},${t.currency},${amountInUSD.toFixed(2)},${escapeCsvField(t.type)},${escapeCsvField(t.category)}\n`;
            });
            tableHtml += `</tbody></table></div>
                <div class="flex justify-end gap-2 mt-4">
                    <button onclick="exportToCsv('bank_account_statements.csv', \`${csvContent}\`)" class="btn-secondary">Export to CSV</button>
                    <button onclick="copyToClipboard(\`Bank Account Statements:\nDate,Description,Amount,Type,Category\n${bankTransactions.map(t => `${escapeCsvField(t.date)},${escapeCsvField(t.description)},${formatAmountDisplay(t.amount, t.currency)},${escapeCsvField(t.type)},${escapeCsvField(t.category)}`).join('\n')}\`, 'Bank Account Statements copied to clipboard!')" class="btn-secondary">Copy to Clipboard</button>
                </div>
                </div>
            `;
            reportDisplay.innerHTML = tableHtml;
        }

        // New function to render Ledger Statements
        function renderLedgerStatements(filteredTransactions) {
            const reportDisplay = document.getElementById('reportDisplay');
            const startDateInputReport = document.getElementById('startDateInputReport');
            const endDateInputReport = document.getElementById('endDateInputReport');
            if (!reportDisplay || !startDateInputReport || !endDateInputReport) return;

            const transactionsByCategory = {};
            ACCOUNT_TYPES.forEach(type => {
                ACCOUNT_CATEGORIES[type].forEach(category => {
                    transactionsByCategory[category] = [];
                });
            });

            filteredTransactions.forEach(t => {
                if (transactionsByCategory[t.category]) {
                    transactionsByCategory[t.category].push(t);
                }
            });

            let reportHtml = `
                <div class="p-4 bg-white rounded-lg shadow-md">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">Ledger Statements</h3>
                    <p class="text-sm text-gray-600 mb-4">Showing all transactions grouped by ledger account category from ${startDateInputReport.value} to ${endDateInputReport.value}.</p>
            `;
            let csvContent = `Category,Date,Description,Amount (Original),Currency,Amount (USD),Type\n`; // Updated CSV header

            let hasData = false;

            for (const category in transactionsByCategory) {
                const categoryTransactions = transactionsByCategory[category].sort((a, b) => new Date(a.date) - new Date(b.date));
                if (categoryTransactions.length > 0) {
                    hasData = true;
                    reportHtml += `
                        <div class="mb-6">
                            <h4 class="text-lg font-semibold text-gray-700 mb-2">${category}</h4>
                            <div class="overflow-x-auto">
                                <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                                    <thead class="bg-gray-100">
                                        <tr>
                                            <th class="py-2 px-4 border-b text-left text-gray-600">Date</th>
                                            <th class="py-2 px-4 border-b text-left text-gray-600">Description</th>
                                            <th class="py-2 px-4 border-b text-right text-gray-600">Amount</th>
                                            <th class="py-2 px-4 border-b text-left text-gray-600">Type</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                    `;
                    categoryTransactions.forEach(t => {
                        const amountInUSD = convertToUSD(t.amount, t.currency);
                        reportHtml += `
                            <tr class="table-row">
                                <td class="py-2 px-4 border-b">${escapeCsvField(t.date)}</td>
                                <td class="py-2 px-4 border-b">${escapeCsvField(t.description)}</td>
                                <td class="py-2 px-4 border-b text-right ${t.type === 'Income' || t.type === 'Liability' ? 'text-green-600' : 'text-red-600'}">${formatAmountDisplay(t.amount, t.currency)}</td>
                                <td class="py-2 px-4 border-b">${escapeCsvField(t.type)}</td>
                            </tr>
                        `;
                        csvContent += `${escapeCsvField(category)},${escapeCsvField(t.date)},${escapeCsvField(t.description)},${t.amount.toFixed(2)},${t.currency},${amountInUSD.toFixed(2)},${escapeCsvField(t.type)}\n`;
                    });
                    reportHtml += `
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                }
            }

            if (!hasData) {
                reportDisplay.innerHTML = `
                    <div class="text-center text-gray-600 p-8 bg-white rounded-lg shadow-md">
                        <p class="text-lg">No transactions found for any ledger accounts in the selected date range.</p>
                    </div>
                `;
                return;
            }

            reportHtml += `
                <div class="flex justify-end gap-2 mt-4">
                    <button onclick="exportToCsv('ledger_statements.csv', \`${csvContent}\`)" class="btn-secondary">Export to CSV</button>
                    <button onclick="copyToClipboard(\`Ledger Statements:\nCategory,Date,Description,Amount,Type\n${Object.entries(transactionsByCategory).flatMap(([category, txns]) => txns.map(t => `${escapeCsvField(category)},${escapeCsvField(t.date)},${escapeCsvField(t.description)},${formatAmountDisplay(t.amount, t.currency)},${escapeCsvField(t.type)}`)).join('\n')}\`, 'Ledger Statements copied to clipboard!')" class="btn-secondary">Copy to Clipboard</button>
                </div>
                </div>
            `;
            reportDisplay.innerHTML = reportHtml;
        }


        // Function to switch active report button and render the corresponding report
        function switchReport(type) {
            // Remove 'active' class from all report buttons
            const allReportButtons = document.querySelectorAll('#reportsSection .btn-secondary');
            allReportButtons.forEach(btn => btn.classList.remove('active'));

            // Add 'active' class to the clicked button
            let clickedButton;
            switch(type) {
                case 'pnl': clickedButton = document.getElementById('pnlReportBtn'); break;
                case 'balanceSheet': clickedButton = document.getElementById('balanceSheetReportBtn'); break;
                case 'cashFlow': clickedButton = document.getElementById('cashFlowReportBtn'); break;
                case 'bankAccountStatements': clickedButton = document.getElementById('bankAccountStatementsBtn'); break;
                case 'ledgerStatements': clickedButton = document.getElementById('ledgerStatementsBtn'); break;
            }
            if (clickedButton) {
                clickedButton.classList.add('active');
            }

            currentReportType = type;
            renderReport(currentReportType);
        }

        // Helper function to render a simulated pie chart
        function renderSimulatedPieChart(element, data, totalValue, colors) {
            if (!element) {
                console.error("Pie chart element not found.");
                return;
            }
            if (totalValue === 0 || Object.keys(data).length === 0) {
                element.innerHTML = '<p class="text-gray-600 text-center">No data to display.</p>';
                return;
            }

            let pieChartHtml = `<div class="pie-chart-container">`;
            let currentAngle = 0;
            let legendHtml = `<div class="pie-chart-legend">`;

            // Data passed to this function should already be in the base currency (USD) for consistency
            // The `data` object keys are categories, values are amounts in USD.
            const sortedData = Object.entries(data).sort(([, a], [, b]) => b - a); // Sort by amount descending

            sortedData.forEach(([category, amountInUSD], index) => {
                const percentage = (amountInUSD / totalValue) * 100;
                const color = colors[index % colors.length];

                legendHtml += `
                    <div class="pie-chart-legend-item">
                        <div class="pie-chart-legend-color" style="background-color: ${color};"></div>
                        <span>${category}: ${percentage.toFixed(1)}% (${formatAmountDisplay(amountInUSD, 'USD')})</span>
                    </div>
                `;
            });
            pieChartHtml += `</div>`; // Close pie-chart-container
            legendHtml += `</div>`; // Close pie-chart-legend

            element.innerHTML = pieChartHtml + legendHtml;

            // Simple background for the "pie" to show it's a circle
            const pieContainer = element.querySelector('.pie-chart-container');
            if (pieContainer) {
                pieContainer.style.backgroundColor = '#f0f0f0'; // Light gray circle
            }
        }


        // --- Dashboard Rendering Functions ---
        function renderDashboard() {
            const totalRevenueKPI = document.getElementById('totalRevenueKPI');
            const totalExpensesKPI = document.getElementById('totalExpensesKPI');
            const netProfitLossKPI = document.getElementById('netProfitLossKPI');
            const totalTransactionsKPI = document.getElementById('totalTransactionsKPI');
            const avgTransactionSizeKPI = document.getElementById('avgTransactionSizeKPI');
            const totalOutstandingReceivablesKPI = document.getElementById('totalOutstandingReceivablesKPI');
            const totalOutstandingPayablesKPI = document.getElementById('totalOutstandingPayablesKPI');
            const totalAssetsKPI = document.getElementById('totalAssetsKPI');
            const totalLiabilitiesKPI = document.getElementById('totalLiabilitiesKPI');
            const monthlyRevenueChart = document.getElementById('monthlyRevenueChart');
            const incomeDistributionPieChart = document.getElementById('incomeDistributionPieChart');
            const topExpensesChart = document.getElementById('topExpensesChart');
            const expenseDistributionPieChart = document.getElementById('expenseDistributionPieChart');
            const recentTransactionsList = document.getElementById('recentTransactionsList');

            // Ensure KPI elements are available
            if (!totalRevenueKPI || !totalExpensesKPI || !netProfitLossKPI || !totalTransactionsKPI || !avgTransactionSizeKPI || !totalOutstandingReceivablesKPI || !totalOutstandingPayablesKPI || !totalAssetsKPI || !totalLiabilitiesKPI || !monthlyRevenueChart || !incomeDistributionPieChart || !topExpensesChart || !expenseDistributionPieChart || !recentTransactionsList) {
                console.error("One or more Dashboard KPI elements not found. Dashboard rendering skipped.");
                return;
            }

            // Calculate KPIs (all converted to USD for consistent summation)
            const totalRevenueUSD = transactions
                .filter(t => t.type === 'Income')
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            const totalExpensesUSD = transactions
                .filter(t => t.type === 'Expense')
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            const netProfitLossUSD = totalRevenueUSD - totalExpensesUSD;

            const totalTransactionsCount = transactions.length;

            const avgTransactionSizeUSD = totalTransactionsCount > 0 ? (totalRevenueUSD / totalTransactionsCount) : 0;

            const totalOutstandingReceivablesUSD = transactions
                .filter(t => t.category === 'Accounts Receivable' && !t.isPaid)
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            const totalOutstandingPayablesUSD = transactions
                .filter(t => t.category === 'Accounts Payable' && !t.isPaid)
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            // Calculate total assets and liabilities (simplified for dashboard view)
            const totalAssetsUSD = transactions
                .filter(t => t.type === 'Asset')
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            const totalLiabilitiesUSD = transactions
                .filter(t => t.type === 'Liability')
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);


            totalRevenueKPI.textContent = formatAmountDisplay(totalRevenueUSD, 'USD');
            totalExpensesKPI.textContent = formatAmountDisplay(totalExpensesUSD, 'USD');
            netProfitLossKPI.textContent = formatAmountDisplay(netProfitLossUSD, 'USD');
            netProfitLossKPI.style.color = netProfitLossUSD >= 0 ? '#10b981' : '#ef4444'; // green-500 vs red-500
            totalTransactionsKPI.textContent = totalTransactionsCount;
            avgTransactionSizeKPI.textContent = formatAmountDisplay(avgTransactionSizeUSD, 'USD');
            totalOutstandingReceivablesKPI.textContent = formatAmountDisplay(totalOutstandingReceivablesUSD, 'USD');
            totalOutstandingPayablesKPI.textContent = formatAmountDisplay(totalOutstandingPayablesUSD, 'USD');
            totalAssetsKPI.textContent = formatAmountDisplay(totalAssetsUSD, 'USD');
            totalLiabilitiesKPI.textContent = formatAmountDisplay(totalLiabilitiesUSD, 'USD');


            // Monthly Revenue Trend
            const monthlyRevenueUSD = transactions
                .filter(t => t.type === 'Income')
                .reduce((acc, t) => {
                    const monthYear = new Date(t.date).toLocaleString('en-US', { month: 'short', year: 'numeric' });
                    acc[monthYear] = (acc[monthYear] || 0) + convertToUSD(t.amount, t.currency);
                    return acc;
                }, {});

            let monthlyRevenueHtml = '';
            const sortedMonths = Object.keys(monthlyRevenueUSD).sort((a, b) => {
                const dateA = new Date(a);
                const dateB = new Date(b);
                return dateA - dateB;
            });

            const maxMonthlyRevenueUSD = Math.max(...Object.values(monthlyRevenueUSD), 0);

            if (sortedMonths.length === 0) {
                monthlyRevenueHtml = '<p class="text-gray-600 text-center">No income data for monthly trend.</p>';
            } else {
                sortedMonths.forEach(monthYear => {
                    const revenue = monthlyRevenueUSD[monthYear];
                    const width = maxMonthlyRevenueUSD > 0 ? (revenue / maxMonthlyRevenueUSD) * 100 : 0;
                    monthlyRevenueHtml += `
                        <div class="flex items-center text-sm">
                            <span class="w-24 flex-shrink-0 text-gray-700">${monthYear}:</span>
                            <div class="bar-chart-bar" style="width: ${width.toFixed(2)}%;">
                                ${formatAmountDisplay(revenue, 'USD')}
                            </div>
                        </div>
                    `;
                });
            }
            monthlyRevenueChart.innerHTML = monthlyRevenueHtml;

            // Income Distribution by Category (Pie Chart)
            const incomeCategoriesUSD = transactions
                .filter(t => t.type === 'Income')
                .reduce((acc, t) => {
                    acc[t.category] = (acc[t.category] || 0) + convertToUSD(t.amount, t.currency);
                    return acc;
                }, {});

            const totalIncomeForDistributionUSD = Object.values(incomeCategoriesUSD).reduce((sum, val) => sum + val, 0);
            const pieColors = [
                '#4f46e5', '#10b981', '#f59e0b', '#ef4444', '#3b82f6',
                '#8b5cf6', '#ec4899', '#6b7280', '#14b8a6', '#f97316'
            ];
            renderSimulatedPieChart(incomeDistributionPieChart, incomeCategoriesUSD, totalIncomeForDistributionUSD, pieColors);


            // Top Expense Categories
            const expenseCategoriesUSD = transactions
                .filter(t => t.type === 'Expense')
                .reduce((acc, t) => {
                    acc[t.category] = (acc[t.category] || 0) + convertToUSD(t.amount, t.currency);
                    return acc;
                }, {});

            let topExpensesHtml = '';
            const sortedExpenses = Object.entries(expenseCategoriesUSD).sort(([, a], [, b]) => b - a);
            const maxExpenseAmountUSD = Math.max(...Object.values(expenseCategoriesUSD), 0);

            if (sortedExpenses.length === 0) {
                topExpensesHtml = '<p class="text-gray-600 text-center">No expense data for top categories.</p>';
            } else {
                sortedExpenses.slice(0, 5).forEach(([category, amount]) => { // Show top 5 expenses
                    const width = maxExpenseAmountUSD > 0 ? (amount / maxExpenseAmountUSD) * 100 : 0;
                    topExpensesHtml += `
                        <div class="flex items-center text-sm">
                            <span class="w-32 flex-shrink-0 text-gray-700">${category}:</span>
                            <div class="bar-chart-bar bg-red-500" style="width: ${width.toFixed(2)}%;">
                                ${formatAmountDisplay(amount, 'USD')}
                            </div>
                        </div>
                    `;
                });
            }
            topExpensesChart.innerHTML = topExpensesHtml;

            // Expense Distribution by Category (Pie Chart)
            const totalExpensesForDistributionUSD = Object.values(expenseCategoriesUSD).reduce((sum, val) => sum + val, 0);
            renderSimulatedPieChart(expenseDistributionPieChart, expenseCategoriesUSD, totalExpensesForDistributionUSD, pieColors);


            // Recent Transactions
            const recentTransactions = [...transactions].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
            let recentTransactionsHtml = '';
            if (recentTransactions.length === 0) {
                recentTransactionsHtml = '<p class="text-gray-600 text-center">No recent transactions to display.</p>';
            } else {
                recentTransactionsHtml = `
                    <table class="min-w-full bg-white recent-transactions-table rounded-lg overflow-hidden">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Description</th>
                                <th>Amount</th>
                                <th>Type</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                recentTransactions.forEach(t => {
                    recentTransactionsHtml += `
                        <tr>
                            <td>${escapeCsvField(t.date)}</td>
                            <td>${escapeCsvField(t.description)}</td>
                            <td class="${t.type === 'Income' ? 'text-green-600' : 'text-red-600'}">${formatAmountDisplay(t.amount, t.currency)}</td>
                            <td>${escapeCsvField(t.type)}</td>
                        </tr>
                    `;
                });
                recentTransactionsHtml += `
                        </tbody>
                    </table>
                `;
            }
            recentTransactionsList.innerHTML = recentTransactionsHtml;
        }

        // Function to copy dashboard summary to clipboard
        function copyDashboardSummaryToClipboard() {
            const totalRevenueUSD = transactions
                .filter(t => t.type === 'Income')
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);
            const totalExpensesUSD = transactions
                .filter(t => t.type === 'Expense')
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);
            const netProfitLossUSD = totalRevenueUSD - totalExpensesUSD;
            const totalTransactions = transactions.length;

            const totalOutstandingReceivablesUSD = transactions
                .filter(t => t.category === 'Accounts Receivable' && !t.isPaid)
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            const totalOutstandingPayablesUSD = transactions
                .filter(t => t.category === 'Accounts Payable' && !t.isPaid)
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            const totalAssetsUSD = transactions
                .filter(t => t.type === 'Asset')
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            const totalLiabilitiesUSD = transactions
                .filter(t => t.type === 'Liability')
                .reduce((sum, t) => sum + convertToUSD(t.amount, t.currency), 0);

            const avgTransactionSizeUSD = totalTransactions > 0 ? (totalRevenueUSD / totalTransactions) : 0;

            let summary = "Dashboard Summary:\n";
            summary += `Total Revenue: ${formatAmountDisplay(totalRevenueUSD, 'USD')}\n`;
            summary += `Total Expenses: ${formatAmountDisplay(totalExpensesUSD, 'USD')}\n`;
            summary += `Net Profit/Loss: ${formatAmountDisplay(netProfitLossUSD, 'USD')}\n`;
            summary += `Total Transactions: ${totalTransactions}\n`;
            summary += `Avg. Transaction Value: ${formatAmountDisplay(avgTransactionSizeUSD, 'USD')}\n`;
            summary += `Outstanding Receivables: ${formatAmountDisplay(totalOutstandingReceivablesUSD, 'USD')}\n`;
            summary += `Outstanding Payables: ${formatAmountDisplay(totalOutstandingPayablesUSD, 'USD')}\n`;
            summary += `Total Assets: ${formatAmountDisplay(totalAssetsUSD, 'USD')}\n`;
            summary += `Total Liabilities: ${formatAmountDisplay(totalLiabilitiesUSD, 'USD')}\n\n`;

            const incomeCategoriesUSD = transactions
                .filter(t => t.type === 'Income')
                .reduce((acc, t) => {
                    acc[t.category] = (acc[t.category] || 0) + convertToUSD(t.amount, t.currency);
                    return acc;
                }, {});
            const totalIncomeForDistributionUSD = Object.values(incomeCategoriesUSD).reduce((sum, val) => sum + val, 0);

            if (totalIncomeForDistributionUSD > 0) {
                summary += "Income Distribution by Category:\n";
                Object.entries(incomeCategoriesUSD).sort(([, a], [, b]) => b - a).forEach(([category, amount]) => {
                    const percentage = (amount / totalIncomeForDistributionUSD) * 100;
                    summary += `- ${category}: ${percentage.toFixed(1)}% (${formatAmountDisplay(amount, 'USD')})\n`;
                });
                summary += "\n";
            }


            const expenseCategoriesUSD = transactions
                .filter(t => t.type === 'Expense')
                .reduce((acc, t) => {
                    acc[t.category] = (acc[t.category] || 0) + convertToUSD(t.amount, t.currency);
                    return acc;
                }, {});
            const totalExpensesForDistributionUSD = Object.values(expenseCategoriesUSD).reduce((sum, val) => sum + val, 0);

            if (totalExpensesForDistributionUSD > 0) {
                summary += "Expense Distribution by Category:\n";
                Object.entries(expenseCategoriesUSD).sort(([, a], [, b]) => b - a).forEach(([category, amount]) => {
                    const percentage = (amount / totalExpensesForDistributionUSD) * 100;
                    summary += `- ${category}: ${percentage.toFixed(1)}% (${formatAmountDisplay(amount, 'USD')})\n`;
                });
                summary += "\n";
            }

            summary += "Recent Transactions:\n";
            const recentTransactions = [...transactions].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
            if (recentTransactions.length > 0) {
                summary += "Date,Description,Amount,Type\n";
                recentTransactions.forEach(t => {
                    summary += `${escapeCsvField(t.date)},${escapeCsvField(t.description)},${formatAmountDisplay(t.amount, t.currency)},${escapeCsvField(t.type)}\n`;
                });
            } else {
                summary += "No recent transactions.\n";
            }

            copyToClipboard(summary, 'Dashboard summary copied to clipboard!');
        }

        let currentReportType = 'pnl'; // Default report type
        let currentTab = 'dataEntry'; // Default tab

        document.addEventListener('DOMContentLoaded', () => {
            try {
                // Initialize ALL DOM elements at the very beginning
                const dataEntryTab = document.getElementById('dataEntryTab');
                const uploadTab = document.getElementById('uploadTab');
                const reportsTab = document.getElementById('reportsTab');
                const dashboardTab = document.getElementById('dashboardTab');

                const transactionForm = document.getElementById('transactionForm');
                const dateInput = document.getElementById('dateInput');
                const descriptionInput = document.getElementById('descriptionInput');
                const amountInput = document.getElementById('amountInput');
                const currencySelect = document.getElementById('currencySelect');
                const typeSelect = document.getElementById('typeSelect');
                const categorySelect = document.getElementById('categorySelect');
                const relatedPartyField = document.getElementById('relatedPartyField');
                const relatedPartyInput = document.getElementById('relatedPartyInput');
                const isPaidField = document.getElementById('isPaidField');
                const isPaidCheckbox = document.getElementById('isPaidCheckbox');
                const transactionsList = document.getElementById('transactionsList');
                const clearTransactionsBtn = document.getElementById('clearTransactionsBtn');

                const paymentReceivedForm = document.getElementById('paymentReceivedForm');
                const paymentDateInput = document.getElementById('paymentDateInput');
                const paymentDescriptionInput = document.getElementById('paymentDescriptionInput');
                const paymentAmountInput = document.getElementById('paymentAmountInput');
                const paymentCurrencySelect = document.getElementById('paymentCurrencySelect');
                const paymentMethodSelect = document.getElementById('paymentMethodSelect');

                const dragDropArea = document.getElementById('dragDropArea');
                const excelFileInput = document.getElementById('excelFileInput');
                const browseFilesBtn = document.getElementById('browseFilesBtn');
                const downloadTemplateBtn = document.getElementById('downloadTemplateBtn');
                const uploadMessage = document.getElementById('uploadMessage');

                const pnlReportBtn = document.getElementById('pnlReportBtn');
                const balanceSheetReportBtn = document.getElementById('balanceSheetReportBtn');
                const cashFlowReportBtn = document.getElementById('cashFlowReportBtn');
                const bankAccountStatementsBtn = document.getElementById('bankAccountStatementsBtn');
                const ledgerStatementsBtn = document.getElementById('ledgerStatementsBtn');

                const startDateInputReport = document.getElementById('startDateInputReport');
                const endDateInputReport = document.getElementById('endDateInputReport');
                const applyDateFilterBtn = document.getElementById('applyDateFilterBtn');
                const reportDateFilters = document.getElementById('reportDateFilters');

                const reportDisplay = document.getElementById('reportDisplay');

                const helpButton = document.getElementById('helpButton');
                const helpModal = document.getElementById('helpModal');
                const closeButton = document.querySelector('#helpModal .close-button');

                const clearConfirmModal = document.getElementById('clearConfirmModal');
                const confirmClearBtn = document.getElementById('confirmClearBtn');
                const cancelClearBtn = document.getElementById('cancelClearBtn');

                const copyDashboardSummaryBtn = document.getElementById('copyDashboardSummaryBtn');

                // Attach event listeners with checks for existence
                if (dataEntryTab) dataEntryTab.addEventListener('click', () => switchTab('dataEntry'));
                if (uploadTab) uploadTab.addEventListener('click', () => switchTab('upload'));
                if (reportsTab) reportsTab.addEventListener('click', () => switchTab('reports'));
                if (dashboardTab) dashboardTab.addEventListener('click', () => switchTab('dashboard'));

                if (transactionForm) transactionForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const newTransaction = {
                        id: generateId(),
                        date: dateInput.value,
                        description: descriptionInput.value,
                        amount: parseFloat(amountInput.value),
                        currency: currencySelect.value,
                        type: typeSelect.value,
                        category: categorySelect.value,
                        isPaid: ['Accounts Receivable', 'Accounts Payable'].includes(categorySelect.value) ? isPaidCheckbox.checked : true,
                        relatedParty: ['Accounts Receivable', 'Accounts Payable'].includes(categorySelect.value) ? relatedPartyInput.value : '',
                        source: 'manual'
                    };
                    transactions.push(newTransaction);
                    renderTransactions();
                    renderDashboard();
                    transactionForm.reset();
                    setInitialDate();
                    populateTypeSelect();
                    isPaidCheckbox.checked = true;
                    currencySelect.value = 'INR';
                });

                if (paymentReceivedForm) {
                    paymentReceivedForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        const paymentMethod = paymentMethodSelect.value;
                        let category;
                        if (paymentMethod === 'Cash') {
                            category = 'Cash';
                        } else {
                            category = 'Bank';
                        }

                        const newTransaction = {
                            id: generateId(),
                            date: paymentDateInput.value,
                            description: paymentDescriptionInput.value + ` (via ${paymentMethod})`,
                            amount: parseFloat(paymentAmountInput.value),
                            currency: paymentCurrencySelect.value,
                            type: 'Income',
                            category: category,
                            isPaid: true,
                            relatedParty: '',
                            source: 'manual'
                        };
                        transactions.push(newTransaction);
                        renderTransactions();
                        renderDashboard();
                        paymentReceivedForm.reset();
                        setInitialDate();
                        paymentCurrencySelect.value = 'INR';
                    });
                }

                if (typeSelect) typeSelect.addEventListener('change', populateCategorySelect);
                if (categorySelect) categorySelect.addEventListener('change', toggleRelatedPartyFields);

                if (browseFilesBtn) browseFilesBtn.addEventListener('click', () => {
                    if (excelFileInput) excelFileInput.click();
                });

                if (excelFileInput) excelFileInput.addEventListener('change', (event) => {
                    const files = event.target.files;
                    if (files.length > 0) {
                        showUploadMessage('Excel file uploaded successfully!');
                        const dummyTransactions = [
                            { id: generateId(), date: '2024-01-05', description: 'Initial Capital', amount: 10000, currency: 'INR', type: 'Equity', category: 'Owner\'s Capital', isPaid: true, relatedParty: '', source: 'excel' },
                            { id: generateId(), date: '2024-01-10', description: 'Sales Revenue Q1', amount: 5000, currency: 'INR', type: 'Income', category: 'Sales Revenue', isPaid: true, relatedParty: '', source: 'excel' },
                            { id: generateId(), date: '2024-01-15', description: 'Office Rent', amount: 1200, currency: 'INR', type: 'Expense', category: 'Rent Expense', isPaid: true, relatedParty: '', source: 'excel' },
                            { id: generateId(), date: '2024-01-20', description: 'Marketing Campaign', amount: 300, currency: 'USD', type: 'Expense', category: 'Marketing Expense', isPaid: true, relatedParty: '', source: 'excel' },
                            { id: generateId(), date: '2024-02-01', description: 'Service Income', amount: 2500, currency: 'INR', type: 'Income', category: 'Service Revenue', isPaid: true, relatedParty: '', source: 'excel' },
                            { id: generateId(), date: '2024-02-10', description: 'Utilities Bill', amount: 150, currency: 'USD', type: 'Expense', category: 'Utilities Expense', isPaid: true, relatedParty: '', source: 'excel' },
                            { id: generateId(), date: '2024-03-01', description: 'Accounts Receivable (Customer A)', amount: 800, currency: 'INR', type: 'Asset', category: 'Accounts Receivable', isPaid: false, relatedParty: 'Customer A', source: 'excel' },
                            { id: generateId(), date: '2024-03-05', description: 'Accounts Payable (Supplier B)', amount: 400, currency: 'INR', type: 'Liability', category: 'Accounts Payable', isPaid: false, relatedParty: 'Supplier B', source: 'excel' },
                            { id: generateId(), date: '2024-03-15', description: 'Loan Received', amount: 2000, currency: 'USD', type: 'Liability', category: 'Loans Payable', isPaid: true, relatedParty: '', source: 'excel' },
                            { id: generateId(), date: '2024-03-20', description: 'Fixed Asset Purchase', amount: 1500, currency: 'INR', type: 'Asset', category: 'Fixed Assets', isPaid: true, relatedParty: '', source: 'excel' },
                        ];
                        transactions.push(...dummyTransactions);
                        renderTransactions();
                        excelFileInput.value = null;
                        renderDashboard();
                    }
                });

                if (dragDropArea) {
                    dragDropArea.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        dragDropArea.classList.add('hover');
                    });

                    dragDropArea.addEventListener('dragleave', () => {
                        dragDropArea.classList.remove('hover');
                    });

                    dragDropArea.addEventListener('drop', (e) => {
                        e.preventDefault();
                        dragDropArea.classList.remove('hover');
                        const files = e.dataTransfer.files;
                        if (files.length > 0) {
                            showUploadMessage('Excel file uploaded successfully!');
                            const dummyTransactions = [
                                { id: generateId(), date: '2024-04-01', description: 'Sales Revenue Q2', amount: 7000, currency: 'INR', type: 'Income', category: 'Sales Revenue', isPaid: true, relatedParty: '', source: 'excel' },
                                { id: generateId(), date: '2024-04-10', description: 'New Office Equipment', amount: 800, currency: 'USD', type: 'Expense', category: 'Other Expenses', isPaid: true, relatedParty: '', source: 'excel' },
                            ];
                            transactions.push(...dummyTransactions);
                            renderTransactions();
                            renderDashboard();
                        }
                    });
                }

                if (downloadTemplateBtn) downloadTemplateBtn.addEventListener('click', () => {
                    const templateContent = "Date (MM/DD/YYYY),Description,Category,Amount,Type,Currency (INR/USD)\n";
                    const blob = new Blob([templateContent], { type: 'text/csv;charset=utf-8;' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'finance_template.csv';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                });

                if (helpButton) helpButton.addEventListener('click', () => {
                    if (helpModal) {
                        helpModal.classList.remove('hidden');
                        helpModal.style.display = 'flex';
                    }
                });

                if (closeButton) closeButton.addEventListener('click', () => {
                    if (helpModal) {
                        helpModal.classList.add('hidden');
                        helpModal.style.display = 'none';
                    }
                });

                window.addEventListener('click', (event) => {
                    if (helpModal && event.target === helpModal) {
                        helpModal.classList.add('hidden');
                        helpModal.style.display = 'none';
                    }
                    if (clearConfirmModal && event.target === clearConfirmModal) {
                        clearConfirmModal.classList.add('hidden');
                        clearConfirmModal.style.display = 'none';
                    }
                });

                if (clearTransactionsBtn) clearTransactionsBtn.addEventListener('click', clearAllTransactions);
                if (cancelClearBtn) cancelClearBtn.addEventListener('click', () => {
                    if (clearConfirmModal) {
                        clearConfirmModal.classList.add('hidden');
                        clearConfirmModal.style.display = 'none';
                    }
                });
                if (confirmClearBtn) confirmClearBtn.addEventListener('click', () => {
                    transactions = [];
                    renderTransactions();
                    renderReport(currentReportType);
                    renderDashboard();
                    if (clearConfirmModal) {
                        clearConfirmModal.classList.add('hidden');
                        clearConfirmModal.style.display = 'none';
                    }
                });

                if (pnlReportBtn) pnlReportBtn.addEventListener('click', () => switchReport('pnl'));
                if (balanceSheetReportBtn) balanceSheetReportBtn.addEventListener('click', () => switchReport('balanceSheet'));
                if (cashFlowReportBtn) cashFlowReportBtn.addEventListener('click', () => switchReport('cashFlow'));
                if (bankAccountStatementsBtn) bankAccountStatementsBtn.addEventListener('click', () => switchReport('bankAccountStatements'));
                if (ledgerStatementsBtn) ledgerStatementsBtn.addEventListener('click', () => switchReport('ledgerStatements'));

                if (applyDateFilterBtn) applyDateFilterBtn.addEventListener('click', () => renderReport(currentReportType));

                if (copyDashboardSummaryBtn) copyDashboardSummaryBtn.addEventListener('click', copyDashboardSummaryToClipboard);

                if (transactionsList) {
                    transactionsList.addEventListener('click', (e) => {
                        if (e.target.classList.contains('delete-btn')) {
                            const idToDelete = e.target.dataset.id;
                            deleteTransaction(idToDelete);
                        }
                    });
                }

                // Initial setup calls
                setInitialDate();
                populateTypeSelect();
                renderTransactions();
                switchTab('dataEntry');
                renderDashboard();

                // Defensive measure: Ensure modals are hidden on load, in case of external interference
                if (helpModal) helpModal.classList.add('hidden');
                if (clearConfirmModal) clearConfirmModal.classList.add('hidden');

            } catch (error) {
                console.error("Error during DOMContentLoaded initialization:", error);
                // You might want to display a user-friendly message here too
                showTemporaryMessage("An error occurred during initialization. Please check the console.", true);
            }
        });
    </script>
</body>
</html>
</div>
						</div>
				</div>
		
		


	
	

<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/wp-content\/uploads\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/astra\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>

<div id="ast-scroll-top" tabindex="0" class="ast-scroll-top-icon ast-scroll-to-top-right" data-on-devices="both">
	<span class="ast-icon icon-arrow"><svg class="ast-arrow-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="26px" height="16.043px" viewBox="57 35.171 26 16.043" enable-background="new 57 35.171 26 16.043" xml:space="preserve">
                <path d="M57.5,38.193l12.5,12.5l12.5-12.5l-2.5-2.5l-10,10l-10-10L57.5,38.193z" />
                </svg></span>	<span class="screen-reader-text">Scroll to Top</span>
</div>
			<script>
				const lazyloadRunObserver = () => {
					const lazyloadBackgrounds = document.querySelectorAll( `.e-con.e-parent:not(.e-lazyloaded)` );
					const lazyloadBackgroundObserver = new IntersectionObserver( ( entries ) => {
						entries.forEach( ( entry ) => {
							if ( entry.isIntersecting ) {
								let lazyloadBackground = entry.target;
								if( lazyloadBackground ) {
									lazyloadBackground.classList.add( 'e-lazyloaded' );
								}
								lazyloadBackgroundObserver.unobserve( entry.target );
							}
						});
					}, { rootMargin: '200px 0px 200px 0px' } );
					lazyloadBackgrounds.forEach( ( lazyloadBackground ) => {
						lazyloadBackgroundObserver.observe( lazyloadBackground );
					} );
				};
				const events = [
					'DOMContentLoaded',
					'elementor/lazyload/observe',
				];
				events.forEach( ( event ) => {
					document.addEventListener( event, lazyloadRunObserver );
				} );
			</script>
			<link rel='stylesheet' id='widget-icon-list-css' href='https://tallypro.com/wp-content/plugins/elementor/assets/css/widget-icon-list.min.css?ver=3.31.0' media='all' />
<script id="astra-theme-js-js-extra">
var astra = {"break_point":"921","isRtl":"","is_scroll_to_id":"1","is_scroll_to_top":"1","is_header_footer_builder_active":"1","responsive_cart_click":"flyout","is_dark_palette":""};
</script>
<script src="https://tallypro.com/wp-content/themes/astra/assets/js/minified/frontend.min.js?ver=4.11.7" id="astra-theme-js-js"></script>
<script src="https://tallypro.com/wp-includes/js/dist/hooks.min.js?ver=4d63a3d491d11ffd8ac6" id="wp-hooks-js"></script>
<script src="https://tallypro.com/wp-includes/js/dist/i18n.min.js?ver=5e580eb46a90c2b997e6" id="wp-i18n-js"></script>
<script id="wp-i18n-js-after">
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>
<script src="https://tallypro.com/wp-content/plugins/contact-form-7/includes/swv/js/index.js?ver=6.1.1" id="swv-js"></script>
<script id="contact-form-7-js-before">
var wpcf7 = {
    "api": {
        "root": "https:\/\/tallypro.com\/wp-json\/",
        "namespace": "contact-form-7\/v1"
    }
};
</script>
<script src="https://tallypro.com/wp-content/plugins/contact-form-7/includes/js/index.js?ver=6.1.1" id="contact-form-7-js"></script>
<script src="https://tallypro.com/wp-content/plugins/elementor/assets/js/webpack.runtime.min.js?ver=3.31.0" id="elementor-webpack-runtime-js"></script>
<script src="https://tallypro.com/wp-content/plugins/elementor/assets/js/frontend-modules.min.js?ver=3.31.0" id="elementor-frontend-modules-js"></script>
<script src="https://tallypro.com/wp-includes/js/jquery/ui/core.min.js?ver=1.13.3" id="jquery-ui-core-js"></script>
<script id="elementor-frontend-js-before">
var elementorFrontendConfig = {"environmentMode":{"edit":false,"wpPreview":false,"isScriptDebug":false},"i18n":{"shareOnFacebook":"Share on Facebook","shareOnTwitter":"Share on Twitter","pinIt":"Pin it","download":"Download","downloadImage":"Download image","fullscreen":"Fullscreen","zoom":"Zoom","share":"Share","playVideo":"Play Video","previous":"Previous","next":"Next","close":"Close","a11yCarouselPrevSlideMessage":"Previous slide","a11yCarouselNextSlideMessage":"Next slide","a11yCarouselFirstSlideMessage":"This is the first slide","a11yCarouselLastSlideMessage":"This is the last slide","a11yCarouselPaginationBulletMessage":"Go to slide"},"is_rtl":false,"breakpoints":{"xs":0,"sm":480,"md":768,"lg":1025,"xl":1440,"xxl":1600},"responsive":{"breakpoints":{"mobile":{"label":"Mobile Portrait","value":767,"default_value":767,"direction":"max","is_enabled":true},"mobile_extra":{"label":"Mobile Landscape","value":880,"default_value":880,"direction":"max","is_enabled":false},"tablet":{"label":"Tablet Portrait","value":1024,"default_value":1024,"direction":"max","is_enabled":true},"tablet_extra":{"label":"Tablet Landscape","value":1200,"default_value":1200,"direction":"max","is_enabled":false},"laptop":{"label":"Laptop","value":1366,"default_value":1366,"direction":"max","is_enabled":false},"widescreen":{"label":"Widescreen","value":2400,"default_value":2400,"direction":"min","is_enabled":false}},"hasCustomBreakpoints":false},"version":"3.31.0","is_static":false,"experimentalFeatures":{"e_font_icon_svg":true,"additional_custom_breakpoints":true,"container":true,"e_optimized_markup":true,"nested-elements":true,"e_element_cache":true,"home_screen":true,"global_classes_should_enforce_capabilities":true,"e_variables":true,"cloud-library":true,"e_opt_in_v4_page":true},"urls":{"assets":"https:\/\/tallypro.com\/wp-content\/plugins\/elementor\/assets\/","ajaxurl":"https:\/\/tallypro.com\/wp-admin\/admin-ajax.php","uploadUrl":"https:\/\/tallypro.com\/wp-content\/uploads"},"nonces":{"floatingButtonsClickTracking":"01c8e67138"},"swiperClass":"swiper","settings":{"page":[],"editorPreferences":[]},"kit":{"active_breakpoints":["viewport_mobile","viewport_tablet"],"global_image_lightbox":"yes","lightbox_enable_counter":"yes","lightbox_enable_fullscreen":"yes","lightbox_enable_zoom":"yes","lightbox_enable_share":"yes","lightbox_title_src":"title","lightbox_description_src":"description"},"post":{"id":5,"title":"Free%20Accounting%20Tools%20for%20Small%20Business%20Owners%20%26%20Freelancers%20%7C%20OctoTally%20-%20Your%20Daily%20Finance%20Partner","excerpt":"","featuredImage":false}};
</script>
<script src="https://tallypro.com/wp-content/plugins/elementor/assets/js/frontend.min.js?ver=3.31.0" id="elementor-frontend-js"></script>
<script src="https://tallypro.com/wp-content/plugins/google-site-kit/dist/assets/js/googlesitekit-events-provider-contact-form-7-84e9a1056bc4922b7cbd.js" id="googlesitekit-events-provider-contact-form-7-js" defer></script>
<script src="https://tallypro.com/wp-content/plugins/header-footer-elementor/inc/js/frontend.js?ver=2.5.2" id="hfe-frontend-js-js"></script>
			<script>
			/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
			</script>
				</body>
</html>
